!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ruleJS=e():r.ruleJS=e()}(this,function(){return function(r){function e(t){if(n[t])return n[t].exports;var u=n[t]={exports:{},id:t,loaded:!1};return r[t].call(u.exports,u,u.exports,e),u.loaded=!0,u.exports}var n={};return e.m=r,e.c=n,e.p="",e(0)}([function(r,e,n){var t=[n(1)];for(var u in t){var i=t[u];for(var a in i)e[a]=e[a]||i[a]}},function(r,e,n){var t=n(2),u=n(4),i=n(5),a=n(24),o=n(26),s=n(27),f=n(28);r.exports.core=function(r){"use strict";var e,n,l=this,c="0.1.0",p=function(r,u){var a=null,s=null;if("="===r.substr(0,1)&&(r=r.substr(1)),!e||!n)throw new Error("Run init() first.");var f,l;r===l&&(window.marker=f=!0,console.log("parse/formula",r),console.log("parse/item",u));try{e.setObj(u),a=e.parse(r),i.ISERROR(a)&&(s=a);var c;u&&u.id&&(c=u.id);var p=n.getDependencies(c);if(f&&console.error("deps:"),f&&console.error(p),-1!==p.indexOf(c))throw console.error("CYCLIC REFERENCE",c,JSON.stringify(p)),a=null,t.forEach(p,function(r){n.updateItem(r,{error:o.get("REF"),value:null})}),Error("REF")}catch(m){var h=o.get(m.message);f&&console.error("Parse error:"),f&&console.error(m),s=h?h:o.get("ERROR")}var g={error:s,value:a};return window.marker&&console.log("parse",g),delete window.marker,g},m=function(r){return{id:r.id,value:"undefined"==typeof r.value?null:r.value,error:"undefined"==typeof r.error?null:r.error,formula:r.formula?"="+r.formula:null}},h=function(r){var e=n.getItem(r);return m(e)},g=function(r){return r.map(h)},v=function(r,e){var t=n.getItem(r);if(!t)throw new Error("ERROR: No item with id: "+r);var i=null,a=null;return u.isFormula(e)?i=e.substr(1):a=e,n.updateItem(t,{value:a,formula:i}),n.recalculate(),m(t)},d=function(r,e){var t=n.getItem(r);if(!t)throw new Error("ERROR: No item with id: "+r);if(t.formula)throw new Error("ERROR: The item appears to be a formula item. You can only set the value of non-formula items");if(u.isFormula(e))throw new Error("ERROR: The new value appears to be a formula");return n.updateItem(t,{value:e}),n.recalculate(),m(t)},y=function(){var r=[];return t.forEach(n.getAllItems(),function(e){var n=e.row,t=e.col;"undefined"==typeof r[n]&&(r[n]=[]),r[n][t]=m(e)}),r},b=function(r){return n.getDependencies(r)},E=function(r,e){if(e[r])return e[r];var t=n.getItem(r),u=h(r);if(e[r]={item:u,depIds:t.deps,deps:[]},t.deps)for(var i=0,a=t.deps.length;a>i;i++)e[r].deps.push(E(t.deps[i],e));return e[r]},N=function(r){var e=n.getItem(r);return E(e.id,{})},x=function(){n.recalculate()},I=function(u){var o=t.extend({supportedFormulas:"all",additionalFormulas:null},u);null!==o.additionalFormulas&&(o.additionalFormulas=t.extend(i,o.additionalFormulas)),l=this,n=new f(l),e=new a(new s(n,o.additionalFormulas,o.supportedFormulas)),r&&(n.scan(r),n.recalculate())};return{init:I,version:c,parse:p,getGraph:N,getAllCells:y,getCell:h,setCell:v,setCellValue:d,getCells:g,getDependantIds:b,recalculate:x}}},function(r,e,n){var t;(function(r,u){(function(){function i(r,e){if(r!==e){var n=null===r,t=r===_,u=r===r,i=null===e,a=e===_,o=e===e;if(r>e&&!i||!u||n&&!a&&o||t&&o)return 1;if(e>r&&!n||!o||i&&!t&&u||a&&u)return-1}return 0}function a(r,e,n){for(var t=r.length,u=n?t:-1;n?u--:++u<t;)if(e(r[u],u,r))return u;return-1}function o(r,e,n){if(e!==e)return y(r,n);for(var t=n-1,u=r.length;++t<u;)if(r[t]===e)return t;return-1}function s(r){return"function"==typeof r||!1}function f(r){return null==r?"":r+""}function l(r,e){for(var n=-1,t=r.length;++n<t&&e.indexOf(r.charAt(n))>-1;);return n}function c(r,e){for(var n=r.length;n--&&e.indexOf(r.charAt(n))>-1;);return n}function p(r,e){return i(r.criteria,e.criteria)||r.index-e.index}function m(r,e,n){for(var t=-1,u=r.criteria,a=e.criteria,o=u.length,s=n.length;++t<o;){var f=i(u[t],a[t]);if(f){if(t>=s)return f;var l=n[t];return f*("asc"===l||l===!0?1:-1)}}return r.index-e.index}function h(r){return Xr[r]}function g(r){return Hr[r]}function v(r,e,n){return e?r=Kr[r]:n&&(r=zr[r]),"\\"+r}function d(r){return"\\"+zr[r]}function y(r,e,n){for(var t=r.length,u=e+(n?0:-1);n?u--:++u<t;){var i=r[u];if(i!==i)return u}return-1}function b(r){return!!r&&"object"==typeof r}function E(r){return 160>=r&&r>=9&&13>=r||32==r||160==r||5760==r||6158==r||r>=8192&&(8202>=r||8232==r||8233==r||8239==r||8287==r||12288==r||65279==r)}function N(r,e){for(var n=-1,t=r.length,u=-1,i=[];++n<t;)r[n]===e&&(r[n]=X,i[++u]=n);return i}function x(r,e){for(var n,t=-1,u=r.length,i=-1,a=[];++t<u;){var o=r[t],s=e?e(o,t,r):o;t&&n===s||(n=s,a[++i]=o)}return a}function I(r){for(var e=-1,n=r.length;++e<n&&E(r.charCodeAt(e)););return e}function M(r){for(var e=r.length;e--&&E(r.charCodeAt(e)););return e}function A(r){return Qr[r]}function w(r){function e(r){if(b(r)&&!Vo(r)&&!(r instanceof u)){if(r instanceof t)return r;if(ra.call(r,"__chain__")&&ra.call(r,"__wrapped__"))return mt(r)}return new t(r)}function n(){}function t(r,e,n){this.__wrapped__=r,this.__actions__=n||[],this.__chain__=!!e}function u(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_a,this.__views__=[]}function E(){var r=new u(this.__wrapped__);return r.__actions__=re(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=re(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=re(this.__views__),r}function J(){if(this.__filtered__){var r=new u(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function tr(){var r=this.__wrapped__.value(),e=this.__dir__,n=Vo(r),t=0>e,u=n?r.length:0,i=Xn(0,u,this.__views__),a=i.start,o=i.end,s=o-a,f=t?o:a-1,l=this.__iteratees__,c=l.length,p=0,m=xa(s,this.__takeCount__);if(!n||q>u||u==s&&m==s)return nn(t&&n?r.reverse():r,this.__actions__);var h=[];r:for(;s--&&m>p;){f+=e;for(var g=-1,v=r[f];++g<c;){var d=l[g],y=d.iteratee,b=d.type,E=y(v);if(b==G)v=E;else if(!E){if(b==B)continue r;break r}}h[p++]=v}return h}function ir(){this.__data__={}}function Xr(r){return this.has(r)&&delete this.__data__[r]}function Hr(r){return"__proto__"==r?_:this.__data__[r]}function Qr(r){return"__proto__"!=r&&ra.call(this.__data__,r)}function Wr(r,e){return"__proto__"!=r&&(this.__data__[r]=e),this}function Kr(r){var e=r?r.length:0;for(this.data={hash:va(null),set:new la};e--;)this.push(r[e])}function zr(r,e){var n=r.data,t="string"==typeof e||Cu(e)?n.set.has(e):n.hash[e];return t?0:-1}function Zr(r){var e=this.data;"string"==typeof r||Cu(r)?e.set.add(r):e.hash[r]=!0}function Jr(r,e){for(var n=-1,t=r.length,u=-1,i=e.length,a=Fi(t+i);++n<t;)a[n]=r[n];for(;++u<i;)a[n++]=e[u];return a}function re(r,e){var n=-1,t=r.length;for(e||(e=Fi(t));++n<t;)e[n]=r[n];return e}function ee(r,e){for(var n=-1,t=r.length;++n<t&&e(r[n],n,r)!==!1;);return r}function ne(r,e){for(var n=r.length;n--&&e(r[n],n,r)!==!1;);return r}function ie(r,e){for(var n=-1,t=r.length;++n<t;)if(!e(r[n],n,r))return!1;return!0}function ae(r,e,n,t){for(var u=-1,i=r.length,a=t,o=a;++u<i;){var s=r[u],f=+e(s);n(f,a)&&(a=f,o=s)}return o}function oe(r,e){for(var n=-1,t=r.length,u=-1,i=[];++n<t;){var a=r[n];e(a,n,r)&&(i[++u]=a)}return i}function se(r,e){for(var n=-1,t=r.length,u=Fi(t);++n<t;)u[n]=e(r[n],n,r);return u}function fe(r,e){for(var n=-1,t=e.length,u=r.length;++n<t;)r[u+n]=e[n];return r}function le(r,e,n,t){var u=-1,i=r.length;for(t&&i&&(n=r[++u]);++u<i;)n=e(n,r[u],u,r);return n}function ce(r,e,n,t){var u=r.length;for(t&&u&&(n=r[--u]);u--;)n=e(n,r[u],u,r);return n}function pe(r,e){for(var n=-1,t=r.length;++n<t;)if(e(r[n],n,r))return!0;return!1}function me(r,e){for(var n=r.length,t=0;n--;)t+=+e(r[n])||0;return t}function he(r,e){return r===_?e:r}function ge(r,e,n,t){return r!==_&&ra.call(t,n)?r:e}function ve(r,e,n){for(var t=-1,u=Fo(e),i=u.length;++t<i;){var a=u[t],o=r[a],s=n(o,e[a],a,r,e);(s===s?s===o:o!==o)&&(o!==_||a in r)||(r[a]=s)}return r}function de(r,e){return null==e?r:be(e,Fo(e),r)}function ye(r,e){for(var n=-1,t=null==r,u=!t&&zn(r),i=u?r.length:0,a=e.length,o=Fi(a);++n<a;){var s=e[n];u?o[n]=Zn(s,i)?r[s]:_:o[n]=t?_:r[s]}return o}function be(r,e,n){n||(n={});for(var t=-1,u=e.length;++t<u;){var i=e[t];n[i]=r[i]}return n}function Ee(r,e,n){var t=typeof r;return"function"==t?e===_?r:an(r,e,n):null==r?_i:"object"==t?Pe(r):e===_?Oi(r):Fe(r,e)}function Ne(r,e,n,t,u,i,a){var o;if(n&&(o=u?n(r,t,u):n(r)),o!==_)return o;if(!Cu(r))return r;var s=Vo(r);if(s){if(o=Hn(r),!e)return re(r,o)}else{var f=na.call(r),l=f==Z;if(f!=er&&f!=H&&(!l||u))return Yr[f]?Wn(r,f,e):u?r:{};if(o=Qn(l?{}:r),!e)return de(o,r)}i||(i=[]),a||(a=[]);for(var c=i.length;c--;)if(i[c]==r)return a[c];return i.push(r),a.push(o),(s?ee:Te)(r,function(t,u){o[u]=Ne(t,e,n,u,r,i,a)}),o}function xe(r,e,n){if("function"!=typeof r)throw new Wi(Y);return ca(function(){r.apply(_,n)},e)}function Ie(r,e){var n=r?r.length:0,t=[];if(!n)return t;var u=-1,i=Bn(),a=i==o,s=a&&e.length>=q?gn(e):null,f=e.length;s&&(i=zr,a=!1,e=s);r:for(;++u<n;){var l=r[u];if(a&&l===l){for(var c=f;c--;)if(e[c]===l)continue r;t.push(l)}else i(e,l,0)<0&&t.push(l)}return t}function Me(r,e){var n=!0;return Da(r,function(r,t,u){return n=!!e(r,t,u)}),n}function Ae(r,e,n,t){var u=t,i=u;return Da(r,function(r,a,o){var s=+e(r,a,o);(n(s,u)||s===t&&s===i)&&(u=s,i=r)}),i}function we(r,e,n,t){var u=r.length;for(n=null==n?0:+n||0,0>n&&(n=-n>u?0:u+n),t=t===_||t>u?u:+t||0,0>t&&(t+=u),u=n>t?0:t>>>0,n>>>=0;u>n;)r[n++]=e;return r}function _e(r,e){var n=[];return Da(r,function(r,t,u){e(r,t,u)&&n.push(r)}),n}function $e(r,e,n,t){var u;return n(r,function(r,n,i){return e(r,n,i)?(u=t?n:r,!1):void 0}),u}function Ve(r,e,n,t){t||(t=[]);for(var u=-1,i=r.length;++u<i;){var a=r[u];b(a)&&zn(a)&&(n||Vo(a)||Au(a))?e?Ve(a,e,n,t):fe(t,a):n||(t[t.length]=a)}return t}function Se(r,e){return ka(r,e,ri)}function Te(r,e){return ka(r,e,Fo)}function Re(r,e){return ja(r,e,Fo)}function Oe(r,e){for(var n=-1,t=e.length,u=-1,i=[];++n<t;){var a=e[n];Ou(r[a])&&(i[++u]=a)}return i}function Ce(r,e,n){if(null!=r){n!==_&&n in ct(r)&&(e=[n]);for(var t=0,u=e.length;null!=r&&u>t;)r=r[e[t++]];return t&&t==u?r:_}}function De(r,e,n,t,u,i){return r===e?!0:null==r||null==e||!Cu(r)&&!b(e)?r!==r&&e!==e:Le(r,e,De,n,t,u,i)}function Le(r,e,n,t,u,i,a){var o=Vo(r),s=Vo(e),f=Q,l=Q;o||(f=na.call(r),f==H?f=er:f!=er&&(o=Bu(r))),s||(l=na.call(e),l==H?l=er:l!=er&&(s=Bu(e)));var c=f==er,p=l==er,m=f==l;if(m&&!o&&!c)return Pn(r,e,f);if(!u){var h=c&&ra.call(r,"__wrapped__"),g=p&&ra.call(e,"__wrapped__");if(h||g)return n(h?r.value():r,g?e.value():e,t,u,i,a)}if(!m)return!1;i||(i=[]),a||(a=[]);for(var v=i.length;v--;)if(i[v]==r)return a[v]==e;i.push(r),a.push(e);var d=(o?jn:Fn)(r,e,n,t,u,i,a);return i.pop(),a.pop(),d}function ke(r,e,n){var t=e.length,u=t,i=!n;if(null==r)return!u;for(r=ct(r);t--;){var a=e[t];if(i&&a[2]?a[1]!==r[a[0]]:!(a[0]in r))return!1}for(;++t<u;){a=e[t];var o=a[0],s=r[o],f=a[1];if(i&&a[2]){if(s===_&&!(o in r))return!1}else{var l=n?n(s,f,o):_;if(!(l===_?De(f,s,n,!0):l))return!1}}return!0}function je(r,e){var n=-1,t=zn(r)?Fi(r.length):[];return Da(r,function(r,u,i){t[++n]=e(r,u,i)}),t}function Pe(r){var e=Gn(r);if(1==e.length&&e[0][2]){var n=e[0][0],t=e[0][1];return function(r){return null==r?!1:r[n]===t&&(t!==_||n in ct(r))}}return function(r){return ke(r,e)}}function Fe(r,e){var n=Vo(r),t=rt(r)&&tt(e),u=r+"";return r=pt(r),function(i){if(null==i)return!1;var a=u;if(i=ct(i),(n||!t)&&!(a in i)){if(i=1==r.length?i:Ce(i,Qe(r,0,-1)),null==i)return!1;a=wt(r),i=ct(i)}return i[a]===e?e!==_||a in i:De(e,i[a],_,!0)}}function Ue(r,e,n,t,u){if(!Cu(r))return r;var i=zn(e)&&(Vo(e)||Bu(e)),a=i?_:Fo(e);return ee(a||e,function(o,s){if(a&&(s=o,o=e[s]),b(o))t||(t=[]),u||(u=[]),qe(r,e,s,Ue,n,t,u);else{var f=r[s],l=n?n(f,o,s,r,e):_,c=l===_;c&&(l=o),l===_&&(!i||s in r)||!c&&(l===l?l===f:f!==f)||(r[s]=l)}}),r}function qe(r,e,n,t,u,i,a){for(var o=i.length,s=e[n];o--;)if(i[o]==s)return void(r[n]=a[o]);var f=r[n],l=u?u(f,s,n,r,e):_,c=l===_;c&&(l=s,zn(s)&&(Vo(s)||Bu(s))?l=Vo(f)?f:zn(f)?re(f):[]:Fu(s)||Au(s)?l=Au(f)?Qu(f):Fu(f)?f:{}:c=!1),i.push(s),a.push(l),c?r[n]=t(l,s,u,i,a):(l===l?l!==f:f===f)&&(r[n]=l)}function Be(r){return function(e){return null==e?_:e[r]}}function Ge(r){var e=r+"";return r=pt(r),function(n){return Ce(n,r,e)}}function Ye(r,e){for(var n=r?e.length:0;n--;){var t=e[n];if(t!=u&&Zn(t)){var u=t;pa.call(r,t,1)}}return r}function Xe(r,e){return r+da(Aa()*(e-r+1))}function He(r,e,n,t,u){return u(r,function(r,u,i){n=t?(t=!1,r):e(n,r,u,i)}),n}function Qe(r,e,n){var t=-1,u=r.length;e=null==e?0:+e||0,0>e&&(e=-e>u?0:u+e),n=n===_||n>u?u:+n||0,0>n&&(n+=u),u=e>n?0:n-e>>>0,e>>>=0;for(var i=Fi(u);++t<u;)i[t]=r[t+e];return i}function We(r,e){var n;return Da(r,function(r,t,u){return n=e(r,t,u),!n}),!!n}function Ke(r,e){var n=r.length;for(r.sort(e);n--;)r[n]=r[n].value;return r}function ze(r,e,n){var t=Un(),u=-1;e=se(e,function(r){return t(r)});var i=je(r,function(r){var n=se(e,function(e){return e(r)});return{criteria:n,index:++u,value:r}});return Ke(i,function(r,e){return m(r,e,n)})}function Ze(r,e){var n=0;return Da(r,function(r,t,u){n+=+e(r,t,u)||0}),n}function Je(r,e){var n=-1,t=Bn(),u=r.length,i=t==o,a=i&&u>=q,s=a?gn():null,f=[];s?(t=zr,i=!1):(a=!1,s=e?[]:f);r:for(;++n<u;){var l=r[n],c=e?e(l,n,r):l;if(i&&l===l){for(var p=s.length;p--;)if(s[p]===c)continue r;e&&s.push(c),f.push(l)}else t(s,c,0)<0&&((e||a)&&s.push(c),f.push(l))}return f}function rn(r,e){for(var n=-1,t=e.length,u=Fi(t);++n<t;)u[n]=r[e[n]];return u}function en(r,e,n,t){for(var u=r.length,i=t?u:-1;(t?i--:++i<u)&&e(r[i],i,r););return n?Qe(r,t?0:i,t?i+1:u):Qe(r,t?i+1:0,t?u:i)}function nn(r,e){var n=r;n instanceof u&&(n=n.value());for(var t=-1,i=e.length;++t<i;){var a=e[t];n=a.func.apply(a.thisArg,fe([n],a.args))}return n}function tn(r,e,n){var t=0,u=r?r.length:t;if("number"==typeof e&&e===e&&Sa>=u){for(;u>t;){var i=t+u>>>1,a=r[i];(n?e>=a:e>a)&&null!==a?t=i+1:u=i}return u}return un(r,e,_i,n)}function un(r,e,n,t){e=n(e);for(var u=0,i=r?r.length:0,a=e!==e,o=null===e,s=e===_;i>u;){var f=da((u+i)/2),l=n(r[f]),c=l!==_,p=l===l;if(a)var m=p||t;else m=o?p&&c&&(t||null!=l):s?p&&(t||c):null==l?!1:t?e>=l:e>l;m?u=f+1:i=f}return xa(i,Va)}function an(r,e,n){if("function"!=typeof r)return _i;if(e===_)return r;switch(n){case 1:return function(n){return r.call(e,n)};case 3:return function(n,t,u){return r.call(e,n,t,u)};case 4:return function(n,t,u,i){return r.call(e,n,t,u,i)};case 5:return function(n,t,u,i,a){return r.call(e,n,t,u,i,a)}}return function(){return r.apply(e,arguments)}}function on(r){var e=new ia(r.byteLength),n=new ma(e);return n.set(new ma(r)),e}function sn(r,e,n){for(var t=n.length,u=-1,i=Na(r.length-t,0),a=-1,o=e.length,s=Fi(o+i);++a<o;)s[a]=e[a];for(;++u<t;)s[n[u]]=r[u];for(;i--;)s[a++]=r[u++];return s}function fn(r,e,n){for(var t=-1,u=n.length,i=-1,a=Na(r.length-u,0),o=-1,s=e.length,f=Fi(a+s);++i<a;)f[i]=r[i];for(var l=i;++o<s;)f[l+o]=e[o];for(;++t<u;)f[l+n[t]]=r[i++];return f}function ln(r,e){return function(n,t,u){var i=e?e():{};if(t=Un(t,u,3),Vo(n))for(var a=-1,o=n.length;++a<o;){var s=n[a];r(i,s,t(s,a,n),n)}else Da(n,function(e,n,u){r(i,e,t(e,n,u),u)});return i}}function cn(r){return du(function(e,n){var t=-1,u=null==e?0:n.length,i=u>2?n[u-2]:_,a=u>2?n[2]:_,o=u>1?n[u-1]:_;for("function"==typeof i?(i=an(i,o,5),u-=2):(i="function"==typeof o?o:_,u-=i?1:0),a&&Jn(n[0],n[1],a)&&(i=3>u?_:i,u=1);++t<u;){var s=n[t];s&&r(e,s,i)}return e})}function pn(r,e){return function(n,t){var u=n?Ua(n):0;if(!nt(u))return r(n,t);for(var i=e?u:-1,a=ct(n);(e?i--:++i<u)&&t(a[i],i,a)!==!1;);return n}}function mn(r){return function(e,n,t){for(var u=ct(e),i=t(e),a=i.length,o=r?a:-1;r?o--:++o<a;){var s=i[o];if(n(u[s],s,u)===!1)break}return e}}function hn(r,e){function n(){var u=this&&this!==te&&this instanceof n?t:r;return u.apply(e,arguments)}var t=dn(r);return n}function gn(r){return va&&la?new Kr(r):null}function vn(r){return function(e){for(var n=-1,t=Mi(li(e)),u=t.length,i="";++n<u;)i=r(i,t[n],n);return i}}function dn(r){return function(){var e=arguments;switch(e.length){case 0:return new r;case 1:return new r(e[0]);case 2:return new r(e[0],e[1]);case 3:return new r(e[0],e[1],e[2]);case 4:return new r(e[0],e[1],e[2],e[3]);case 5:return new r(e[0],e[1],e[2],e[3],e[4]);case 6:return new r(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new r(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Ca(r.prototype),t=r.apply(n,e);return Cu(t)?t:n}}function yn(r){function e(n,t,u){u&&Jn(n,t,u)&&(t=_);var i=kn(n,r,_,_,_,_,_,t);return i.placeholder=e.placeholder,i}return e}function bn(r,e){return du(function(n){var t=n[0];return null==t?t:(n.push(e),r.apply(_,n))})}function En(r,e){return function(n,t,u){if(u&&Jn(n,t,u)&&(t=_),t=Un(t,u,3),1==t.length){n=Vo(n)?n:lt(n);var i=ae(n,t,r,e);if(!n.length||i!==e)return i}return Ae(n,t,r,e)}}function Nn(r,e){return function(n,t,u){if(t=Un(t,u,3),Vo(n)){var i=a(n,t,e);return i>-1?n[i]:_}return $e(n,t,r)}}function xn(r){return function(e,n,t){return e&&e.length?(n=Un(n,t,3),a(e,n,r)):-1}}function In(r){return function(e,n,t){return n=Un(n,t,3),$e(e,n,r,!0)}}function Mn(r){return function(){for(var e,n=arguments.length,u=r?n:-1,i=0,a=Fi(n);r?u--:++u<n;){var o=a[i++]=arguments[u];if("function"!=typeof o)throw new Wi(Y);!e&&t.prototype.thru&&"wrapper"==qn(o)&&(e=new t([],!0))}for(u=e?-1:n;++u<n;){o=a[u];var s=qn(o),f="wrapper"==s?Fa(o):_;e=f&&et(f[0])&&f[1]==(L|R|C|k)&&!f[4].length&&1==f[9]?e[qn(f[0])].apply(e,f[3]):1==o.length&&et(o)?e[s]():e.thru(o)}return function(){var r=arguments,t=r[0];if(e&&1==r.length&&Vo(t)&&t.length>=q)return e.plant(t).value();for(var u=0,i=n?a[u].apply(this,r):t;++u<n;)i=a[u].call(this,i);return i}}}function An(r,e){return function(n,t,u){return"function"==typeof t&&u===_&&Vo(n)?r(n,t):e(n,an(t,u,3))}}function wn(r){return function(e,n,t){return("function"!=typeof n||t!==_)&&(n=an(n,t,3)),r(e,n,ri)}}function _n(r){return function(e,n,t){return("function"!=typeof n||t!==_)&&(n=an(n,t,3)),r(e,n)}}function $n(r){return function(e,n,t){var u={};return n=Un(n,t,3),Te(e,function(e,t,i){var a=n(e,t,i);t=r?a:t,e=r?e:a,u[t]=e}),u}}function Vn(r){return function(e,n,t){return e=f(e),(r?e:"")+On(e,n,t)+(r?"":e)}}function Sn(r){var e=du(function(n,t){var u=N(t,e.placeholder);return kn(n,r,_,t,u)});return e}function Tn(r,e){return function(n,t,u,i){var a=arguments.length<3;return"function"==typeof t&&i===_&&Vo(n)?r(n,t,u,a):He(n,Un(t,i,4),u,a,e)}}function Rn(r,e,n,t,u,i,a,o,s,f){function l(){for(var y=arguments.length,b=y,E=Fi(y);b--;)E[b]=arguments[b];if(t&&(E=sn(E,t,u)),i&&(E=fn(E,i,a)),h||v){var x=l.placeholder,I=N(E,x);if(y-=I.length,f>y){var M=o?re(o):_,A=Na(f-y,0),w=h?I:_,$=h?_:I,T=h?E:_,R=h?_:E;e|=h?C:D,e&=~(h?D:C),g||(e&=~(V|S));var O=[r,e,n,T,w,R,$,M,s,A],L=Rn.apply(_,O);return et(r)&&qa(L,O),L.placeholder=x,L}}var k=p?n:this,j=m?k[r]:r;return o&&(E=st(E,o)),c&&s<E.length&&(E.length=s),this&&this!==te&&this instanceof l&&(j=d||dn(r)),j.apply(k,E)}var c=e&L,p=e&V,m=e&S,h=e&R,g=e&T,v=e&O,d=m?_:dn(r);return l}function On(r,e,n){var t=r.length;if(e=+e,t>=e||!ba(e))return"";var u=e-t;return n=null==n?" ":n+"",vi(n,ga(u/n.length)).slice(0,u)}function Cn(r,e,n,t){function u(){for(var e=-1,o=arguments.length,s=-1,f=t.length,l=Fi(f+o);++s<f;)l[s]=t[s];for(;o--;)l[s++]=arguments[++e];var c=this&&this!==te&&this instanceof u?a:r;return c.apply(i?n:this,l)}var i=e&V,a=dn(r);return u}function Dn(r){var e=Gi[r];return function(r,n){return n=n===_?0:+n||0,n?(n=sa(10,n),e(r*n)/n):e(r)}}function Ln(r){return function(e,n,t,u){var i=Un(t);return null==t&&i===Ee?tn(e,n,r):un(e,n,i(t,u,1),r)}}function kn(r,e,n,t,u,i,a,o){var s=e&S;if(!s&&"function"!=typeof r)throw new Wi(Y);var f=t?t.length:0;if(f||(e&=~(C|D),t=u=_),f-=u?u.length:0,e&D){var l=t,c=u;t=u=_}var p=s?_:Fa(r),m=[r,e,n,t,u,l,c,i,a,o];if(p&&(ut(m,p),e=m[1],o=m[9]),m[9]=null==o?s?0:r.length:Na(o-f,0)||0,e==V)var h=hn(m[0],m[2]);else h=e!=C&&e!=(V|C)||m[4].length?Rn.apply(_,m):Cn.apply(_,m);var g=p?Pa:qa;return g(h,m)}function jn(r,e,n,t,u,i,a){var o=-1,s=r.length,f=e.length;if(s!=f&&!(u&&f>s))return!1;for(;++o<s;){var l=r[o],c=e[o],p=t?t(u?c:l,u?l:c,o):_;if(p!==_){if(p)continue;return!1}if(u){if(!pe(e,function(r){return l===r||n(l,r,t,u,i,a)}))return!1}else if(l!==c&&!n(l,c,t,u,i,a))return!1}return!0}function Pn(r,e,n){switch(n){case W:case K:return+r==+e;case z:return r.name==e.name&&r.message==e.message;case rr:return r!=+r?e!=+e:r==+e;case nr:case ur:return r==e+""}return!1}function Fn(r,e,n,t,u,i,a){var o=Fo(r),s=o.length,f=Fo(e),l=f.length;if(s!=l&&!u)return!1;for(var c=s;c--;){var p=o[c];if(!(u?p in e:ra.call(e,p)))return!1}for(var m=u;++c<s;){p=o[c];var h=r[p],g=e[p],v=t?t(u?g:h,u?h:g,p):_;if(!(v===_?n(h,g,t,u,i,a):v))return!1;m||(m="constructor"==p)}if(!m){var d=r.constructor,y=e.constructor;if(d!=y&&"constructor"in r&&"constructor"in e&&!("function"==typeof d&&d instanceof d&&"function"==typeof y&&y instanceof y))return!1}return!0}function Un(r,n,t){var u=e.callback||Ai;return u=u===Ai?Ee:u,t?u(r,n,t):u}function qn(r){for(var e=r.name,n=Oa[e],t=n?n.length:0;t--;){var u=n[t],i=u.func;if(null==i||i==r)return u.name}return e}function Bn(r,n,t){var u=e.indexOf||Mt;return u=u===Mt?o:u,r?u(r,n,t):u}function Gn(r){for(var e=ei(r),n=e.length;n--;)e[n][2]=tt(e[n][1]);return e}function Yn(r,e){var n=null==r?_:r[e];return ku(n)?n:_}function Xn(r,e,n){for(var t=-1,u=n.length;++t<u;){var i=n[t],a=i.size;switch(i.type){case"drop":r+=a;break;case"dropRight":e-=a;break;case"take":e=xa(e,r+a);break;case"takeRight":r=Na(r,e-a)}}return{start:r,end:e}}function Hn(r){var e=r.length,n=new r.constructor(e);return e&&"string"==typeof r[0]&&ra.call(r,"index")&&(n.index=r.index,n.input=r.input),n}function Qn(r){var e=r.constructor;return"function"==typeof e&&e instanceof e||(e=Xi),new e}function Wn(r,e,n){var t=r.constructor;switch(e){case ar:return on(r);case W:case K:return new t(+r);case or:case sr:case fr:case lr:case cr:case pr:case mr:case hr:case gr:var u=r.buffer;return new t(n?on(u):u,r.byteOffset,r.length);case rr:case ur:return new t(r);case nr:var i=new t(r.source,Cr.exec(r));i.lastIndex=r.lastIndex}return i}function Kn(r,e,n){null==r||rt(e,r)||(e=pt(e),r=1==e.length?r:Ce(r,Qe(e,0,-1)),e=wt(e));var t=null==r?r:r[e];return null==t?_:t.apply(r,n)}function zn(r){return null!=r&&nt(Ua(r))}function Zn(r,e){return r="number"==typeof r||kr.test(r)?+r:-1,e=null==e?Ta:e,r>-1&&r%1==0&&e>r}function Jn(r,e,n){if(!Cu(n))return!1;var t=typeof e;if("number"==t?zn(n)&&Zn(e,n.length):"string"==t&&e in n){var u=n[e];return r===r?r===u:u!==u}return!1}function rt(r,e){var n=typeof r;if("string"==n&&_r.test(r)||"number"==n)return!0;if(Vo(r))return!1;var t=!wr.test(r);return t||null!=e&&r in ct(e)}function et(r){var n=qn(r);if(!(n in u.prototype))return!1;var t=e[n];if(r===t)return!0;var i=Fa(t);return!!i&&r===i[0]}function nt(r){return"number"==typeof r&&r>-1&&r%1==0&&Ta>=r}function tt(r){return r===r&&!Cu(r)}function ut(r,e){var n=r[1],t=e[1],u=n|t,i=L>u,a=t==L&&n==R||t==L&&n==k&&r[7].length<=e[8]||t==(L|k)&&n==R;if(!i&&!a)return r;t&V&&(r[2]=e[2],u|=n&V?0:T);var o=e[3];if(o){var s=r[3];r[3]=s?sn(s,o,e[4]):re(o),r[4]=s?N(r[3],X):re(e[4])}return o=e[5],o&&(s=r[5],r[5]=s?fn(s,o,e[6]):re(o),r[6]=s?N(r[5],X):re(e[6])),o=e[7],o&&(r[7]=re(o)),t&L&&(r[8]=null==r[8]?e[8]:xa(r[8],e[8])),null==r[9]&&(r[9]=e[9]),r[0]=e[0],r[1]=u,r}function it(r,e){return r===_?e:So(r,e,it)}function at(r,e){r=ct(r);for(var n=-1,t=e.length,u={};++n<t;){var i=e[n];i in r&&(u[i]=r[i])}return u}function ot(r,e){var n={};return Se(r,function(r,t,u){e(r,t,u)&&(n[t]=r)}),n}function st(r,e){for(var n=r.length,t=xa(e.length,n),u=re(r);t--;){var i=e[t];r[t]=Zn(i,n)?u[i]:_}return r}function ft(r){for(var e=ri(r),n=e.length,t=n&&r.length,u=!!t&&nt(t)&&(Vo(r)||Au(r)),i=-1,a=[];++i<n;){var o=e[i];(u&&Zn(o,t)||ra.call(r,o))&&a.push(o)}return a}function lt(r){return null==r?[]:zn(r)?Cu(r)?r:Xi(r):ii(r)}function ct(r){return Cu(r)?r:Xi(r)}function pt(r){if(Vo(r))return r;var e=[];return f(r).replace($r,function(r,n,t,u){e.push(t?u.replace(Rr,"$1"):n||r)}),e}function mt(r){return r instanceof u?r.clone():new t(r.__wrapped__,r.__chain__,re(r.__actions__))}function ht(r,e,n){e=(n?Jn(r,e,n):null==e)?1:Na(da(e)||1,1);for(var t=0,u=r?r.length:0,i=-1,a=Fi(ga(u/e));u>t;)a[++i]=Qe(r,t,t+=e);return a}function gt(r){for(var e=-1,n=r?r.length:0,t=-1,u=[];++e<n;){var i=r[e];i&&(u[++t]=i)}return u}function vt(r,e,n){var t=r?r.length:0;return t?((n?Jn(r,e,n):null==e)&&(e=1),Qe(r,0>e?0:e)):[]}function dt(r,e,n){var t=r?r.length:0;return t?((n?Jn(r,e,n):null==e)&&(e=1),e=t-(+e||0),Qe(r,0,0>e?0:e)):[]}function yt(r,e,n){return r&&r.length?en(r,Un(e,n,3),!0,!0):[]}function bt(r,e,n){return r&&r.length?en(r,Un(e,n,3),!0):[]}function Et(r,e,n,t){var u=r?r.length:0;return u?(n&&"number"!=typeof n&&Jn(r,e,n)&&(n=0,t=u),we(r,e,n,t)):[]}function Nt(r){return r?r[0]:_}function xt(r,e,n){var t=r?r.length:0;return n&&Jn(r,e,n)&&(e=!1),t?Ve(r,e):[]}function It(r){var e=r?r.length:0;return e?Ve(r,!0):[]}function Mt(r,e,n){var t=r?r.length:0;if(!t)return-1;if("number"==typeof n)n=0>n?Na(t+n,0):n;else if(n){var u=tn(r,e);return t>u&&(e===e?e===r[u]:r[u]!==r[u])?u:-1}return o(r,e,n||0)}function At(r){return dt(r,1)}function wt(r){var e=r?r.length:0;return e?r[e-1]:_}function _t(r,e,n){var t=r?r.length:0;if(!t)return-1;var u=t;if("number"==typeof n)u=(0>n?Na(t+n,0):xa(n||0,t-1))+1;else if(n){u=tn(r,e,!0)-1;var i=r[u];return(e===e?e===i:i!==i)?u:-1}if(e!==e)return y(r,u,!0);for(;u--;)if(r[u]===e)return u;return-1}function $t(){var r=arguments,e=r[0];if(!e||!e.length)return e;for(var n=0,t=Bn(),u=r.length;++n<u;)for(var i=0,a=r[n];(i=t(e,a,i))>-1;)pa.call(e,i,1);return e}function Vt(r,e,n){var t=[];if(!r||!r.length)return t;var u=-1,i=[],a=r.length;for(e=Un(e,n,3);++u<a;){var o=r[u];e(o,u,r)&&(t.push(o),i.push(u))}return Ye(r,i),t}function St(r){return vt(r,1)}function Tt(r,e,n){var t=r?r.length:0;return t?(n&&"number"!=typeof n&&Jn(r,e,n)&&(e=0,n=t),Qe(r,e,n)):[]}function Rt(r,e,n){var t=r?r.length:0;return t?((n?Jn(r,e,n):null==e)&&(e=1),Qe(r,0,0>e?0:e)):[]}function Ot(r,e,n){var t=r?r.length:0;return t?((n?Jn(r,e,n):null==e)&&(e=1),e=t-(+e||0),Qe(r,0>e?0:e)):[]}function Ct(r,e,n){return r&&r.length?en(r,Un(e,n,3),!1,!0):[]}function Dt(r,e,n){return r&&r.length?en(r,Un(e,n,3)):[]}function Lt(r,e,n,t){var u=r?r.length:0;if(!u)return[];null!=e&&"boolean"!=typeof e&&(t=n,n=Jn(r,e,t)?_:e,e=!1);var i=Un();return(null!=n||i!==Ee)&&(n=i(n,t,3)),e&&Bn()==o?x(r,n):Je(r,n)}function kt(r){if(!r||!r.length)return[];var e=-1,n=0;r=oe(r,function(r){return zn(r)?(n=Na(r.length,n),!0):void 0});for(var t=Fi(n);++e<n;)t[e]=se(r,Be(e));return t}function jt(r,e,n){var t=r?r.length:0;if(!t)return[];var u=kt(r);return null==e?u:(e=an(e,n,4),se(u,function(r){return le(r,e,_,!0)}))}function Pt(){for(var r=-1,e=arguments.length;++r<e;){var n=arguments[r];if(zn(n))var t=t?fe(Ie(t,n),Ie(n,t)):n}return t?Je(t):[]}function Ft(r,e){var n=-1,t=r?r.length:0,u={};for(!t||e||Vo(r[0])||(e=[]);++n<t;){var i=r[n];e?u[i]=e[n]:i&&(u[i[0]]=i[1])}return u}function Ut(r){var n=e(r);return n.__chain__=!0,n}function qt(r,e,n){return e.call(n,r),r}function Bt(r,e,n){return e.call(n,r)}function Gt(){return Ut(this)}function Yt(){return new t(this.value(),this.__chain__)}function Xt(r){for(var e,t=this;t instanceof n;){var u=mt(t);e?i.__wrapped__=u:e=u;var i=u;t=t.__wrapped__}return i.__wrapped__=r,e}function Ht(){var r=this.__wrapped__,e=function(r){return n&&n.__dir__<0?r:r.reverse()};if(r instanceof u){var n=r;return this.__actions__.length&&(n=new u(this)),n=n.reverse(),n.__actions__.push({func:Bt,args:[e],thisArg:_}),new t(n,this.__chain__)}return this.thru(e)}function Qt(){return this.value()+""}function Wt(){return nn(this.__wrapped__,this.__actions__)}function Kt(r,e,n){var t=Vo(r)?ie:Me;return n&&Jn(r,e,n)&&(e=_),("function"!=typeof e||n!==_)&&(e=Un(e,n,3)),t(r,e)}function zt(r,e,n){var t=Vo(r)?oe:_e;return e=Un(e,n,3),t(r,e)}function Zt(r,e){return to(r,Pe(e))}function Jt(r,e,n,t){var u=r?Ua(r):0;return nt(u)||(r=ii(r),u=r.length),n="number"!=typeof n||t&&Jn(e,n,t)?0:0>n?Na(u+n,0):n||0,"string"==typeof r||!Vo(r)&&qu(r)?u>=n&&r.indexOf(e,n)>-1:!!u&&Bn(r,e,n)>-1}function ru(r,e,n){var t=Vo(r)?se:je;return e=Un(e,n,3),t(r,e)}function eu(r,e){return ru(r,Oi(e))}function nu(r,e,n){var t=Vo(r)?oe:_e;return e=Un(e,n,3),t(r,function(r,n,t){return!e(r,n,t)})}function tu(r,e,n){if(n?Jn(r,e,n):null==e){r=lt(r);var t=r.length;return t>0?r[Xe(0,t-1)]:_}var u=-1,i=Hu(r),t=i.length,a=t-1;for(e=xa(0>e?0:+e||0,t);++u<e;){var o=Xe(u,a),s=i[o];i[o]=i[u],i[u]=s}return i.length=e,i}function uu(r){return tu(r,_a)}function iu(r){var e=r?Ua(r):0;return nt(e)?e:Fo(r).length}function au(r,e,n){var t=Vo(r)?pe:We;return n&&Jn(r,e,n)&&(e=_),("function"!=typeof e||n!==_)&&(e=Un(e,n,3)),t(r,e)}function ou(r,e,n){if(null==r)return[];n&&Jn(r,e,n)&&(e=_);var t=-1;e=Un(e,n,3);var u=je(r,function(r,n,u){return{criteria:e(r,n,u),index:++t,value:r}});return Ke(u,p)}function su(r,e,n,t){return null==r?[]:(t&&Jn(e,n,t)&&(n=_),Vo(e)||(e=null==e?[]:[e]),Vo(n)||(n=null==n?[]:[n]),ze(r,e,n))}function fu(r,e){return zt(r,Pe(e))}function lu(r,e){if("function"!=typeof e){if("function"!=typeof r)throw new Wi(Y);var n=r;r=e,e=n}return r=ba(r=+r)?r:0,function(){return--r<1?e.apply(this,arguments):void 0}}function cu(r,e,n){return n&&Jn(r,e,n)&&(e=_),e=r&&null==e?r.length:Na(+e||0,0),kn(r,L,_,_,_,_,e)}function pu(r,e){var n;if("function"!=typeof e){if("function"!=typeof r)throw new Wi(Y);var t=r;r=e,e=t}return function(){return--r>0&&(n=e.apply(this,arguments)),1>=r&&(e=_),n}}function mu(r,e,n){function t(){m&&aa(m),f&&aa(f),g=0,f=m=h=_}function u(e,n){n&&aa(n),f=m=h=_,e&&(g=ho(),l=r.apply(p,s),m||f||(s=p=_))}function i(){var r=e-(ho()-c);0>=r||r>e?u(h,f):m=ca(i,r)}function a(){u(d,m)}function o(){if(s=arguments,c=ho(),p=this,h=d&&(m||!y),v===!1)var n=y&&!m;else{f||y||(g=c);var t=v-(c-g),u=0>=t||t>v;u?(f&&(f=aa(f)),g=c,l=r.apply(p,s)):f||(f=ca(a,t))}return u&&m?m=aa(m):m||e===v||(m=ca(i,e)),n&&(u=!0,l=r.apply(p,s)),!u||m||f||(s=p=_),l}var s,f,l,c,p,m,h,g=0,v=!1,d=!0;if("function"!=typeof r)throw new Wi(Y);if(e=0>e?0:+e||0,n===!0){var y=!0;d=!1}else Cu(n)&&(y=!!n.leading,v="maxWait"in n&&Na(+n.maxWait||0,e),d="trailing"in n?!!n.trailing:d);return o.cancel=t,o}function hu(r,e){if("function"!=typeof r||e&&"function"!=typeof e)throw new Wi(Y);var n=function(){var t=arguments,u=e?e.apply(this,t):t[0],i=n.cache;if(i.has(u))return i.get(u);var a=r.apply(this,t);return n.cache=i.set(u,a),a};return n.cache=new hu.Cache,n}function gu(r){if("function"!=typeof r)throw new Wi(Y);return function(){return!r.apply(this,arguments)}}function vu(r){return pu(2,r)}function du(r,e){if("function"!=typeof r)throw new Wi(Y);return e=Na(e===_?r.length-1:+e||0,0),function(){for(var n=arguments,t=-1,u=Na(n.length-e,0),i=Fi(u);++t<u;)i[t]=n[e+t];switch(e){case 0:return r.call(this,i);case 1:return r.call(this,n[0],i);case 2:return r.call(this,n[0],n[1],i)}var a=Fi(e+1);for(t=-1;++t<e;)a[t]=n[t];return a[e]=i,r.apply(this,a)}}function yu(r){if("function"!=typeof r)throw new Wi(Y);return function(e){return r.apply(this,e)}}function bu(r,e,n){var t=!0,u=!0;if("function"!=typeof r)throw new Wi(Y);return n===!1?t=!1:Cu(n)&&(t="leading"in n?!!n.leading:t,u="trailing"in n?!!n.trailing:u),mu(r,e,{leading:t,maxWait:+e,trailing:u})}function Eu(r,e){return e=null==e?_i:e,kn(e,C,_,[r],[])}function Nu(r,e,n,t){return e&&"boolean"!=typeof e&&Jn(r,e,n)?e=!1:"function"==typeof e&&(t=n,n=e,e=!1),"function"==typeof n?Ne(r,e,an(n,t,1)):Ne(r,e)}function xu(r,e,n){return"function"==typeof e?Ne(r,!0,an(e,n,1)):Ne(r,!0)}function Iu(r,e){return r>e}function Mu(r,e){return r>=e}function Au(r){return b(r)&&zn(r)&&ra.call(r,"callee")&&!fa.call(r,"callee")}function wu(r){return r===!0||r===!1||b(r)&&na.call(r)==W}function _u(r){return b(r)&&na.call(r)==K}function $u(r){return!!r&&1===r.nodeType&&b(r)&&!Fu(r)}function Vu(r){return null==r?!0:zn(r)&&(Vo(r)||qu(r)||Au(r)||b(r)&&Ou(r.splice))?!r.length:!Fo(r).length}function Su(r,e,n,t){n="function"==typeof n?an(n,t,3):_;var u=n?n(r,e):_;return u===_?De(r,e,n):!!u}function Tu(r){return b(r)&&"string"==typeof r.message&&na.call(r)==z;
}function Ru(r){return"number"==typeof r&&ba(r)}function Ou(r){return Cu(r)&&na.call(r)==Z}function Cu(r){var e=typeof r;return!!r&&("object"==e||"function"==e)}function Du(r,e,n,t){return n="function"==typeof n?an(n,t,3):_,ke(r,Gn(e),n)}function Lu(r){return Pu(r)&&r!=+r}function ku(r){return null==r?!1:Ou(r)?ua.test(Ji.call(r)):b(r)&&Lr.test(r)}function ju(r){return null===r}function Pu(r){return"number"==typeof r||b(r)&&na.call(r)==rr}function Fu(r){var e;if(!b(r)||na.call(r)!=er||Au(r)||!ra.call(r,"constructor")&&(e=r.constructor,"function"==typeof e&&!(e instanceof e)))return!1;var n;return Se(r,function(r,e){n=e}),n===_||ra.call(r,n)}function Uu(r){return Cu(r)&&na.call(r)==nr}function qu(r){return"string"==typeof r||b(r)&&na.call(r)==ur}function Bu(r){return b(r)&&nt(r.length)&&!!Gr[na.call(r)]}function Gu(r){return r===_}function Yu(r,e){return e>r}function Xu(r,e){return e>=r}function Hu(r){var e=r?Ua(r):0;return nt(e)?e?re(r):[]:ii(r)}function Qu(r){return be(r,ri(r))}function Wu(r,e,n){var t=Ca(r);return n&&Jn(r,e,n)&&(e=_),e?de(t,e):t}function Ku(r){return Oe(r,ri(r))}function zu(r,e,n){var t=null==r?_:Ce(r,pt(e),e+"");return t===_?n:t}function Zu(r,e){if(null==r)return!1;var n=ra.call(r,e);if(!n&&!rt(e)){if(e=pt(e),r=1==e.length?r:Ce(r,Qe(e,0,-1)),null==r)return!1;e=wt(e),n=ra.call(r,e)}return n||nt(r.length)&&Zn(e,r.length)&&(Vo(r)||Au(r))}function Ju(r,e,n){n&&Jn(r,e,n)&&(e=_);for(var t=-1,u=Fo(r),i=u.length,a={};++t<i;){var o=u[t],s=r[o];e?ra.call(a,s)?a[s].push(o):a[s]=[o]:a[s]=o}return a}function ri(r){if(null==r)return[];Cu(r)||(r=Xi(r));var e=r.length;e=e&&nt(e)&&(Vo(r)||Au(r))&&e||0;for(var n=r.constructor,t=-1,u="function"==typeof n&&n.prototype===r,i=Fi(e),a=e>0;++t<e;)i[t]=t+"";for(var o in r)a&&Zn(o,e)||"constructor"==o&&(u||!ra.call(r,o))||i.push(o);return i}function ei(r){r=ct(r);for(var e=-1,n=Fo(r),t=n.length,u=Fi(t);++e<t;){var i=n[e];u[e]=[i,r[i]]}return u}function ni(r,e,n){var t=null==r?_:r[e];return t===_&&(null==r||rt(e,r)||(e=pt(e),r=1==e.length?r:Ce(r,Qe(e,0,-1)),t=null==r?_:r[wt(e)]),t=t===_?n:t),Ou(t)?t.call(r):t}function ti(r,e,n){if(null==r)return r;var t=e+"";e=null!=r[t]||rt(e,r)?[t]:pt(e);for(var u=-1,i=e.length,a=i-1,o=r;null!=o&&++u<i;){var s=e[u];Cu(o)&&(u==a?o[s]=n:null==o[s]&&(o[s]=Zn(e[u+1])?[]:{})),o=o[s]}return r}function ui(r,e,n,t){var u=Vo(r)||Bu(r);if(e=Un(e,t,4),null==n)if(u||Cu(r)){var i=r.constructor;n=u?Vo(r)?new i:[]:Ca(Ou(i)?i.prototype:_)}else n={};return(u?ee:Te)(r,function(r,t,u){return e(n,r,t,u)}),n}function ii(r){return rn(r,Fo(r))}function ai(r){return rn(r,ri(r))}function oi(r,e,n){return e=+e||0,n===_?(n=e,e=0):n=+n||0,r>=xa(e,n)&&r<Na(e,n)}function si(r,e,n){n&&Jn(r,e,n)&&(e=n=_);var t=null==r,u=null==e;if(null==n&&(u&&"boolean"==typeof r?(n=r,r=1):"boolean"==typeof e&&(n=e,u=!0)),t&&u&&(e=1,u=!1),r=+r||0,u?(e=r,r=0):e=+e||0,n||r%1||e%1){var i=Aa();return xa(r+i*(e-r+oa("1e-"+((i+"").length-1))),e)}return Xe(r,e)}function fi(r){return r=f(r),r&&r.charAt(0).toUpperCase()+r.slice(1)}function li(r){return r=f(r),r&&r.replace(jr,h).replace(Tr,"")}function ci(r,e,n){r=f(r),e+="";var t=r.length;return n=n===_?t:xa(0>n?0:+n||0,t),n-=e.length,n>=0&&r.indexOf(e,n)==n}function pi(r){return r=f(r),r&&xr.test(r)?r.replace(Er,g):r}function mi(r){return r=f(r),r&&Sr.test(r)?r.replace(Vr,v):r||"(?:)"}function hi(r,e,n){r=f(r),e=+e;var t=r.length;if(t>=e||!ba(e))return r;var u=(e-t)/2,i=da(u),a=ga(u);return n=On("",a,n),n.slice(0,i)+r+n}function gi(r,e,n){return(n?Jn(r,e,n):null==e)?e=0:e&&(e=+e),r=bi(r),Ma(r,e||(Dr.test(r)?16:10))}function vi(r,e){var n="";if(r=f(r),e=+e,1>e||!r||!ba(e))return n;do e%2&&(n+=r),e=da(e/2),r+=r;while(e);return n}function di(r,e,n){return r=f(r),n=null==n?0:xa(0>n?0:+n||0,r.length),r.lastIndexOf(e,n)==n}function yi(r,n,t){var u=e.templateSettings;t&&Jn(r,n,t)&&(n=t=_),r=f(r),n=ve(de({},t||n),u,ge);var i,a,o=ve(de({},n.imports),u.imports,ge),s=Fo(o),l=rn(o,s),c=0,p=n.interpolate||Pr,m="__p += '",h=Hi((n.escape||Pr).source+"|"+p.source+"|"+(p===Ar?Or:Pr).source+"|"+(n.evaluate||Pr).source+"|$","g"),g="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++Br+"]")+"\n";r.replace(h,function(e,n,t,u,o,s){return t||(t=u),m+=r.slice(c,s).replace(Fr,d),n&&(i=!0,m+="' +\n__e("+n+") +\n'"),o&&(a=!0,m+="';\n"+o+";\n__p += '"),t&&(m+="' +\n((__t = ("+t+")) == null ? '' : __t) +\n'"),c=s+e.length,e}),m+="';\n";var v=n.variable;v||(m="with (obj) {\n"+m+"\n}\n"),m=(a?m.replace(vr,""):m).replace(dr,"$1").replace(yr,"$1;"),m="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var y=zo(function(){return Bi(s,g+"return "+m).apply(_,l)});if(y.source=m,Tu(y))throw y;return y}function bi(r,e,n){var t=r;return(r=f(r))?(n?Jn(t,e,n):null==e)?r.slice(I(r),M(r)+1):(e+="",r.slice(l(r,e),c(r,e)+1)):r}function Ei(r,e,n){var t=r;return r=f(r),r?(n?Jn(t,e,n):null==e)?r.slice(I(r)):r.slice(l(r,e+"")):r}function Ni(r,e,n){var t=r;return r=f(r),r?(n?Jn(t,e,n):null==e)?r.slice(0,M(r)+1):r.slice(0,c(r,e+"")+1):r}function xi(r,e,n){n&&Jn(r,e,n)&&(e=_);var t=j,u=P;if(null!=e)if(Cu(e)){var i="separator"in e?e.separator:i;t="length"in e?+e.length||0:t,u="omission"in e?f(e.omission):u}else t=+e||0;if(r=f(r),t>=r.length)return r;var a=t-u.length;if(1>a)return u;var o=r.slice(0,a);if(null==i)return o+u;if(Uu(i)){if(r.slice(a).search(i)){var s,l,c=r.slice(0,a);for(i.global||(i=Hi(i.source,(Cr.exec(i)||"")+"g")),i.lastIndex=0;s=i.exec(c);)l=s.index;o=o.slice(0,null==l?a:l)}}else if(r.indexOf(i,a)!=a){var p=o.lastIndexOf(i);p>-1&&(o=o.slice(0,p))}return o+u}function Ii(r){return r=f(r),r&&Nr.test(r)?r.replace(br,A):r}function Mi(r,e,n){return n&&Jn(r,e,n)&&(e=_),r=f(r),r.match(e||Ur)||[]}function Ai(r,e,n){return n&&Jn(r,e,n)&&(e=_),b(r)?$i(r):Ee(r,e)}function wi(r){return function(){return r}}function _i(r){return r}function $i(r){return Pe(Ne(r,!0))}function Vi(r,e){return Fe(r,Ne(e,!0))}function Si(r,e,n){if(null==n){var t=Cu(e),u=t?Fo(e):_,i=u&&u.length?Oe(e,u):_;(i?i.length:t)||(i=!1,n=e,e=r,r=this)}i||(i=Oe(e,Fo(e)));var a=!0,o=-1,s=Ou(r),f=i.length;n===!1?a=!1:Cu(n)&&"chain"in n&&(a=n.chain);for(;++o<f;){var l=i[o],c=e[l];r[l]=c,s&&(r.prototype[l]=function(e){return function(){var n=this.__chain__;if(a||n){var t=r(this.__wrapped__),u=t.__actions__=re(this.__actions__);return u.push({func:e,args:arguments,thisArg:r}),t.__chain__=n,t}return e.apply(r,fe([this.value()],arguments))}}(c))}return r}function Ti(){return te._=ta,this}function Ri(){}function Oi(r){return rt(r)?Be(r):Ge(r)}function Ci(r){return function(e){return Ce(r,pt(e),e+"")}}function Di(r,e,n){n&&Jn(r,e,n)&&(e=n=_),r=+r||0,n=null==n?1:+n||0,null==e?(e=r,r=0):e=+e||0;for(var t=-1,u=Na(ga((e-r)/(n||1)),0),i=Fi(u);++t<u;)i[t]=r,r+=n;return i}function Li(r,e,n){if(r=da(r),1>r||!ba(r))return[];var t=-1,u=Fi(xa(r,$a));for(e=an(e,n,1);++t<r;)$a>t?u[t]=e(t):e(t);return u}function ki(r){var e=++ea;return f(r)+e}function ji(r,e){return(+r||0)+(+e||0)}function Pi(r,e,n){return n&&Jn(r,e,n)&&(e=_),e=Un(e,n,3),1==e.length?me(Vo(r)?r:lt(r),e):Ze(r,e)}r=r?ue.defaults(te.Object(),r,ue.pick(te,qr)):te;var Fi=r.Array,Ui=r.Date,qi=r.Error,Bi=r.Function,Gi=r.Math,Yi=r.Number,Xi=r.Object,Hi=r.RegExp,Qi=r.String,Wi=r.TypeError,Ki=Fi.prototype,zi=Xi.prototype,Zi=Qi.prototype,Ji=Bi.prototype.toString,ra=zi.hasOwnProperty,ea=0,na=zi.toString,ta=te._,ua=Hi("^"+Ji.call(ra).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ia=r.ArrayBuffer,aa=r.clearTimeout,oa=r.parseFloat,sa=Gi.pow,fa=zi.propertyIsEnumerable,la=Yn(r,"Set"),ca=r.setTimeout,pa=Ki.splice,ma=r.Uint8Array,ha=Yn(r,"WeakMap"),ga=Gi.ceil,va=Yn(Xi,"create"),da=Gi.floor,ya=Yn(Fi,"isArray"),ba=r.isFinite,Ea=Yn(Xi,"keys"),Na=Gi.max,xa=Gi.min,Ia=Yn(Ui,"now"),Ma=r.parseInt,Aa=Gi.random,wa=Yi.NEGATIVE_INFINITY,_a=Yi.POSITIVE_INFINITY,$a=4294967295,Va=$a-1,Sa=$a>>>1,Ta=9007199254740991,Ra=ha&&new ha,Oa={};e.support={};e.templateSettings={escape:Ir,evaluate:Mr,interpolate:Ar,variable:"",imports:{_:e}};var Ca=function(){function r(){}return function(e){if(Cu(e)){r.prototype=e;var n=new r;r.prototype=_}return n||{}}}(),Da=pn(Te),La=pn(Re,!0),ka=mn(),ja=mn(!0),Pa=Ra?function(r,e){return Ra.set(r,e),r}:_i,Fa=Ra?function(r){return Ra.get(r)}:Ri,Ua=Be("length"),qa=function(){var r=0,e=0;return function(n,t){var u=ho(),i=U-(u-e);if(e=u,i>0){if(++r>=F)return n}else r=0;return Pa(n,t)}}(),Ba=du(function(r,e){return b(r)&&zn(r)?Ie(r,Ve(e,!1,!0)):[]}),Ga=xn(),Ya=xn(!0),Xa=du(function(r){for(var e=r.length,n=e,t=Fi(c),u=Bn(),i=u==o,a=[];n--;){var s=r[n]=zn(s=r[n])?s:[];t[n]=i&&s.length>=120?gn(n&&s):null}var f=r[0],l=-1,c=f?f.length:0,p=t[0];r:for(;++l<c;)if(s=f[l],(p?zr(p,s):u(a,s,0))<0){for(var n=e;--n;){var m=t[n];if((m?zr(m,s):u(r[n],s,0))<0)continue r}p&&p.push(s),a.push(s)}return a}),Ha=du(function(r,e){e=Ve(e);var n=ye(r,e);return Ye(r,e.sort(i)),n}),Qa=Ln(),Wa=Ln(!0),Ka=du(function(r){return Je(Ve(r,!1,!0))}),za=du(function(r,e){return zn(r)?Ie(r,e):[]}),Za=du(kt),Ja=du(function(r){var e=r.length,n=e>2?r[e-2]:_,t=e>1?r[e-1]:_;return e>2&&"function"==typeof n?e-=2:(n=e>1&&"function"==typeof t?(--e,t):_,t=_),r.length=e,jt(r,n,t)}),ro=du(function(r){return r=Ve(r),this.thru(function(e){return Jr(Vo(e)?e:[ct(e)],r)})}),eo=du(function(r,e){return ye(r,Ve(e))}),no=ln(function(r,e,n){ra.call(r,n)?++r[n]:r[n]=1}),to=Nn(Da),uo=Nn(La,!0),io=An(ee,Da),ao=An(ne,La),oo=ln(function(r,e,n){ra.call(r,n)?r[n].push(e):r[n]=[e]}),so=ln(function(r,e,n){r[n]=e}),fo=du(function(r,e,n){var t=-1,u="function"==typeof e,i=rt(e),a=zn(r)?Fi(r.length):[];return Da(r,function(r){var o=u?e:i&&null!=r?r[e]:_;a[++t]=o?o.apply(r,n):Kn(r,e,n)}),a}),lo=ln(function(r,e,n){r[n?0:1].push(e)},function(){return[[],[]]}),co=Tn(le,Da),po=Tn(ce,La),mo=du(function(r,e){if(null==r)return[];var n=e[2];return n&&Jn(e[0],e[1],n)&&(e.length=1),ze(r,Ve(e),[])}),ho=Ia||function(){return(new Ui).getTime()},go=du(function(r,e,n){var t=V;if(n.length){var u=N(n,go.placeholder);t|=C}return kn(r,t,e,n,u)}),vo=du(function(r,e){e=e.length?Ve(e):Ku(r);for(var n=-1,t=e.length;++n<t;){var u=e[n];r[u]=kn(r[u],V,r)}return r}),yo=du(function(r,e,n){var t=V|S;if(n.length){var u=N(n,yo.placeholder);t|=C}return kn(e,t,r,n,u)}),bo=yn(R),Eo=yn(O),No=du(function(r,e){return xe(r,1,e)}),xo=du(function(r,e,n){return xe(r,e,n)}),Io=Mn(),Mo=Mn(!0),Ao=du(function(r,e){if(e=Ve(e),"function"!=typeof r||!ie(e,s))throw new Wi(Y);var n=e.length;return du(function(t){for(var u=xa(t.length,n);u--;)t[u]=e[u](t[u]);return r.apply(this,t)})}),wo=Sn(C),_o=Sn(D),$o=du(function(r,e){return kn(r,k,_,_,_,Ve(e))}),Vo=ya||function(r){return b(r)&&nt(r.length)&&na.call(r)==Q},So=cn(Ue),To=cn(function(r,e,n){return n?ve(r,e,n):de(r,e)}),Ro=bn(To,he),Oo=bn(So,it),Co=In(Te),Do=In(Re),Lo=wn(ka),ko=wn(ja),jo=_n(Te),Po=_n(Re),Fo=Ea?function(r){var e=null==r?_:r.constructor;return"function"==typeof e&&e.prototype===r||"function"!=typeof r&&zn(r)?ft(r):Cu(r)?Ea(r):[]}:ft,Uo=$n(!0),qo=$n(),Bo=du(function(r,e){if(null==r)return{};if("function"!=typeof e[0]){var e=se(Ve(e),Qi);return at(r,Ie(ri(r),e))}var n=an(e[0],e[1],3);return ot(r,function(r,e,t){return!n(r,e,t)})}),Go=du(function(r,e){return null==r?{}:"function"==typeof e[0]?ot(r,an(e[0],e[1],3)):at(r,Ve(e))}),Yo=vn(function(r,e,n){return e=e.toLowerCase(),r+(n?e.charAt(0).toUpperCase()+e.slice(1):e)}),Xo=vn(function(r,e,n){return r+(n?"-":"")+e.toLowerCase()}),Ho=Vn(),Qo=Vn(!0),Wo=vn(function(r,e,n){return r+(n?"_":"")+e.toLowerCase()}),Ko=vn(function(r,e,n){return r+(n?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))}),zo=du(function(r,e){try{return r.apply(_,e)}catch(n){return Tu(n)?n:new qi(n)}}),Zo=du(function(r,e){return function(n){return Kn(n,r,e)}}),Jo=du(function(r,e){return function(n){return Kn(r,n,e)}}),rs=Dn("ceil"),es=Dn("floor"),ns=En(Iu,wa),ts=En(Yu,_a),us=Dn("round");return e.prototype=n.prototype,t.prototype=Ca(n.prototype),t.prototype.constructor=t,u.prototype=Ca(n.prototype),u.prototype.constructor=u,ir.prototype["delete"]=Xr,ir.prototype.get=Hr,ir.prototype.has=Qr,ir.prototype.set=Wr,Kr.prototype.push=Zr,hu.Cache=ir,e.after=lu,e.ary=cu,e.assign=To,e.at=eo,e.before=pu,e.bind=go,e.bindAll=vo,e.bindKey=yo,e.callback=Ai,e.chain=Ut,e.chunk=ht,e.compact=gt,e.constant=wi,e.countBy=no,e.create=Wu,e.curry=bo,e.curryRight=Eo,e.debounce=mu,e.defaults=Ro,e.defaultsDeep=Oo,e.defer=No,e.delay=xo,e.difference=Ba,e.drop=vt,e.dropRight=dt,e.dropRightWhile=yt,e.dropWhile=bt,e.fill=Et,e.filter=zt,e.flatten=xt,e.flattenDeep=It,e.flow=Io,e.flowRight=Mo,e.forEach=io,e.forEachRight=ao,e.forIn=Lo,e.forInRight=ko,e.forOwn=jo,e.forOwnRight=Po,e.functions=Ku,e.groupBy=oo,e.indexBy=so,e.initial=At,e.intersection=Xa,e.invert=Ju,e.invoke=fo,e.keys=Fo,e.keysIn=ri,e.map=ru,e.mapKeys=Uo,e.mapValues=qo,e.matches=$i,e.matchesProperty=Vi,e.memoize=hu,e.merge=So,e.method=Zo,e.methodOf=Jo,e.mixin=Si,e.modArgs=Ao,e.negate=gu,e.omit=Bo,e.once=vu,e.pairs=ei,e.partial=wo,e.partialRight=_o,e.partition=lo,e.pick=Go,e.pluck=eu,e.property=Oi,e.propertyOf=Ci,e.pull=$t,e.pullAt=Ha,e.range=Di,e.rearg=$o,e.reject=nu,e.remove=Vt,e.rest=St,e.restParam=du,e.set=ti,e.shuffle=uu,e.slice=Tt,e.sortBy=ou,e.sortByAll=mo,e.sortByOrder=su,e.spread=yu,e.take=Rt,e.takeRight=Ot,e.takeRightWhile=Ct,e.takeWhile=Dt,e.tap=qt,e.throttle=bu,e.thru=Bt,e.times=Li,e.toArray=Hu,e.toPlainObject=Qu,e.transform=ui,e.union=Ka,e.uniq=Lt,e.unzip=kt,e.unzipWith=jt,e.values=ii,e.valuesIn=ai,e.where=fu,e.without=za,e.wrap=Eu,e.xor=Pt,e.zip=Za,e.zipObject=Ft,e.zipWith=Ja,e.backflow=Mo,e.collect=ru,e.compose=Mo,e.each=io,e.eachRight=ao,e.extend=To,e.iteratee=Ai,e.methods=Ku,e.object=Ft,e.select=zt,e.tail=St,e.unique=Lt,Si(e,e),e.add=ji,e.attempt=zo,e.camelCase=Yo,e.capitalize=fi,e.ceil=rs,e.clone=Nu,e.cloneDeep=xu,e.deburr=li,e.endsWith=ci,e.escape=pi,e.escapeRegExp=mi,e.every=Kt,e.find=to,e.findIndex=Ga,e.findKey=Co,e.findLast=uo,e.findLastIndex=Ya,e.findLastKey=Do,e.findWhere=Zt,e.first=Nt,e.floor=es,e.get=zu,e.gt=Iu,e.gte=Mu,e.has=Zu,e.identity=_i,e.includes=Jt,e.indexOf=Mt,e.inRange=oi,e.isArguments=Au,e.isArray=Vo,e.isBoolean=wu,e.isDate=_u,e.isElement=$u,e.isEmpty=Vu,e.isEqual=Su,e.isError=Tu,e.isFinite=Ru,e.isFunction=Ou,e.isMatch=Du,e.isNaN=Lu,e.isNative=ku,e.isNull=ju,e.isNumber=Pu,e.isObject=Cu,e.isPlainObject=Fu,e.isRegExp=Uu,e.isString=qu,e.isTypedArray=Bu,e.isUndefined=Gu,e.kebabCase=Xo,e.last=wt,e.lastIndexOf=_t,e.lt=Yu,e.lte=Xu,e.max=ns,e.min=ts,e.noConflict=Ti,e.noop=Ri,e.now=ho,e.pad=hi,e.padLeft=Ho,e.padRight=Qo,e.parseInt=gi,e.random=si,e.reduce=co,e.reduceRight=po,e.repeat=vi,e.result=ni,e.round=us,e.runInContext=w,e.size=iu,e.snakeCase=Wo,e.some=au,e.sortedIndex=Qa,e.sortedLastIndex=Wa,e.startCase=Ko,e.startsWith=di,e.sum=Pi,e.template=yi,e.trim=bi,e.trimLeft=Ei,e.trimRight=Ni,e.trunc=xi,e.unescape=Ii,e.uniqueId=ki,e.words=Mi,e.all=Kt,e.any=au,e.contains=Jt,e.eq=Su,e.detect=to,e.foldl=co,e.foldr=po,e.head=Nt,e.include=Jt,e.inject=co,Si(e,function(){var r={};return Te(e,function(n,t){e.prototype[t]||(r[t]=n)}),r}(),!1),e.sample=tu,e.prototype.sample=function(r){return this.__chain__||null!=r?this.thru(function(e){return tu(e,r)}):tu(this.value())},e.VERSION=$,ee(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){e[r].placeholder=e}),ee(["drop","take"],function(r,e){u.prototype[r]=function(n){var t=this.__filtered__;if(t&&!e)return new u(this);n=null==n?1:Na(da(n)||0,0);var i=this.clone();return t?i.__takeCount__=xa(i.__takeCount__,n):i.__views__.push({size:n,type:r+(i.__dir__<0?"Right":"")}),i},u.prototype[r+"Right"]=function(e){return this.reverse()[r](e).reverse()}}),ee(["filter","map","takeWhile"],function(r,e){var n=e+1,t=n!=G;u.prototype[r]=function(r,e){var u=this.clone();return u.__iteratees__.push({iteratee:Un(r,e,1),type:n}),u.__filtered__=u.__filtered__||t,u}}),ee(["first","last"],function(r,e){var n="take"+(e?"Right":"");u.prototype[r]=function(){return this[n](1).value()[0]}}),ee(["initial","rest"],function(r,e){var n="drop"+(e?"":"Right");u.prototype[r]=function(){return this.__filtered__?new u(this):this[n](1)}}),ee(["pluck","where"],function(r,e){var n=e?"filter":"map",t=e?Pe:Oi;u.prototype[r]=function(r){return this[n](t(r))}}),u.prototype.compact=function(){return this.filter(_i)},u.prototype.reject=function(r,e){return r=Un(r,e,1),this.filter(function(e){return!r(e)})},u.prototype.slice=function(r,e){r=null==r?0:+r||0;var n=this;return n.__filtered__&&(r>0||0>e)?new u(n):(0>r?n=n.takeRight(-r):r&&(n=n.drop(r)),e!==_&&(e=+e||0,n=0>e?n.dropRight(-e):n.take(e-r)),n)},u.prototype.takeRightWhile=function(r,e){return this.reverse().takeWhile(r,e).reverse()},u.prototype.toArray=function(){return this.take(_a)},Te(u.prototype,function(r,n){var i=/^(?:filter|map|reject)|While$/.test(n),a=/^(?:first|last)$/.test(n),o=e[a?"take"+("last"==n?"Right":""):n];o&&(e.prototype[n]=function(){var e=a?[1]:arguments,n=this.__chain__,s=this.__wrapped__,f=!!this.__actions__.length,l=s instanceof u,c=e[0],p=l||Vo(s);p&&i&&"function"==typeof c&&1!=c.length&&(l=p=!1);var m=function(r){return a&&n?o(r,1)[0]:o.apply(_,fe([r],e))},h={func:Bt,args:[m],thisArg:_},g=l&&!f;if(a&&!n)return g?(s=s.clone(),s.__actions__.push(h),r.call(s)):o.call(_,this.value())[0];if(!a&&p){s=g?s:new u(this);var v=r.apply(s,e);return v.__actions__.push(h),new t(v,n)}return this.thru(m)})}),ee(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(r){var n=(/^(?:replace|split)$/.test(r)?Zi:Ki)[r],t=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",u=/^(?:join|pop|replace|shift)$/.test(r);e.prototype[r]=function(){var r=arguments;return u&&!this.__chain__?n.apply(this.value(),r):this[t](function(e){return n.apply(e,r)})}}),Te(u.prototype,function(r,n){var t=e[n];if(t){var u=t.name,i=Oa[u]||(Oa[u]=[]);i.push({name:n,func:t})}}),Oa[Rn(_,S).name]=[{name:"wrapper",func:_}],u.prototype.clone=E,u.prototype.reverse=J,u.prototype.value=tr,e.prototype.chain=Gt,e.prototype.commit=Yt,e.prototype.concat=ro,e.prototype.plant=Xt,e.prototype.reverse=Ht,e.prototype.toString=Qt,e.prototype.run=e.prototype.toJSON=e.prototype.valueOf=e.prototype.value=Wt,e.prototype.collect=e.prototype.map,e.prototype.head=e.prototype.first,e.prototype.select=e.prototype.filter,e.prototype.tail=e.prototype.rest,e}var _,$="3.10.1",V=1,S=2,T=4,R=8,O=16,C=32,D=64,L=128,k=256,j=30,P="...",F=150,U=16,q=200,B=1,G=2,Y="Expected a function",X="__lodash_placeholder__",H="[object Arguments]",Q="[object Array]",W="[object Boolean]",K="[object Date]",z="[object Error]",Z="[object Function]",J="[object Map]",rr="[object Number]",er="[object Object]",nr="[object RegExp]",tr="[object Set]",ur="[object String]",ir="[object WeakMap]",ar="[object ArrayBuffer]",or="[object Float32Array]",sr="[object Float64Array]",fr="[object Int8Array]",lr="[object Int16Array]",cr="[object Int32Array]",pr="[object Uint8Array]",mr="[object Uint8ClampedArray]",hr="[object Uint16Array]",gr="[object Uint32Array]",vr=/\b__p \+= '';/g,dr=/\b(__p \+=) '' \+/g,yr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,br=/&(?:amp|lt|gt|quot|#39|#96);/g,Er=/[&<>"'`]/g,Nr=RegExp(br.source),xr=RegExp(Er.source),Ir=/<%-([\s\S]+?)%>/g,Mr=/<%([\s\S]+?)%>/g,Ar=/<%=([\s\S]+?)%>/g,wr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,_r=/^\w*$/,$r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,Vr=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,Sr=RegExp(Vr.source),Tr=/[\u0300-\u036f\ufe20-\ufe23]/g,Rr=/\\(\\)?/g,Or=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Cr=/\w*$/,Dr=/^0[xX]/,Lr=/^\[object .+?Constructor\]$/,kr=/^\d+$/,jr=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Pr=/($^)/,Fr=/['\n\r\u2028\u2029\\]/g,Ur=function(){var r="[A-Z\\xc0-\\xd6\\xd8-\\xde]",e="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(r+"+(?="+r+e+")|"+r+"?"+e+"|"+r+"+|[0-9]+","g")}(),qr=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],Br=-1,Gr={};Gr[or]=Gr[sr]=Gr[fr]=Gr[lr]=Gr[cr]=Gr[pr]=Gr[mr]=Gr[hr]=Gr[gr]=!0,Gr[H]=Gr[Q]=Gr[ar]=Gr[W]=Gr[K]=Gr[z]=Gr[Z]=Gr[J]=Gr[rr]=Gr[er]=Gr[nr]=Gr[tr]=Gr[ur]=Gr[ir]=!1;var Yr={};Yr[H]=Yr[Q]=Yr[ar]=Yr[W]=Yr[K]=Yr[or]=Yr[sr]=Yr[fr]=Yr[lr]=Yr[cr]=Yr[rr]=Yr[er]=Yr[nr]=Yr[ur]=Yr[pr]=Yr[mr]=Yr[hr]=Yr[gr]=!0,Yr[z]=Yr[Z]=Yr[J]=Yr[tr]=Yr[ir]=!1;var Xr={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},Hr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Qr={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Wr={"function":!0,object:!0},Kr={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},zr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Zr=Wr[typeof e]&&e&&!e.nodeType&&e,Jr=Wr[typeof r]&&r&&!r.nodeType&&r,re=Zr&&Jr&&"object"==typeof u&&u&&u.Object&&u,ee=Wr[typeof self]&&self&&self.Object&&self,ne=Wr[typeof window]&&window&&window.Object&&window,te=(Jr&&Jr.exports===Zr&&Zr,re||ne!==(this&&this.window)&&ne||ee||this),ue=w();te._=ue,t=function(){return ue}.call(e,n,e,r),!(t!==_&&(r.exports=t))}).call(this)}).call(e,n(3)(r),function(){return this}())},function(r,e){r.exports=function(r){return r.webpackPolyfill||(r.deprecate=function(){},r.paths=[],r.children=[],r.webpackPolyfill=1),r}},function(r,e){var n={isArray:function(r){return window.marker&&console.error("isArray",arguments),"[object Array]"===Object.prototype.toString.call(r)},isNumber:function(r){return window.marker&&console.error("isNumber",arguments),"[object Number]"===Object.prototype.toString.call(r)},isString:function(r){return window.marker&&console.error("isString",arguments),"[object String]"===Object.prototype.toString.call(r)},isFunction:function(r){return window.marker&&console.error("isFunction",arguments),"[object Function]"===Object.prototype.toString.call(r)},isUndefined:function(r){return window.marker&&console.error("isUndefined",arguments),"[object Undefined]"===Object.prototype.toString.call(r)},isNull:function(r){return window.marker&&console.error("isNull",arguments),"[object Null]"===Object.prototype.toString.call(r)},isSet:function(r){return window.marker&&console.error("isSet",arguments),!n.isUndefined(r)&&!n.isNull(r)},isCell:function(r){return window.marker&&console.error("isCell",arguments),r.match(/^[A-Za-z]+[0-9]+/)?!0:!1},isFormula:function(r){return window.marker&&console.error("isFormula",arguments),n.isString(r)&&r.length>1&&"="===r.substr(0,1)},getCellAlphaNum:function(r){window.marker&&console.error("getCellAlphaNum",arguments);var e=r.match(/\d+$/),n=r.replace(e,"");return{alpha:n,num:parseInt(e[0],10)}},changeRowIndex:function(r,e){window.marker&&console.error("changeRowIndex",arguments);var t=n.getCellAlphaNum(r),u=t.alpha,i=u,a=parseInt(t.num+e,10);return 1>a&&(a=1),i+""+a},changeColIndex:function(r,e){window.marker&&console.error("changeColIndex",arguments);var t=n.getCellAlphaNum(r),u=t.alpha,i=n.toChar(parseInt(n.toNum(u)+e,10)),a=t.num;i&&0!==i.length||(i="A");var o="$"===u[0]||!1,s="$"===u[u.length-1]||!1;return i=(o?"$":"")+i,a=(s?"$":"")+a,i+""+a},changeFormula:function(r,e,t){return window.marker&&console.error("changeFormula",arguments),e||(e=1),r.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(r){var u=n.getCellAlphaNum(r),i=u.alpha,a=u.num;return n.isNumber(t.col)&&(a=n.toNum(i),t.col<=a)?n.changeColIndex(r,e):n.isNumber(t.row)&&t.row<a?n.changeRowIndex(r,e):r})},updateFormula:function(r,e,t){window.marker&&console.error("updateFormula",arguments);var u,i;return-1!==["left","right"].indexOf(e)?u="col":-1!==["up","down"].indexOf(e)&&(u="row"),-1!==["down","right"].indexOf(e)?i=1*t:-1!==["up","left"].indexOf(e)&&(i=-1*t),u&&i?r.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(r){var e=n.getCellAlphaNum(r).alpha,t="$"===e[0]||!1,a="$"===e[e.length-1]||!1;return"row"===u&&a?r:"col"===u&&t?r:"row"===u?n.changeRowIndex(r,i):n.changeColIndex(r,i)}):r},toNum:function(r){window.marker&&console.error("toNum",arguments),r=n.clearFormula(r);var e,t,u="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=0;for(e=0,t=r.length-1;e<r.length;e+=1,t-=1)i+=Math.pow(u.length,t)*(u.indexOf(r[e])+1);return i&&--i,i},toChar:function(r){window.marker&&console.error("toChar",arguments);for(var e="";r>=0;)e=String.fromCharCode(r%26+97)+e,r=Math.floor(r/26)-1;return e.toUpperCase()},cellCoords:function(r){window.marker&&console.error("cellCoords",arguments);var e=r.match(/\d+$/),t=r.replace(e,"");return{row:parseInt(e[0],10)-1,col:n.toNum(t)}},clearFormula:function(r){return window.marker&&console.error("clearFormula",arguments),r.replace(/\$/g,"")},translateCellCoords:function(r){return window.marker&&console.error("translateCellCoords",arguments),n.toChar(r.col)+""+parseInt(r.row+1,10)},sort:function(r){return window.marker&&console.error("sort",arguments),function(e,n){return(n>e?-1:e>n?1:0)*(r?-1:1)}}};r.exports=n},function(r,e,n){var t=[n(6),n(20),n(17),n(21),n(7),n(12),n(19),n(22),n(16),n(23),n(11),n(15)];for(var u in t){var i=t[u];for(var a in i)e[a]=e[a]||i[a]}},function(r,e,n){function t(r,e){if(e)for(var n in e)r[n]=e[n];return r}var u=n(7),i=n(11),a=n(17),o=n(19);e.BETADIST=i.BETA.DIST,e.BETAINV=i.BETA.INV,e.BINOMDIST=i.BINOM.DIST,e.CEILING=e.ISOCEILING=t(u.CEILING.MATH,u.CEILING),e.CEILINGMATH=u.CEILING.MATH,e.CEILINGPRECISE=u.CEILING.PRECISE,e.CHIDIST=i.CHISQ.DIST,e.CHIDISTRT=i.CHISQ.DIST.RT,e.CHIINV=i.CHISQ.INV,e.CHIINVRT=i.CHISQ.INV.RT,e.CHITEST=i.CHISQ.TEST,e.CONFIDENCE=t(i.CONFIDENCE.NORM,i.CONFIDENCE),e.COVAR=i.COVARIANCE.P,e.COVARIANCEP=i.COVARIANCE.P,e.COVARIANCES=i.COVARIANCE.S,e.CRITBINOM=i.BINOM.INV,e.EXPONDIST=i.EXPON.DIST,e.ERFCPRECISE=a.ERFC.PRECISE,e.ERFPRECISE=a.ERF.PRECISE,e.FDIST=i.F.DIST,e.FDISTRT=i.F.DIST.RT,e.FINVRT=i.F.INV.RT,e.FINV=i.F.INV,e.FLOOR=t(u.FLOOR.MATH,u.FLOOR),e.FLOORMATH=u.FLOOR.MATH,e.FLOORPRECISE=u.FLOOR.PRECISE,e.FTEST=i.F.TEST,e.GAMMADIST=i.GAMMA.DIST,e.GAMMAINV=i.GAMMA.INV,e.GAMMALNPRECISE=i.GAMMALN.PRECISE,e.HYPGEOMDIST=i.HYPGEOM.DIST,e.LOGINV=i.LOGNORM.INV,e.LOGNORMINV=i.LOGNORM.INV,e.LOGNORMDIST=i.LOGNORM.DIST,e.MODE=t(i.MODE.SNGL,i.MODE),e.MODEMULT=i.MODE.MULT,e.MODESNGL=i.MODE.SNGL,e.NEGBINOMDIST=i.NEGBINOM.DIST,e.NETWORKDAYSINTL=o.NETWORKDAYS.INTL,e.NORMDIST=i.NORM.DIST,e.NORMINV=i.NORM.INV,e.NORMSDIST=i.NORM.S.DIST,e.NORMSINV=i.NORM.S.INV,e.PERCENTILE=t(i.PERCENTILE.EXC,i.PERCENTILE),e.PERCENTILEEXC=i.PERCENTILE.EXC,e.PERCENTILEINC=i.PERCENTILE.INC,e.PERCENTRANK=t(i.PERCENTRANK.INC,i.PERCENTRANK),e.PERCENTRANKEXC=i.PERCENTRANK.EXC,e.PERCENTRANKINC=i.PERCENTRANK.INC,e.POISSON=t(i.POISSON.DIST,i.POISSON),e.POISSONDIST=i.POISSON.DIST,e.QUARTILE=t(i.QUARTILE.INC,i.QUARTILE),e.QUARTILEEXC=i.QUARTILE.EXC,e.QUARTILEINC=i.QUARTILE.INC,e.RANK=t(i.RANK.EQ,i.RANK),e.RANKAVG=i.RANK.AVG,e.RANKEQ=i.RANK.EQ,e.SKEWP=i.SKEW.P,e.STDEV=t(i.STDEV.S,i.STDEV),e.STDEVP=i.STDEV.P,e.STDEVS=i.STDEV.S,e.TDIST=i.T.DIST,e.TDISTRT=i.T.DIST.RT,e.TINV=i.T.INV,e.TTEST=i.T.TEST,e.VAR=t(i.VAR.S,i.VAR),e.VARP=i.VAR.P,e.VARS=i.VAR.S,e.WEIBULL=t(i.WEIBULL.DIST,i.WEIBULL),e.WEIBULLDIST=i.WEIBULL.DIST,e.WORKDAYINTL=o.WORKDAY.INTL,e.ZTEST=i.Z.TEST},function(module,exports,__webpack_require__){var numeric=__webpack_require__(8),utils=__webpack_require__(9),error=__webpack_require__(10),statistical=__webpack_require__(11),information=__webpack_require__(16);exports.ABS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.abs(utils.parseNumber(r))},exports.ACOS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.acos(r)},exports.ACOSH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log(r+Math.sqrt(r*r-1))},exports.ACOT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.atan(1/r)},exports.ACOTH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:.5*Math.log((r+1)/(r-1))},exports.AGGREGATE=function(r,e,n,t){if(r=utils.parseNumber(r),e=utils.parseNumber(r),utils.anyIsError(r,e))return error.value;switch(r){case 1:return statistical.AVERAGE(n);case 2:return statistical.COUNT(n);case 3:return statistical.COUNTA(n);case 4:return statistical.MAX(n);case 5:return statistical.MIN(n);case 6:return exports.PRODUCT(n);case 7:return statistical.STDEV.S(n);case 8:return statistical.STDEV.P(n);case 9:return exports.SUM(n);case 10:return statistical.VAR.S(n);case 11:return statistical.VAR.P(n);case 12:return statistical.MEDIAN(n);case 13:return statistical.MODE.SNGL(n);case 14:return statistical.LARGE(n,t);case 15:return statistical.SMALL(n,t);case 16:return statistical.PERCENTILE.INC(n,t);case 17:return statistical.QUARTILE.INC(n,t);case 18:return statistical.PERCENTILE.EXC(n,t);case 19:return statistical.QUARTILE.EXC(n,t)}},exports.ARABIC=function(r){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))return error.value;var e=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(r){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),e},exports.ASIN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.asin(r)},exports.ASINH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log(r+Math.sqrt(r*r+1))},exports.ATAN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.atan(r)},exports.ATAN2=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:Math.atan2(r,e)},exports.ATANH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log((1+r)/(1-r))/2},exports.BASE=function(r,e,n){if(n=n||0,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;n=void 0===n?0:n;var t=r.toString(e);return new Array(Math.max(n+1-t.length,0)).join("0")+t},exports.CEILING=function(r,e,n){if(e=void 0===e?1:Math.abs(e),n=n||0,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;if(0===e)return 0;var t=-Math.floor(Math.log(e)/Math.log(10));return r>=0?exports.ROUND(Math.ceil(r/e)*e,t):0===n?-exports.ROUND(Math.floor(Math.abs(r)/e)*e,t):-exports.ROUND(Math.ceil(Math.abs(r)/e)*e,t)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:exports.FACT(r)/(exports.FACT(e)*exports.FACT(r-e))},exports.COMBINA=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:0===r&&0===e?1:exports.COMBIN(r+e-1,r-1)},exports.COS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.cos(r)},exports.COSH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:(Math.exp(r)+Math.exp(-r))/2},exports.COT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:1/Math.tan(r)},exports.COTH=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.exp(2*r);return(e+1)/(e-1)},exports.CSC=function(r){return r=utils.parseNumber(r),r instanceof Error?r:1/Math.sin(r)},exports.CSCH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:2/(Math.exp(r)-Math.exp(-r))},exports.DECIMAL=function(r,e){return arguments.length<1?error.value:parseInt(r,e)},exports.DEGREES=function(r){return r=utils.parseNumber(r),r instanceof Error?r:180*r/Math.PI},exports.EVEN=function(r){
return r=utils.parseNumber(r),r instanceof Error?r:exports.CEILING(r,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.floor(r);return 0===e||1===e?1:MEMOIZED_FACT[e]>0?MEMOIZED_FACT[e]:(MEMOIZED_FACT[e]=exports.FACT(e-1)*e,MEMOIZED_FACT[e])},exports.FACTDOUBLE=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.floor(r);return 0>=e?1:e*exports.FACTDOUBLE(e-2)},exports.FLOOR=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;if(0===e)return 0;if(!(r>0&&e>0||0>r&&0>e))return error.num;e=Math.abs(e);var n=-Math.floor(Math.log(e)/Math.log(10));return r>=0?exports.ROUND(Math.floor(r/e)*e,n):-exports.ROUND(Math.ceil(Math.abs(r)/e),n)},exports.FLOOR.MATH=function(r,e,n){if(e=void 0===e?1:e,n=void 0===n?0:n,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;if(0===e)return 0;e=e?Math.abs(e):1;var t=-Math.floor(Math.log(e)/Math.log(10));return r>=0?exports.ROUND(Math.floor(r/e)*e,t):0===n||void 0===n?-exports.ROUND(Math.ceil(Math.abs(r)/e)*e,t):-exports.ROUND(Math.floor(Math.abs(r)/e)*e,t)},exports.FLOOR.PRECISE=exports.FLOOR.MATH,exports.GCD=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=r.length,n=r[0],t=0>n?-n:n,u=1;e>u;u++){for(var i=r[u],a=0>i?-i:i;t&&a;)t>a?t%=a:a%=t;t+=a}return t},exports.INT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.floor(r)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e,n,t,u,i=1;void 0!==(t=r.pop());)for(;t>1;){if(t%2){for(e=3,n=Math.floor(Math.sqrt(t));n>=e&&t%e;e+=2);u=n>=e?e:t}else u=2;for(t/=u,i*=u,e=r.length;e;r[--e]%u===0&&1===(r[e]/=u)&&r.splice(e,1));}return i},exports.LN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log(r)},exports.LOG=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:(e=void 0===e?10:e,Math.log(r)/Math.log(e))},exports.LOG10=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log(r)/Math.log(10)},exports.MDETERM=function(r){return r=utils.parseMatrix(r),r instanceof Error?r:numeric.det(r)},exports.MINVERSE=function(r){return r=utils.parseMatrix(r),r instanceof Error?r:numeric.inv(r)},exports.MMULT=function(r,e){return r=utils.parseMatrix(r),e=utils.parseMatrix(e),utils.anyIsError(r,e)?error.value:numeric.dot(r,e)},exports.MOD=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;if(0===e)return error.div0;var n=Math.abs(r%e);return e>0?n:-n},exports.MROUND=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:0>r*e?error.num:Math.round(r/e)*e},exports.MULTINOMIAL=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=0,n=1,t=0;t<r.length;t++)e+=r[t],n*=exports.FACT(r[t]);return exports.FACT(e)/n},exports.MUNIT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:numeric.identity(r)},exports.ODD=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.ceil(Math.abs(r));return e=1&e?e:e+1,r>0?e:-e},exports.PI=function(){return Math.PI},exports.POWER=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=Math.pow(r,e);return isNaN(n)?error.num:n},exports.PRODUCT=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=1,n=0;n<r.length;n++)e*=r[n];return e},exports.QUOTIENT=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:parseInt(r/e,10)},exports.RADIANS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:r*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:r+Math.ceil((e-r+1)*Math.random())-1},exports.ROMAN=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;for(var e=String(r).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],t="",u=3;u--;)t=(n[+e.pop()+10*u]||"")+t;return new Array(+e.join("")+1).join("M")+t},exports.ROUND=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:Math.round(r*Math.pow(10,e))/Math.pow(10,e)},exports.ROUNDDOWN=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=r>0?1:-1;return n*Math.floor(Math.abs(r)*Math.pow(10,e))/Math.pow(10,e)},exports.ROUNDUP=function(r,e){if(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=r>0?1:-1;return n*Math.ceil(Math.abs(r)*Math.pow(10,e))/Math.pow(10,e)},exports.SEC=function(r){return r=utils.parseNumber(r),r instanceof Error?r:1/Math.cos(r)},exports.SECH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:2/(Math.exp(r)+Math.exp(-r))},exports.SERIESSUM=function(r,e,n,t){if(r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),t=utils.parseNumberArray(t),utils.anyIsError(r,e,n,t))return error.value;for(var u=t[0]*Math.pow(r,e),i=1;i<t.length;i++)u+=t[i]*Math.pow(r,e+i*n);return u},exports.SIGN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:0>r?-1:0===r?0:1},exports.SIN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.sin(r)},exports.SINH=function(r){return r=utils.parseNumber(r),r instanceof Error?r:(Math.exp(r)-Math.exp(-r))/2},exports.SQRT=function(r){return r=utils.parseNumber(r),r instanceof Error?r:0>r?error.num:Math.sqrt(r)},exports.SQRTPI=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.sqrt(r*Math.PI)},exports.SUBTOTAL=function(r,e){if(r=utils.parseNumber(r),r instanceof Error)return r;switch(r){case 1:return statistical.AVERAGE(e);case 2:return statistical.COUNT(e);case 3:return statistical.COUNTA(e);case 4:return statistical.MAX(e);case 5:return statistical.MIN(e);case 6:return exports.PRODUCT(e);case 7:return statistical.STDEV.S(e);case 8:return statistical.STDEV.P(e);case 9:return exports.SUM(e);case 10:return statistical.VAR.S(e);case 11:return statistical.VAR.P(e);case 101:return statistical.AVERAGE(e);case 102:return statistical.COUNT(e);case 103:return statistical.COUNTA(e);case 104:return statistical.MAX(e);case 105:return statistical.MIN(e);case 106:return exports.PRODUCT(e);case 107:return statistical.STDEV.S(e);case 108:return statistical.STDEV.P(e);case 109:return exports.SUM(e);case 110:return statistical.VAR.S(e);case 111:return statistical.VAR.P(e)}},exports.ADD=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:r+e)},exports.MINUS=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:r-e)},exports.DIVIDE=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:0===e?error.div0:r/e)},exports.MULTIPLY=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:r*e)},exports.GTE=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.error:r>=e)},exports.LT=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.error:e>r)},exports.LTE=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.error:e>=r)},exports.EQ=function(r,e){return 2!==arguments.length?error.na:r===e},exports.NE=function(r,e){return 2!==arguments.length?error.na:r!==e},exports.POW=function(r,e){return 2!==arguments.length?error.na:(r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.error:exports.POWER(r,e))},exports.SUM=function(){for(var r=0,e=Object.keys(arguments),n=0;n<e.length;++n){var t=arguments[e[n]];if("number"==typeof t)r+=t;else if("string"==typeof t){var u=parseFloat(t);!isNaN(u)&&(r+=u)}else Array.isArray(t)&&(r+=exports.SUM.apply(null,t))}return r},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;n_range_elements>i;i++){for(var el=range[i],condition="",c=0;n_criterias>c;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var r,e,n,t,u=arguments.length+1,i=0,a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(var o=0;o<arguments[0][a].length;o++){for(r=1,e=1;u>e;e++){if(t=utils.parseNumber(arguments[e-1][a][o]),t instanceof Error)return t;r*=t}i+=r}else{for(r=1,e=1;u>e;e++){if(n=utils.parseNumber(arguments[e-1][a]),n instanceof Error)return n;r*=n}i+=r}return i},exports.SUMSQ=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=0,n=r.length,t=0;n>t;t++)e+=information.ISNUMBER(r[t])?r[t]*r[t]:0;return e},exports.SUMX2MY2=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=0,t=0;t<r.length;t++)n+=r[t]*r[t]-e[t]*e[t];return n},exports.SUMX2PY2=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;var n=0;r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e));for(var t=0;t<r.length;t++)n+=r[t]*r[t]+e[t]*e[t];return n},exports.SUMXMY2=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;var n=0;r=utils.flatten(r),e=utils.flatten(e);for(var t=0;t<r.length;t++)n+=Math.pow(r[t]-e[t],2);return n},exports.TAN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.tan(r)},exports.TANH=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.exp(2*r);return(e-1)/(e+1)},exports.TRUNC=function(r,e){if(e=void 0===e?0:e,r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=r>0?1:-1;return n*Math.floor(Math.abs(r)*Math.pow(10,e))/Math.pow(10,e)}},function(module,exports,__webpack_require__){(function(global){"use strict";var numeric=exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,e){var n,t,u,i;for("undefined"==typeof e&&(e=15),u=.5,n=new Date;;){for(u*=2,i=u;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(t=new Date,t-n>e)break}for(i=u;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return t=new Date,1e3*(3*u-1)/(t-n)},numeric._myIndexOf=function(r){var e,n=this.length;for(e=0;n>e;++e)if(this[e]===r)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function e(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(0>r)return"-"+e(-r);if(isFinite(r)){var n=Math.floor(Math.log(r)/Math.log(10)),t=r/Math.pow(10,n),u=t.toPrecision(numeric.precision);return 10===parseFloat(u)&&(n++,t=1,u=t.toPrecision(numeric.precision)),parseFloat(u).toString()+"e"+n.toString()}return"Infinity"}function n(r){var u;if("undefined"==typeof r)return t.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return t.push('"'+r+'"'),!1;if("boolean"==typeof r)return t.push(r.toString()),!1;if("number"==typeof r){var i=e(r),a=r.toPrecision(numeric.precision),o=parseFloat(r.toString()).toString(),s=[i,a,o,parseFloat(a).toString(),parseFloat(o).toString()];for(u=1;u<s.length;u++)s[u].length<i.length&&(i=s[u]);return t.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===r)return t.push("null"),!1;if("function"==typeof r){t.push(r.toString());var f=!1;for(u in r)r.hasOwnProperty(u)&&(f?t.push(",\n"):t.push("\n{"),f=!0,t.push(u),t.push(": \n"),n(r[u]));return f&&t.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return t.push("...Large Array..."),!0;var f=!1;for(t.push("["),u=0;u<r.length;u++)u>0&&(t.push(","),f&&t.push("\n ")),f=n(r[u]);return t.push("]"),!0}t.push("{");var f=!1;for(u in r)r.hasOwnProperty(u)&&(f&&t.push(",\n"),f=!0,t.push(u),t.push(": \n"),n(r[u]));return t.push("}"),!0}var t=[];return n(r),t.join("")},numeric.parseDate=function(r){function e(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,t=[];for(n=0;n<r.length;n++)t[n]=e(r[n]);return t}return e(r)},numeric.parseFloat=function(r){function e(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,t=[];for(n=0;n<r.length;n++)t[n]=e(r[n]);return t}return e(r)},numeric.parseCSV=function(r){var e,n,t=r.split("\n"),u=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,a=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,o=function(r){return r.substr(0,r.length-1)},s=0;for(n=0;n<t.length;n++){var f,l=(t[n]+",").match(i);if(l.length>0){for(u[s]=[],e=0;e<l.length;e++)f=o(l[e]),a.test(f)?u[s][e]=parseFloat(f):u[s][e]=f;s++}}return u},numeric.toCSV=function(r){var e,n,t,u,i,a,o=numeric.dim(r);for(t=o[0],u=o[1],a=[],e=0;t>e;e++){for(i=[],n=0;t>n;n++)i[n]=r[e][n].toString();a[e]=i.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(r){var e=new XMLHttpRequest;return e.open("GET",r,!1),e.send(),e},numeric.imageURL=function(r){function e(r){var e,n,t,u,i,a,o,s,f=r.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(e=0;f>e;e+=3)n=r[e],t=r[e+1],u=r[e+2],i=n>>2,a=((3&n)<<4)+(t>>4),o=((15&t)<<2)+(u>>6),s=63&u,e+1>=f?o=s=64:e+2>=f&&(s=64),c+=l.charAt(i)+l.charAt(a)+l.charAt(o)+l.charAt(s);return c}function n(r,e,n){"undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=r.length);var t,u=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,a=0;r.length;for(t=e;n>t;t++)a=255&(i^r[t]),i=i>>>8^u[a];return-1^i}var t,u,i,a,o,s,f,l,c,p,m=r[0].length,h=r[0][0].length,g=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,h>>24&255,h>>16&255,h>>8&255,255&h,m>>24&255,m>>16&255,m>>8&255,255&m,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(p=n(g,12,29),g[29]=p>>24&255,g[30]=p>>16&255,g[31]=p>>8&255,g[32]=255&p,t=1,u=0,f=0;m>f;f++){for(m-1>f?g.push(0):g.push(1),o=3*h+1+(0===f)&255,s=3*h+1+(0===f)>>8&255,g.push(o),g.push(s),g.push(255&~o),g.push(255&~s),0===f&&g.push(0),l=0;h>l;l++)for(i=0;3>i;i++)o=r[i][f][l],o=o>255?255:0>o?0:Math.round(o),t=(t+o)%65521,u=(u+t)%65521,g.push(o);g.push(0)}return c=(u<<16)+t,g.push(c>>24&255),g.push(c>>16&255),g.push(c>>8&255),g.push(255&c),a=g.length-41,g[33]=a>>24&255,g[34]=a>>16&255,g[35]=a>>8&255,g[36]=255&a,p=n(g,37),g.push(p>>24&255),g.push(p>>16&255),g.push(p>>8&255),g.push(255&p),g.push(0),g.push(0),g.push(0),g.push(0),g.push(73),g.push(69),g.push(78),g.push(68),g.push(174),g.push(66),g.push(96),g.push(130),"data:image/png;base64,"+e(g)},numeric._dim=function(r){for(var e=[];"object"==typeof r;)e.push(r.length),r=r[0];return e},numeric.dim=function(r){var e,n;return"object"==typeof r?(e=r[0],"object"==typeof e?(n=e[0],"object"==typeof n?numeric._dim(r):[r.length,e.length]):[r.length]):[]},numeric.mapreduce=function(r,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(e,n){var t,u;if(!(e instanceof Array&&n instanceof Array))return!1;if(u=e.length,u!==n.length)return!1;for(t=0;u>t;t++)if(e[t]!==n[t]){if("object"!=typeof e[t])return!1;if(!r(e[t],n[t]))return!1}return!0},numeric.rep=function(r,e,n){"undefined"==typeof n&&(n=0);var t,u=r[n],i=Array(u);if(n===r.length-1){for(t=u-2;t>=0;t-=2)i[t+1]=e,i[t]=e;return-1===t&&(i[0]=e),i}for(t=u-1;t>=0;t--)i[t]=numeric.rep(r,e,n+1);return i},numeric.dotMMsmall=function(r,e){var n,t,u,i,a,o,s,f,l,c,p;for(i=r.length,a=e.length,o=e[0].length,s=Array(i),n=i-1;n>=0;n--){for(f=Array(o),l=r[n],u=o-1;u>=0;u--){for(c=l[a-1]*e[a-1][u],t=a-2;t>=1;t-=2)p=t-1,c+=l[t]*e[t][u]+l[p]*e[p][u];0===t&&(c+=l[0]*e[0][u]),f[u]=c}s[n]=f}return s},numeric._getCol=function(r,e,n){var t,u=r.length;for(t=u-1;t>0;--t)n[t]=r[t][e],--t,n[t]=r[t][e];0===t&&(n[0]=r[0][e])},numeric.dotMMbig=function(r,e){var n,t,u,i,a=numeric._getCol,o=e.length,s=Array(o),f=r.length,l=e[0].length,c=new Array(f),p=numeric.dotVV;for(--o,--f,t=f;-1!==t;--t)c[t]=Array(l);for(--l,t=l;-1!==t;--t)for(a(e,t,s),u=f;-1!==u;--u)i=0,n=r[u],c[u][t]=p(n,s);return c},numeric.dotMV=function(r,e){var n,t=r.length,u=(e.length,Array(t)),i=numeric.dotVV;for(n=t-1;n>=0;n--)u[n]=i(r[n],e);return u},numeric.dotVM=function(r,e){var n,t,u,i,a,o,s;for(u=r.length,i=e[0].length,a=Array(i),t=i-1;t>=0;t--){for(o=r[u-1]*e[u-1][t],n=u-2;n>=1;n-=2)s=n-1,o+=r[n]*e[n][t]+r[s]*e[s][t];0===n&&(o+=r[0]*e[0][t]),a[t]=o}return a},numeric.dotVV=function(r,e){var n,t,u=r.length,i=r[u-1]*e[u-1];for(n=u-2;n>=1;n-=2)t=n-1,i+=r[n]*e[n]+r[t]*e[t];return 0===n&&(i+=r[0]*e[0]),i},numeric.dot=function(r,e){var n=numeric.dim;switch(1e3*n(r).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(r,e):numeric.dotMMbig(r,e);case 2001:return numeric.dotMV(r,e);case 1002:return numeric.dotVM(r,e);case 1001:return numeric.dotVV(r,e);case 1e3:return numeric.mulVS(r,e);case 1:return numeric.mulSV(r,e);case 0:return r*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var e,n,t,u,i=r.length,a=Array(i);for(e=i-1;e>=0;e--){for(u=Array(i),n=e+2,t=i-1;t>=n;t-=2)u[t]=0,u[t-1]=0;for(t>e&&(u[t]=0),u[e]=r[e],t=e-1;t>=1;t-=2)u[t]=0,u[t-1]=0;0===t&&(u[0]=0),a[e]=u}return a},numeric.getDiag=function(r){var e,n=Math.min(r.length,r[0].length),t=Array(n);for(e=n-1;e>=1;--e)t[e]=r[e][e],--e,t[e]=r[e][e];return 0===e&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,e,n){"undefined"==typeof n&&(n="");var t,u,i=[],a=/\[i\]$/,o="",s=!1;for(t=0;t<r.length;t++)a.test(r[t])?(u=r[t].substring(0,r[t].length-3),o=u):u=r[t],"ret"===u&&(s=!0),i.push(u);return i[r.length]="_s",i[r.length+1]="_k",i[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+o+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(s?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(r,e,n){"undefined"==typeof n&&(n="");var t,u,i=[],a=/\[i\]$/,o="",s=!1;for(t=0;t<r.length;t++)a.test(r[t])?(u=r[t].substring(0,r[t].length-3),o=u):u=r[t],"ret"===u&&(s=!0),i.push(u);return i[r.length]="var _n = "+o+".length;\nvar i"+(s?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function e(r,n,t,u,i){if(u===t.length-1)return void i(r,n);var a,o=t[u];for(a=o-1;a>=0;a--)e("object"==typeof r?r[a]:r,"object"==typeof n?n[a]:n,t,u+1,i)},numeric._biforeach2=function n(r,e,t,u,i){if(u===t.length-1)return i(r,e);var a,o=t[u],s=Array(o);for(a=o-1;a>=0;--a)s[a]=n("object"==typeof r?r[a]:r,"object"==typeof e?e[a]:e,t,u+1,i);return s},numeric._foreach=function t(r,e,n,u){if(n===e.length-1)return void u(r);var i,a=e[n];for(i=a-1;i>=0;i--)t(r[i],e,n+1,u)},numeric._foreach2=function u(r,e,n,t){if(n===e.length-1)return t(r);var i,a=e[n],o=Array(a);for(i=a-1;i>=0;i--)o[i]=u(r[i],e,n+1,t);return o},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,e;for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],numeric.ops2[e]=e;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){e=numeric.ops2[r];var n,t,u="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(u="var "+e+" = Math."+e+";\n",n=function(r,n,t){return r+" = "+e+"("+n+","+t+")"},t=function(r,n){return r+" = "+e+"("+r+","+n+")"}):(n=function(r,n,t){return r+" = "+n+" "+e+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+e+"= "+n}:function(r,n){return r+" = "+r+" "+e+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),u),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),u),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),u),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),u),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),u),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],delete numeric.ops2[e];for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],numeric.ops1[e]=e;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(u="",e=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(e)&&(u="var "+e+" = Math."+e+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",u),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",u),numeric[r]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],delete numeric.ops1[e];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(e=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[r]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,e){return"object"==typeof r?"object"==typeof e?numeric.truncVV(r,e):numeric.truncVS(r,e):"object"==typeof e?numeric.truncSV(r,e):Math.round(r/e)*e},numeric.inv=function(r){var e,n,t,u,i,a,o,r,s=numeric.dim(r),f=Math.abs,l=s[0],c=s[1],p=numeric.clone(r),m=numeric.identity(l);for(a=0;c>a;++a){var h=-1,g=-1;for(i=a;i!==l;++i)o=f(p[i][a]),o>g&&(h=i,g=o);for(n=p[h],p[h]=p[a],p[a]=n,u=m[h],m[h]=m[a],m[a]=u,r=n[a],o=a;o!==c;++o)n[o]/=r;for(o=c-1;-1!==o;--o)u[o]/=r;for(i=l-1;-1!==i;--i)if(i!==a){for(e=p[i],t=m[i],r=e[a],o=a+1;o!==c;++o)e[o]-=n[o]*r;for(o=c-1;o>0;--o)t[o]-=u[o]*r,--o,t[o]-=u[o]*r;0===o&&(t[0]-=u[0]*r)}}return m},numeric.det=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,t,u,i,a,o,s,f,l=e[0],c=1,p=numeric.clone(r);for(t=0;l-1>t;t++){for(u=t,n=t+1;l>n;n++)Math.abs(p[n][t])>Math.abs(p[u][t])&&(u=n);for(u!==t&&(s=p[u],p[u]=p[t],p[t]=s,c*=-1),i=p[t],n=t+1;l>n;n++){for(a=p[n],o=a[t]/i[t],u=t+1;l-1>u;u+=2)f=u+1,a[u]-=i[u]*o,a[f]-=i[f]*o;u!==l&&(a[u]-=i[u]*o)}if(0===i[t])return 0;c*=i[t]}return c*p[t][t]},numeric.transpose=function(r){var e,n,t,u,i,a=r.length,o=r[0].length,s=Array(o);for(n=0;o>n;n++)s[n]=Array(a);for(e=a-1;e>=1;e-=2){for(u=r[e],t=r[e-1],n=o-1;n>=1;--n)i=s[n],i[e]=u[n],i[e-1]=t[n],--n,i=s[n],i[e]=u[n],i[e-1]=t[n];0===n&&(i=s[0],i[e]=u[0],i[e-1]=t[0])}if(0===e){for(t=r[0],n=o-1;n>=1;--n)s[n][0]=t[n],--n,s[n][0]=t[n];0===n&&(s[0][0]=t[0])}return s},numeric.negtranspose=function(r){var e,n,t,u,i,a=r.length,o=r[0].length,s=Array(o);for(n=0;o>n;n++)s[n]=Array(a);for(e=a-1;e>=1;e-=2){for(u=r[e],t=r[e-1],n=o-1;n>=1;--n)i=s[n],i[e]=-u[n],i[e-1]=-t[n],--n,i=s[n],i[e]=-u[n],i[e-1]=-t[n];0===n&&(i=s[0],i[e]=-u[0],i[e-1]=-t[0])}if(0===e){for(t=r[0],n=o-1;n>=1;--n)s[n][0]=-t[n],--n,s[n][0]=-t[n];0===n&&(s[0][0]=-t[0])}return s},numeric._random=function i(r,e){var n,t,u=r[e],a=Array(u);if(e===r.length-1){for(t=Math.random,n=u-1;n>=1;n-=2)a[n]=t(),a[n-1]=t();return 0===n&&(a[0]=t()),a}for(n=u-1;n>=0;n--)a[n]=i(r,e+1);return a},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,e,n){if("undefined"==typeof n&&(n=Math.max(Math.round(e-r)+1,1)),2>n)return 1===n?[r]:[];var t,u=Array(n);for(n--,t=n;t>=0;t--)u[t]=(t*e+(n-t)*r)/n;return u},numeric.getBlock=function(r,e,n){function t(r,i){var a,o=e[i],s=n[i]-o,f=Array(s);if(i===u.length-1){for(a=s;a>=0;a--)f[a]=r[a+o];return f}for(a=s;a>=0;a--)f[a]=t(r[a+o],i+1);return f}var u=numeric.dim(r);return t(r,0)},numeric.setBlock=function(r,e,n,t){function u(r,t,a){var o,s=e[a],f=n[a]-s;if(a===i.length-1)for(o=f;o>=0;o--)r[o+s]=t[o];for(o=f;o>=0;o--)u(r[o+s],t[o],a+1)}var i=numeric.dim(r);return u(r,t,0),r},numeric.getRange=function(r,e,n){var t,u,i,a,o=e.length,s=n.length,f=Array(o);for(t=o-1;-1!==t;--t)for(f[t]=Array(s),i=f[t],a=r[e[t]],u=s-1;-1!==u;--u)i[u]=a[n[u]];return f},numeric.blockMatrix=function(r){var e=numeric.dim(r);if(e.length<4)return numeric.blockMatrix([r]);var n,t,u,i,a,o=e[0],s=e[1];for(n=0,t=0,u=0;o>u;++u)n+=r[u][0].length;for(i=0;s>i;++i)t+=r[0][i][0].length;var f=Array(n);for(u=0;n>u;++u)f[u]=Array(t);var l,c,p,m,h,g=0;for(u=0;o>u;++u){for(l=t,i=s-1;-1!==i;--i)for(a=r[u][i],l-=a[0].length,p=a.length-1;-1!==p;--p)for(h=a[p],c=f[g+p],m=h.length-1;-1!==m;--m)c[l+m]=h[m];g+=r[u][0].length}return f},numeric.tensor=function(r,e){if("number"==typeof r||"number"==typeof e)return numeric.mul(r,e);var n=numeric.dim(r),t=numeric.dim(e);if(1!==n.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");
var u,i,a,o,s=n[0],f=t[0],l=Array(s);for(i=s-1;i>=0;i--){for(u=Array(f),o=r[i],a=f-1;a>=3;--a)u[a]=o*e[a],--a,u[a]=o*e[a],--a,u[a]=o*e[a],--a,u[a]=o*e[a];for(;a>=0;)u[a]=o*e[a],--a;l[i]=u}return l},numeric.T=function(r,e){this.x=r,this.y=e},numeric.t=function(r,e){return new numeric.T(r,e)},numeric.Tbinop=function(r,e,n,t,u){numeric.indexOf;if("string"!=typeof u){var i;u="";for(i in numeric)numeric.hasOwnProperty(i)&&(r.indexOf(i)>=0||e.indexOf(i)>=0||n.indexOf(i)>=0||t.indexOf(i)>=0)&&i.length>1&&(u+="var "+i+" = numeric."+i+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+u+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function a(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var a=numeric.div;return this.y?new numeric.T(a(this.x,r.x),a(this.y,r.x)):new numeric.T(a(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),numeric.negtranspose(n)):new numeric.T(r(e))},numeric.Tunop=function(r,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"==typeof r.y)return new numeric.T(numeric.inv(r.x));var e,n,t,u,i,a,o,s,f,l,c,e,n,t,p,m,h,g,v,d,y,b=r.x.length,E=numeric.identity(b),N=numeric.rep([b,b],0),x=numeric.clone(r.x),I=numeric.clone(r.y);for(e=0;b>e;e++){for(h=x[e][e],g=I[e][e],p=h*h+g*g,t=e,n=e+1;b>n;n++)h=x[n][e],g=I[n][e],m=h*h+g*g,m>p&&(t=n,p=m);for(t!==e&&(y=x[e],x[e]=x[t],x[t]=y,y=I[e],I[e]=I[t],I[t]=y,y=E[e],E[e]=E[t],E[t]=y,y=N[e],N[e]=N[t],N[t]=y),u=x[e],i=I[e],s=E[e],f=N[e],h=u[e],g=i[e],n=e+1;b>n;n++)v=u[n],d=i[n],u[n]=(v*h+d*g)/p,i[n]=(d*h-v*g)/p;for(n=0;b>n;n++)v=s[n],d=f[n],s[n]=(v*h+d*g)/p,f[n]=(d*h-v*g)/p;for(n=e+1;b>n;n++){for(a=x[n],o=I[n],l=E[n],c=N[n],h=a[e],g=o[e],t=e+1;b>t;t++)v=u[t],d=i[t],a[t]-=v*h-d*g,o[t]-=d*h+v*g;for(t=0;b>t;t++)v=s[t],d=f[t],l[t]-=v*h-d*g,c[t]-=d*h+v*g}}for(e=b-1;e>0;e--)for(s=E[e],f=N[e],n=e-1;n>=0;n--)for(l=E[n],c=N[n],h=x[n][e],g=I[n][e],t=b-1;t>=0;t--)v=s[t],d=f[t],l[t]-=h*v-g*d,c[t]-=h*d+g*v;return new numeric.T(E,N)},numeric.T.prototype.get=function(r){var e,n=this.x,t=this.y,u=0,i=r.length;if(t){for(;i>u;)e=r[u],n=n[e],t=t[e],u++;return new numeric.T(n,t)}for(;i>u;)e=r[u],n=n[e],u++;return new numeric.T(n)},numeric.T.prototype.set=function(r,e){var n,t=this.x,u=this.y,i=0,a=r.length,o=e.x,s=e.y;if(0===a)return s?this.y=s:u&&(this.y=void 0),this.x=t,this;if(s){for(u||(u=numeric.rep(numeric.dim(t),0),this.y=u);a-1>i;)n=r[i],t=t[n],u=u[n],i++;return n=r[i],t[n]=o,u[n]=s,this}if(u){for(;a-1>i;)n=r[i],t=t[n],u=u[n],i++;return n=r[i],t[n]=o,o instanceof Array?u[n]=numeric.rep(numeric.dim(o),0):u[n]=0,this}for(;a-1>i;)n=r[i],t=t[n],i++;return n=r[i],t[n]=o,this},numeric.T.prototype.getRows=function(r,e){var n,t,u=e-r+1,i=Array(u),a=this.x,o=this.y;for(n=r;e>=n;n++)i[n-r]=a[n];if(o){for(t=Array(u),n=r;e>=n;n++)t[n-r]=o[n];return new numeric.T(i,t)}return new numeric.T(i)},numeric.T.prototype.setRows=function(r,e,n){var t,u=this.x,i=this.y,a=n.x,o=n.y;for(t=r;e>=t;t++)u[t]=a[t-r];if(o)for(i||(i=numeric.rep(numeric.dim(u),0),this.y=i),t=r;e>=t;t++)i[t]=o[t-r];else if(i)for(t=r;e>=t;t++)i[t]=numeric.rep([a[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var e=this.x,n=this.y;return n?new numeric.T(e[r],n[r]):new numeric.T(e[r])},numeric.T.prototype.setRow=function(r,e){var n=this.x,t=this.y,u=e.x,i=e.y;return n[r]=u,i?(t||(t=numeric.rep(numeric.dim(n),0),this.y=t),t[r]=i):t&&(t=numeric.rep([u.length],0)),this},numeric.T.prototype.getBlock=function(r,e){var n=this.x,t=this.y,u=numeric.getBlock;return t?new numeric.T(u(n,r,e),u(t,r,e)):new numeric.T(u(n,r,e))},numeric.T.prototype.setBlock=function(r,e,n){n instanceof numeric.T||(n=new numeric.T(n));var t=this.x,u=this.y,i=numeric.setBlock,a=n.x,o=n.y;return o?(u||(this.y=numeric.rep(numeric.dim(this),0),u=this.y),i(t,r,e,a),i(u,r,e,o),this):(i(t,r,e,a),void(u&&i(u,r,e,numeric.rep(numeric.dim(a),0))))},numeric.T.rep=function(r,e){var n=numeric.T;e instanceof n||(e=new n(e));var t=e.x,u=e.y,i=numeric.rep;return u?new n(i(r,t),i(r,u)):new n(i(r,t))},numeric.T.diag=function o(r){r instanceof numeric.T||(r=new numeric.T(r));var e=r.x,n=r.y,o=numeric.diag;return n?new numeric.T(o(e),o(n)):new numeric.T(o(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,e=this.x,n=this.y;return n?new r.T(r.getDiag(e),r.getDiag(n)):new r.T(r.getDiag(e))},numeric.house=function(r){var e=numeric.clone(r),n=r[0]>=0?1:-1,t=n*numeric.norm2(r);e[0]+=t;var u=numeric.norm2(e);if(0===u)throw new Error("eig: internal error");return numeric.div(e,u)},numeric.toUpperHessenberg=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,t,u,i,a,o,s,f,l,c,p=e[0],m=numeric.clone(r),h=numeric.identity(p);for(t=0;p-2>t;t++){for(i=Array(p-t-1),n=t+1;p>n;n++)i[n-t-1]=m[n][t];if(numeric.norm2(i)>0){for(a=numeric.house(i),o=numeric.getBlock(m,[t+1,t],[p-1,p-1]),s=numeric.tensor(a,numeric.dot(a,o)),n=t+1;p>n;n++)for(f=m[n],l=s[n-t-1],u=t;p>u;u++)f[u]-=2*l[u-t];for(o=numeric.getBlock(m,[0,t+1],[p-1,p-1]),s=numeric.tensor(numeric.dot(o,a),a),n=0;p>n;n++)for(f=m[n],l=s[n],u=t+1;p>u;u++)f[u]-=2*l[u-t-1];for(o=Array(p-t-1),n=t+1;p>n;n++)o[n-t-1]=h[n];for(s=numeric.tensor(a,numeric.dot(a,o)),n=t+1;p>n;n++)for(c=h[n],l=s[n-t-1],u=0;p>u;u++)c[u]-=2*l[u]}}return{H:m,Q:h}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,e){"undefined"==typeof e&&(e=1e4),r=numeric.clone(r);var n,t,u,i,a,o,s,f,l,c,p,m,h,g,v,d,y,b,E=(numeric.clone(r),numeric.dim(r)),N=E[0],x=numeric.identity(N);if(3>N)return{Q:x,B:[[0,N-1]]};var I=numeric.epsilon;for(b=0;e>b;b++){for(d=0;N-1>d;d++)if(Math.abs(r[d+1][d])<I*(Math.abs(r[d][d])+Math.abs(r[d+1][d+1]))){var M=numeric.QRFrancis(numeric.getBlock(r,[0,0],[d,d]),e),A=numeric.QRFrancis(numeric.getBlock(r,[d+1,d+1],[N-1,N-1]),e);for(m=Array(d+1),v=0;d>=v;v++)m[v]=x[v];for(h=numeric.dot(M.Q,m),v=0;d>=v;v++)x[v]=h[v];for(m=Array(N-d-1),v=d+1;N>v;v++)m[v-d-1]=x[v];for(h=numeric.dot(A.Q,m),v=d+1;N>v;v++)x[v]=h[v-d-1];return{Q:x,B:M.B.concat(numeric.add(A.B,d+1))}}if(u=r[N-2][N-2],i=r[N-2][N-1],a=r[N-1][N-2],o=r[N-1][N-1],f=u+o,s=u*o-i*a,l=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*s){var w,_;w=.5*(f+Math.sqrt(f*f-4*s)),_=.5*(f-Math.sqrt(f*f-4*s)),l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,w+_)),numeric.diag(numeric.rep([3],w*_)))}else l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,f)),numeric.diag(numeric.rep([3],s)));for(n=[l[0][0],l[1][0],l[2][0]],t=numeric.house(n),m=[r[0],r[1],r[2]],h=numeric.tensor(t,numeric.dot(t,m)),v=0;3>v;v++)for(p=r[v],g=h[v],y=0;N>y;y++)p[y]-=2*g[y];for(m=numeric.getBlock(r,[0,0],[N-1,2]),h=numeric.tensor(numeric.dot(m,t),t),v=0;N>v;v++)for(p=r[v],g=h[v],y=0;3>y;y++)p[y]-=2*g[y];for(m=[x[0],x[1],x[2]],h=numeric.tensor(t,numeric.dot(t,m)),v=0;3>v;v++)for(c=x[v],g=h[v],y=0;N>y;y++)c[y]-=2*g[y];var $;for(d=0;N-2>d;d++){for(y=d;d+1>=y;y++)if(Math.abs(r[y+1][y])<I*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){var M=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),e),A=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[N-1,N-1]),e);for(m=Array(y+1),v=0;y>=v;v++)m[v]=x[v];for(h=numeric.dot(M.Q,m),v=0;y>=v;v++)x[v]=h[v];for(m=Array(N-y-1),v=y+1;N>v;v++)m[v-y-1]=x[v];for(h=numeric.dot(A.Q,m),v=y+1;N>v;v++)x[v]=h[v-y-1];return{Q:x,B:M.B.concat(numeric.add(A.B,y+1))}}for($=Math.min(N-1,d+3),n=Array($-d),v=d+1;$>=v;v++)n[v-d-1]=r[v][d];for(t=numeric.house(n),m=numeric.getBlock(r,[d+1,d],[$,N-1]),h=numeric.tensor(t,numeric.dot(t,m)),v=d+1;$>=v;v++)for(p=r[v],g=h[v-d-1],y=d;N>y;y++)p[y]-=2*g[y-d];for(m=numeric.getBlock(r,[0,d+1],[N-1,$]),h=numeric.tensor(numeric.dot(m,t),t),v=0;N>v;v++)for(p=r[v],g=h[v],y=d+1;$>=y;y++)p[y]-=2*g[y-d-1];for(m=Array($-d),v=d+1;$>=v;v++)m[v-d-1]=x[v];for(h=numeric.tensor(t,numeric.dot(t,m)),v=d+1;$>=v;v++)for(c=x[v],g=h[v-d-1],y=0;N>y;y++)c[y]-=2*g[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,e){var n,t,u,i,a,o,s,f,l,c,p,m,h,g,v,d,y,b=numeric.toUpperHessenberg(r),E=numeric.QRFrancis(b.H,e),N=numeric.T,x=r.length,I=E.B,M=numeric.dot(E.Q,numeric.dot(b.H,numeric.transpose(E.Q))),A=new N(numeric.dot(E.Q,b.Q)),w=I.length,_=Math.sqrt;for(t=0;w>t;t++)if(n=I[t][0],n===I[t][1]);else{if(i=n+1,a=M[n][n],o=M[n][i],s=M[i][n],f=M[i][i],0===o&&0===s)continue;l=-a-f,c=a*f-o*s,p=l*l-4*c,p>=0?(m=0>l?-.5*(l-_(p)):-.5*(l+_(p)),d=(a-m)*(a-m)+o*o,y=s*s+(f-m)*(f-m),d>y?(d=_(d),g=(a-m)/d,v=o/d):(y=_(y),g=s/y,v=(f-m)/y),u=new N([[v,-g],[g,v]]),A.setRows(n,i,u.dot(A.getRows(n,i)))):(m=-.5*l,h=.5*_(-p),d=(a-m)*(a-m)+o*o,y=s*s+(f-m)*(f-m),d>y?(d=_(d+h*h),g=(a-m)/d,v=o/d,m=0,h/=d):(y=_(y+h*h),g=s/y,v=(f-m)/y,m=h/y,h=0),u=new N([[v,-g],[g,v]],[[m,h],[h,-m]]),A.setRows(n,i,u.dot(A.getRows(n,i))))}var $=A.dot(r).dot(A.transjugate()),x=r.length,V=numeric.T.identity(x);for(i=0;x>i;i++)if(i>0)for(t=i-1;t>=0;t--){var S=$.get([t,t]),T=$.get([i,i]);numeric.neq(S.x,T.x)||numeric.neq(S.y,T.y)?(m=$.getRow(t).getBlock([t],[i-1]),h=V.getRow(i).getBlock([t],[i-1]),V.set([i,t],$.get([t,i]).neg().sub(m.dot(h)).div(S.sub(T)))):V.setRow(i,V.getRow(t))}for(i=0;x>i;i++)m=V.getRow(i),V.setRow(i,m.div(m.norm2()));return V=V.transpose(),V=A.transjugate().dot(V),{lambda:$.getDiag(),E:V}},numeric.ccsSparse=function(r){var e,n,t,u,i=r.length,a=[];for(t=i-1;-1!==t;--t){n=r[t];for(u in n){for(u=parseInt(u);u>=a.length;)a[a.length]=0;0!==n[u]&&a[u]++}}var e=a.length,o=Array(e+1);for(o[0]=0,t=0;e>t;++t)o[t+1]=o[t]+a[t];var s=Array(o[e]),f=Array(o[e]);for(t=i-1;-1!==t;--t){n=r[t];for(u in n)0!==n[u]&&(a[u]--,s[o[u]+a[u]]=t,f[o[u]+a[u]]=n[u])}return[o,s,f]},numeric.ccsFull=function(r){var e,n,t,u,i=r[0],a=r[1],o=r[2],s=numeric.ccsDim(r),f=s[0],l=s[1],c=numeric.rep([f,l],0);for(e=0;l>e;e++)for(t=i[e],u=i[e+1],n=t;u>n;++n)c[a[n]][e]=o[n];return c},numeric.ccsTSolve=function(r,e,n,t,u){function i(r){var e;if(0===n[r]){for(n[r]=1,e=a[r];e<a[r+1];++e)i(o[e]);u[c]=r,++c}}var a=r[0],o=r[1],s=r[2],f=a.length-1,l=Math.max,c=0;"undefined"==typeof t&&(n=numeric.rep([f],0)),"undefined"==typeof t&&(t=numeric.linspace(0,n.length-1)),"undefined"==typeof u&&(u=[]);var p,m,h,g,v,d,y;for(p=t.length-1;-1!==p;--p)i(t[p]);for(u.length=c,p=u.length-1;-1!==p;--p)n[u[p]]=0;for(p=t.length-1;-1!==p;--p)m=t[p],n[m]=e[m];for(p=u.length-1;-1!==p;--p){for(m=u[p],h=a[m],g=l(a[m+1],h),v=h;v!==g;++v)if(o[v]===m){n[m]/=s[v];break}for(y=n[m],v=h;v!==g;++v)d=o[v],d!==m&&(n[d]-=y*s[v])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,e,n,t,u,i){var a,o,s,f=0,l=u.length,c=this.k,p=this.k1,m=this.j;if(0===t[r])for(t[r]=1,m[0]=r,c[0]=o=e[r],p[0]=s=e[r+1];;)if(o>=s){if(u[l]=m[f],0===f)return;++l,--f,o=c[f],s=p[f]}else a=i[n[o]],0===t[a]?(t[a]=1,c[f]=o,++f,m[f]=a,o=e[a],p[f]=s=e[a+1]):++o},numeric.ccsLPSolve=function(r,e,n,t,u,i,a){var o,s,f,l,c,p,m,h,g,v=r[0],d=r[1],y=r[2],b=(v.length-1,e[0]),E=e[1],N=e[2];for(s=b[u],f=b[u+1],t.length=0,o=s;f>o;++o)a.dfs(i[E[o]],v,d,n,t,i);for(o=t.length-1;-1!==o;--o)n[t[o]]=0;for(o=s;o!==f;++o)l=i[E[o]],n[l]=N[o];for(o=t.length-1;-1!==o;--o){for(l=t[o],c=v[l],p=v[l+1],m=c;p>m;++m)if(i[d[m]]===l){n[l]/=y[m];break}for(g=n[l],m=c;p>m;++m)h=i[d[m]],h!==l&&(n[h]-=g*y[m])}return n},numeric.ccsLUP1=function(r,e){var n,t,u,i,a,o,s,f=r[0].length-1,l=[numeric.rep([f+1],0),[],[]],c=[numeric.rep([f+1],0),[],[]],p=l[0],m=l[1],h=l[2],g=c[0],v=c[1],d=c[2],y=numeric.rep([f],0),b=numeric.rep([f],0),E=numeric.ccsLPSolve,N=(Math.max,Math.abs),x=numeric.linspace(0,f-1),I=numeric.linspace(0,f-1),M=new numeric.ccsDFS(f);for("undefined"==typeof e&&(e=1),n=0;f>n;++n){for(E(l,r,y,b,n,I,M),i=-1,a=-1,t=b.length-1;-1!==t;--t)u=b[t],n>=u||(o=N(y[u]),o>i&&(a=u,i=o));for(N(y[n])<e*i&&(t=x[n],i=x[a],x[n]=i,I[i]=n,x[a]=t,I[t]=a,i=y[n],y[n]=y[a],y[a]=i),i=p[n],a=g[n],s=y[n],m[i]=x[n],h[i]=1,++i,t=b.length-1;-1!==t;--t)u=b[t],o=y[u],b[t]=0,y[u]=0,n>=u?(v[a]=u,d[a]=o,++a):(m[i]=x[u],h[i]=o/s,++i);p[n+1]=i,g[n+1]=a}for(t=m.length-1;-1!==t;--t)m[t]=I[m[t]];return{L:l,U:c,P:x,Pinv:I}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,e,n,t,u,i,a){var o,s,f,l=0,c=u.length,p=this.k,m=this.k1,h=this.j;if(0===t[r])for(t[r]=1,h[0]=r,p[0]=s=e[i[r]],m[0]=f=e[i[r]+1];;){if(isNaN(s))throw new Error("Ow!");if(s>=f){if(u[c]=i[h[l]],0===l)return;++c,--l,s=p[l],f=m[l]}else o=n[s],0===t[o]?(t[o]=1,p[l]=s,++l,h[l]=o,o=i[o],s=e[o],m[l]=f=e[o+1]):++s}},numeric.ccsLPSolve0=function(r,e,n,t,u,i,a,o){var s,f,l,c,p,m,h,g,v,d=r[0],y=r[1],b=r[2],E=(d.length-1,e[0]),N=e[1],x=e[2];for(f=E[u],l=E[u+1],t.length=0,s=f;l>s;++s)o.dfs(N[s],d,y,n,t,i,a);for(s=t.length-1;-1!==s;--s)c=t[s],n[a[c]]=0;for(s=f;s!==l;++s)c=N[s],n[c]=x[s];for(s=t.length-1;-1!==s;--s){for(c=t[s],g=a[c],p=d[c],m=d[c+1],h=p;m>h;++h)if(y[h]===g){n[g]/=b[h];break}for(v=n[g],h=p;m>h;++h)n[y[h]]-=v*b[h];n[g]=v}},numeric.ccsLUP0=function(r,e){var n,t,u,i,a,o,s,f=r[0].length-1,l=[numeric.rep([f+1],0),[],[]],c=[numeric.rep([f+1],0),[],[]],p=l[0],m=l[1],h=l[2],g=c[0],v=c[1],d=c[2],y=numeric.rep([f],0),b=numeric.rep([f],0),E=numeric.ccsLPSolve0,N=(Math.max,Math.abs),x=numeric.linspace(0,f-1),I=numeric.linspace(0,f-1),M=new numeric.ccsDFS0(f);for("undefined"==typeof e&&(e=1),n=0;f>n;++n){for(E(l,r,y,b,n,I,x,M),i=-1,a=-1,t=b.length-1;-1!==t;--t)u=b[t],n>=u||(o=N(y[x[u]]),o>i&&(a=u,i=o));for(N(y[x[n]])<e*i&&(t=x[n],i=x[a],x[n]=i,I[i]=n,x[a]=t,I[t]=a),i=p[n],a=g[n],s=y[x[n]],m[i]=x[n],h[i]=1,++i,t=b.length-1;-1!==t;--t)u=b[t],o=y[x[u]],b[t]=0,y[x[u]]=0,n>=u?(v[a]=u,d[a]=o,++a):(m[i]=x[u],h[i]=o/s,++i);p[n+1]=i,g[n+1]=a}for(t=m.length-1;-1!==t;--t)m[t]=I[m[t]];return{L:l,U:c,P:x,Pinv:I}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,e,n){var t=numeric.ccsDim(r),u=t[0],i=t[1];"undefined"==typeof e?e=numeric.linspace(0,u-1):"number"==typeof e&&(e=[e]),"undefined"==typeof n?n=numeric.linspace(0,i-1):"number"==typeof n&&(n=[n]);var a,o,s,f,l,c=e.length,p=n.length,m=numeric.rep([i],0),h=[],g=[],v=[m,h,g],d=r[0],y=r[1],b=r[2],E=numeric.rep([u],0),N=0,x=numeric.rep([u],0);for(o=0;p>o;++o){f=n[o];var I=d[f],M=d[f+1];for(a=I;M>a;++a)s=y[a],x[s]=1,E[s]=b[a];for(a=0;c>a;++a)l=e[a],x[l]&&(h[N]=a,g[N]=E[e[a]],++N);for(a=I;M>a;++a)s=y[a],x[s]=0;m[o+1]=N}return v},numeric.ccsDot=function(r,e){var n,t,u,i,a,o,s,f,l,c,p,m=r[0],h=r[1],g=r[2],v=e[0],d=e[1],y=e[2],b=numeric.ccsDim(r),E=numeric.ccsDim(e),N=b[0],x=(b[1],E[1]),I=numeric.rep([N],0),M=numeric.rep([N],0),A=Array(N),w=numeric.rep([x],0),_=[],$=[],V=[w,_,$];for(u=0;u!==x;++u){for(i=v[u],a=v[u+1],l=0,t=i;a>t;++t)for(c=d[t],p=y[t],o=m[c],s=m[c+1],n=o;s>n;++n)f=h[n],0===M[f]&&(A[l]=f,M[f]=1,l+=1),I[f]=I[f]+g[n]*p;for(i=w[u],a=i+l,w[u+1]=a,t=l-1;-1!==t;--t)p=i+t,n=A[t],_[p]=n,$[p]=I[n],M[n]=0,I[n]=0;w[u+1]=w[u]+l}return V},numeric.ccsLUPSolve=function(r,e){var n=r.L,t=r.U,u=(r.P,e[0]),i=!1;"object"!=typeof u&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],u=e[0],i=!0);var a,o,s,f,l,c,p=e[1],m=e[2],h=n[0].length-1,g=u.length-1,v=numeric.rep([h],0),d=Array(h),y=numeric.rep([h],0),b=Array(h),E=numeric.rep([g+1],0),N=[],x=[],I=numeric.ccsTSolve,M=0;for(a=0;g>a;++a){for(l=0,s=u[a],f=u[a+1],o=s;f>o;++o)c=r.Pinv[p[o]],b[l]=c,y[c]=m[o],++l;for(b.length=l,I(n,y,v,b,d),o=b.length-1;-1!==o;--o)y[b[o]]=0;if(I(t,v,y,d,b),i)return y;for(o=d.length-1;-1!==o;--o)v[d[o]]=0;for(o=b.length-1;-1!==o;--o)c=b[o],N[M]=c,x[M]=y[c],y[c]=0,++M;E[a+1]=M}return[E,N,x]},numeric.ccsbinop=function(r,e){return"undefined"==typeof e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var e,n=r[0],t=r[1],u=r[2],i=numeric.sup(t)+1,a=n.length,o=numeric.rep([i],0),s=Array(a),f=Array(a),l=numeric.rep([i],0);for(e=0;a>e;++e)l[t[e]]++;for(e=0;i>e;++e)o[e+1]=o[e]+l[e];var c,p,m=o.slice(0);for(e=0;a>e;++e)p=t[e],c=m[p],s[c]=n[e],f[c]=u[e],m[p]=m[p]+1;return[o,s,f]},numeric.ccsGather=function(r){var e,n,t,u,i,a=r[0],o=r[1],s=r[2],f=a.length-1,l=o.length,c=Array(l),p=Array(l),m=Array(l);for(i=0,e=0;f>e;++e)for(t=a[e],u=a[e+1],n=t;n!==u;++n)p[i]=e,c[i]=o[n],m[i]=s[n],++i;return[c,p,m]},numeric.sdim=function s(r,e,n){if("undefined"==typeof e&&(e=[]),"object"!=typeof r)return e;"undefined"==typeof n&&(n=0),n in e||(e[n]=0),r.length>e[n]&&(e[n]=r.length);var t;for(t in r)r.hasOwnProperty(t)&&s(r[t],e,n+1);return e},numeric.sclone=function f(r,e,n){"undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=numeric.sdim(r).length);var t,u=Array(r.length);if(e===n-1){for(t in r)r.hasOwnProperty(t)&&(u[t]=r[t]);return u}for(t in r)r.hasOwnProperty(t)&&(u[t]=f(r[t],e+1,n));return u},numeric.sdiag=function(r){var e,n,t=r.length,u=Array(t);for(e=t-1;e>=1;e-=2)n=e-1,u[e]=[],u[e][e]=r[e],u[n]=[],u[n][n]=r[n];return 0===e&&(u[0]=[],u[0][0]=r[e]),u},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var e,n,t,u=[];r.length;for(e in r)if(r.hasOwnProperty(e)){t=r[e];for(n in t)t.hasOwnProperty(n)&&("object"!=typeof u[n]&&(u[n]=[]),u[n][e]=t[n])}return u},numeric.sLUP=function(r,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,e){var n,t,u,i,a,o,s,f=r.length,l=(e.length,numeric.stranspose(e)),c=l.length,p=Array(f);for(u=f-1;u>=0;u--){for(s=[],n=r[u],a=c-1;a>=0;a--){o=0,t=l[a];for(i in n)n.hasOwnProperty(i)&&i in t&&(o+=n[i]*t[i]);o&&(s[a]=o)}p[u]=s}return p},numeric.sdotMV=function(r,e){var n,t,u,i,a=r.length,o=Array(a);for(t=a-1;t>=0;t--){n=r[t],i=0;for(u in n)n.hasOwnProperty(u)&&e[u]&&(i+=n[u]*e[u]);i&&(o[t]=i)}return o},numeric.sdotVM=function(r,e){var n,t,u,i,a=[];for(n in r)if(r.hasOwnProperty(n)){u=e[n],i=r[n];for(t in u)u.hasOwnProperty(t)&&(a[t]||(a[t]=0),a[t]+=i*u[t])}return a},numeric.sdotVV=function(r,e){var n,t=0;for(n in r)r[n]&&e[n]&&(t+=r[n]*e[n]);return t},numeric.sdot=function(r,e){var n=numeric.sdim(r).length,t=numeric.sdim(e).length,u=1e3*n+t;switch(u){case 0:return r*e;case 1001:return numeric.sdotVV(r,e);case 2001:return numeric.sdotMV(r,e);case 1002:return numeric.sdotVM(r,e);case 2002:return numeric.sdotMM(r,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+t)}},numeric.sscatter=function(r){var e,n,t,u,i=r[0].length,a=r.length,o=[];for(n=i-1;n>=0;--n)if(r[a-1][n]){for(u=o,t=0;a-2>t;t++)e=r[t][n],u[e]||(u[e]=[]),u=u[e];u[r[t][n]]=r[t+1][n]}return o},numeric.sgather=function l(r,e,n){"undefined"==typeof e&&(e=[]),"undefined"==typeof n&&(n=[]);var t,u,i;t=n.length;for(u in r)if(r.hasOwnProperty(u))if(n[t]=parseInt(u),i=r[u],"number"==typeof i){if(i){if(0===e.length)for(u=t+1;u>=0;--u)e[u]=[];for(u=t;u>=0;--u)e[u].push(n[u]);e[t+1].push(i)}}else l(i,e,n);return n.length>t&&n.pop(),e},numeric.cLU=function(r){var e,n,t,u,i,a,o=r[0],s=r[1],f=r[2],l=o.length,c=0;for(e=0;l>e;e++)o[e]>c&&(c=o[e]);c++;var p,m,h,g=Array(c),v=Array(c),d=numeric.rep([c],1/0),y=numeric.rep([c],-(1/0));for(t=0;l>t;t++)e=o[t],n=s[t],n<d[e]&&(d[e]=n),n>y[e]&&(y[e]=n);for(e=0;c-1>e;e++)y[e]>y[e+1]&&(y[e+1]=y[e]);for(e=c-1;e>=1;e--)d[e]<d[e-1]&&(d[e-1]=d[e]);var b=0,E=0;for(e=0;c>e;e++)v[e]=numeric.rep([y[e]-d[e]+1],0),g[e]=numeric.rep([e-d[e]],0),b+=e-d[e]+1,E+=y[e]-e+1;for(t=0;l>t;t++)e=o[t],v[e][s[t]-d[e]]=f[t];for(e=0;c-1>e;e++)for(u=e-d[e],p=v[e],n=e+1;d[n]<=e&&c>n;n++)if(i=e-d[n],a=y[e]-e,m=v[n],h=m[i]/p[u]){for(t=1;a>=t;t++)m[t+i]-=h*p[t+u];g[n][e-d[n]]=h}var l,N,x,p=[],m=[],I=[],M=[],A=[],w=[];for(l=0,N=0,e=0;c>e;e++){for(u=d[e],i=y[e],x=v[e],n=e;i>=n;n++)x[n-u]&&(p[l]=e,m[l]=n,I[l]=x[n-u],l++);for(x=g[e],n=u;e>n;n++)x[n-u]&&(M[N]=e,A[N]=n,w[N]=x[n-u],N++);M[N]=e,A[N]=e,w[N]=1,N++}return{U:[p,m,I],L:[M,A,w]}},numeric.cLUsolve=function(r,e){var n,t,u=r.L,i=r.U,a=numeric.clone(e),o=u[0],s=u[1],f=u[2],l=i[0],c=i[1],p=i[2],m=l.length,h=(o.length,a.length);for(t=0,n=0;h>n;n++){for(;s[t]<n;)a[n]-=f[t]*a[s[t]],t++;t++}for(t=m-1,n=h-1;n>=0;n--){for(;c[t]>n;)a[n]-=p[t]*a[c[t]],t--;a[n]/=p[t],t--}return a},numeric.cgrid=function(r,e){"number"==typeof r&&(r=[r,r]);var n,t,u,i=numeric.rep(r,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,n){return e>=r[0]/2||n<r[1]/2};break;default:e=function(r,e){return!0}}for(u=0,n=1;n<r[0]-1;n++)for(t=1;t<r[1]-1;t++)e(n,t)&&(i[n][t]=u,u++);return i},numeric.cdelsq=function(r){var e,n,t,u,i,a=[[-1,0],[0,-1],[0,1],[1,0]],o=numeric.dim(r),s=o[0],f=o[1],l=[],c=[],p=[];for(e=1;s-1>e;e++)for(n=1;f-1>n;n++)if(!(r[e][n]<0)){for(t=0;4>t;t++)u=e+a[t][0],i=n+a[t][1],r[u][i]<0||(l.push(r[e][n]),c.push(r[u][i]),p.push(-1));l.push(r[e][n]),c.push(r[e][n]),p.push(4)}return[l,c,p]},numeric.cdotMV=function(r,e){var n,t,u,i=r[0],a=r[1],o=r[2],s=i.length;for(u=0,t=0;s>t;t++)i[t]>u&&(u=i[t]);for(u++,n=numeric.rep([u],0),t=0;s>t;t++)n[i[t]]+=o[t]*e[a[t]];return n},numeric.Spline=function(r,e,n,t,u){this.x=r,this.yl=e,this.yr=n,this.kl=t,this.kr=u},numeric.Spline.prototype._at=function(r,e){var r,n,t,u,i=this.x,a=this.yl,o=this.yr,s=this.kl,f=this.kr,l=numeric.add,c=numeric.sub,p=numeric.mul;n=c(p(s[e],i[e+1]-i[e]),c(o[e+1],a[e])),t=l(p(f[e+1],i[e]-i[e+1]),c(o[e+1],a[e])),u=(r-i[e])/(i[e+1]-i[e]);var m=u*(1-u);return l(l(l(p(1-u,a[e]),p(u,o[e+1])),p(n,m*(1-u))),p(t,m*u))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var e,n,t,u=this.x,i=u.length,a=Math.floor;for(e=0,n=i-1;n-e>1;)t=a((e+n)/2),u[t]<=r?e=t:n=t;return this._at(r,e)}var o,i=r.length,s=Array(i);for(o=i-1;-1!==o;--o)s[o]=this.at(r[o]);return s},numeric.Spline.prototype.diff=function(){var r,e,n,t=this.x,u=this.yl,i=this.yr,a=this.kl,o=this.kr,s=u.length,f=a,l=o,c=Array(s),p=Array(s),m=numeric.add,h=numeric.mul,g=numeric.div,v=numeric.sub;for(r=s-1;-1!==r;--r)e=t[r+1]-t[r],n=v(i[r+1],u[r]),c[r]=g(m(h(n,6),h(a[r],-4*e),h(o[r+1],-2*e)),e*e),p[r+1]=g(m(h(n,-6),h(a[r],2*e),h(o[r+1],4*e)),e*e);return new numeric.Spline(t,f,l,c,p)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var e=[],n=this.x,t=this.yl,u=this.yr,i=this.kl,a=this.kr;"number"==typeof t[0]&&(t=[t],u=[u],i=[i],a=[a]);var o,s,f,l,c,p,m,h,g,v,d,y,b,E,N,x,I,M,A,w,_,$,V,S,T=t.length,R=n.length-1,e=Array(T),O=Math.sqrt;for(o=0;o!==T;++o){for(l=t[o],c=u[o],p=i[o],m=a[o],h=[],s=0;s!==R;s++){for(s>0&&c[s]*l[s]<0&&h.push(n[s]),x=n[s+1]-n[s],I=n[s],d=l[s],y=c[s+1],g=p[s]/x,v=m[s+1]/x,N=r(g-v+3*(d-y))+12*v*d,b=v+3*d+2*g-3*y,E=3*(v+g+2*(d-y)),0>=N?(A=b/E,M=A>n[s]&&A<n[s+1]?[n[s],A,n[s+1]]:[n[s],n[s+1]]):(A=(b-O(N))/E,w=(b+O(N))/E,M=[n[s]],A>n[s]&&A<n[s+1]&&M.push(A),w>n[s]&&w<n[s+1]&&M.push(w),M.push(n[s+1])),$=M[0],A=this._at($,s),f=0;f<M.length-1;f++)if(V=M[f+1],w=this._at(V,s),0!==A)if(0===w||A*w>0)$=V,A=w;else{for(var C=0;;){if(S=(A*V-w*$)/(A-w),$>=S||S>=V)break;if(_=this._at(S,s),_*w>0)V=S,w=_,-1===C&&(A*=.5),C=-1;else{if(!(_*A>0))break;$=S,A=_,1===C&&(w*=.5),C=1}}h.push(S),$=M[f+1],A=this._at($,s)}else h.push($),$=V,A=w;0===w&&h.push(V)}e[o]=h}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(r,e,n,t){var u,i=r.length,a=[],o=[],s=[],f=numeric.sub,l=numeric.mul,c=numeric.add;for(u=i-2;u>=0;u--)o[u]=r[u+1]-r[u],s[u]=f(e[u+1],e[u]);("string"==typeof n||"string"==typeof t)&&(n=t="periodic");var p=[[],[],[]];switch(typeof n){case"undefined":a[0]=l(3/(o[0]*o[0]),s[0]),p[0].push(0,0),p[1].push(0,1),p[2].push(2/o[0],1/o[0]);break;case"string":a[0]=c(l(3/(o[i-2]*o[i-2]),s[i-2]),l(3/(o[0]*o[0]),s[0])),p[0].push(0,0,0),p[1].push(i-2,0,1),p[2].push(1/o[i-2],2/o[i-2]+2/o[0],1/o[0]);break;default:a[0]=n,p[0].push(0),p[1].push(0),p[2].push(1)}for(u=1;i-1>u;u++)a[u]=c(l(3/(o[u-1]*o[u-1]),s[u-1]),l(3/(o[u]*o[u]),s[u])),p[0].push(u,u,u),p[1].push(u-1,u,u+1),p[2].push(1/o[u-1],2/o[u-1]+2/o[u],1/o[u]);switch(typeof t){case"undefined":a[i-1]=l(3/(o[i-2]*o[i-2]),s[i-2]),p[0].push(i-1,i-1),p[1].push(i-2,i-1),p[2].push(1/o[i-2],2/o[i-2]);break;case"string":p[1][p[1].length-1]=0;break;default:a[i-1]=t,p[0].push(i-1),p[1].push(i-1),p[2].push(1)}a="number"!=typeof a[0]?numeric.transpose(a):[a];var m=Array(a.length);if("string"==typeof n)for(u=m.length-1;-1!==u;--u)m[u]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(p)),a[u]),m[u][i-1]=m[u][0];else for(u=m.length-1;-1!==u;--u)m[u]=numeric.cLUsolve(numeric.cLU(p),a[u]);return m="number"==typeof e[0]?m[0]:numeric.transpose(m),new numeric.Spline(r,e,e,m,m)},numeric.fftpow2=function c(r,e){var n=r.length;if(1!==n){var t,u,i=Math.cos,a=Math.sin,o=Array(n/2),s=Array(n/2),f=Array(n/2),l=Array(n/2);for(u=n/2,t=n-1;-1!==t;--t)--u,f[u]=r[t],l[u]=e[t],--t,o[u]=r[t],s[u]=e[t];c(o,s),c(f,l),u=n/2;var p,m,h,g=-6.283185307179586/n;for(t=n-1;-1!==t;--t)--u,-1===u&&(u=n/2-1),p=g*t,m=i(p),h=a(p),r[t]=o[u]+m*f[u]-h*l[u],e[t]=s[u]+m*l[u]+h*f[u]}},numeric._ifftpow2=function p(r,e){var n=r.length;if(1!==n){var t,u,i=Math.cos,a=Math.sin,o=Array(n/2),s=Array(n/2),f=Array(n/2),l=Array(n/2);for(u=n/2,t=n-1;-1!==t;--t)--u,f[u]=r[t],l[u]=e[t],--t,o[u]=r[t],s[u]=e[t];p(o,s),p(f,l),u=n/2;var c,m,h,g=6.283185307179586/n;for(t=n-1;-1!==t;--t)--u,-1===u&&(u=n/2-1),c=g*t,m=i(c),h=a(c),r[t]=o[u]+m*f[u]-h*l[u],e[t]=s[u]+m*l[u]+h*f[u]}},numeric.ifftpow2=function(r,e){numeric._ifftpow2(r,e),numeric.diveq(r,r.length),numeric.diveq(e,e.length)},numeric.convpow2=function(r,e,n,t){numeric.fftpow2(r,e),numeric.fftpow2(n,t);var u,i,a,o,s,f=r.length;for(u=f-1;-1!==u;--u)i=r[u],o=e[u],a=n[u],s=t[u],r[u]=i*a-o*s,e[u]=i*s+o*a;numeric.ifftpow2(r,e)},numeric.T.prototype.fft=function(){var r,e,n=this.x,t=this.y,u=n.length,i=Math.log,a=i(2),o=Math.ceil(i(2*u-1)/a),s=Math.pow(2,o),f=numeric.rep([s],0),l=numeric.rep([s],0),c=Math.cos,p=Math.sin,m=-3.141592653589793/u,h=numeric.rep([s],0),g=numeric.rep([s],0);Math.floor(u/2);for(r=0;u>r;r++)h[r]=n[r];if("undefined"!=typeof t)for(r=0;u>r;r++)g[r]=t[r];for(f[0]=1,r=1;s/2>=r;r++)e=m*r*r,f[r]=c(e),l[r]=p(e),f[s-r]=c(e),l[s-r]=p(e);var v=new numeric.T(h,g),d=new numeric.T(f,l);return v=v.mul(d),numeric.convpow2(v.x,v.y,numeric.clone(d.x),numeric.neg(d.y)),v=v.mul(d),v.x.length=u,v.y.length=u,v},numeric.T.prototype.ifft=function(){var r,e,n=this.x,t=this.y,u=n.length,i=Math.log,a=i(2),o=Math.ceil(i(2*u-1)/a),s=Math.pow(2,o),f=numeric.rep([s],0),l=numeric.rep([s],0),c=Math.cos,p=Math.sin,m=3.141592653589793/u,h=numeric.rep([s],0),g=numeric.rep([s],0);Math.floor(u/2);for(r=0;u>r;r++)h[r]=n[r];if("undefined"!=typeof t)for(r=0;u>r;r++)g[r]=t[r];for(f[0]=1,r=1;s/2>=r;r++)e=m*r*r,f[r]=c(e),l[r]=p(e),f[s-r]=c(e),l[s-r]=p(e);var v=new numeric.T(h,g),d=new numeric.T(f,l);return v=v.mul(d),numeric.convpow2(v.x,v.y,numeric.clone(d.x),numeric.neg(d.y)),v=v.mul(d),v.x.length=u,v.y.length=u,v.div(u)},numeric.gradient=function(r,e){var n=e.length,t=r(e);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var u,i,a,o,s,f,l,c,p,m,h=Math.max,g=numeric.clone(e),v=Array(n),h=(numeric.div,numeric.sub,Math.max),d=.001,y=Math.abs,b=Math.min,E=0;for(u=0;n>u;u++)for(var N=h(1e-6*t,1e-8);;){if(++E,E>20)throw new Error("Numerical gradient fails");if(g[u]=e[u]+N,i=r(g),g[u]=e[u]-N,a=r(g),g[u]=e[u],isNaN(i)||isNaN(a))N/=16;else{if(v[u]=(i-a)/(2*N),s=e[u]-N,f=e[u],l=e[u]+N,c=(i-t)/N,p=(t-a)/N,m=h(y(v[u]),y(t),y(i),y(a),y(s),y(f),y(l),1e-8),o=b(h(y(c-v[u]),y(p-v[u]),y(c-p))/m,N/m),!(o>d))break;N/=16}}return v},numeric.uncmin=function(r,e,n,t,u,i,a){var o=numeric.gradient;"undefined"==typeof a&&(a={}),"undefined"==typeof n&&(n=1e-8),"undefined"==typeof t&&(t=function(e){return o(r,e)}),"undefined"==typeof u&&(u=1e3),e=numeric.clone(e);var s,f,l=e.length,c=r(e);if(isNaN(c))throw new Error("uncmin: f(x0) is a NaN!");var p=Math.max,m=numeric.norm2;n=p(n,numeric.epsilon);var h,g,v,d,y,b,E,N,x,I,M=a.Hinv||numeric.identity(l),A=numeric.dot,w=(numeric.inv,numeric.sub),_=numeric.add,$=numeric.tensor,V=numeric.div,S=numeric.mul,T=numeric.all,R=numeric.isFinite,O=numeric.neg,C=0,D="";for(g=t(e);u>C;){if("function"==typeof i&&i(C,e,c,g,M)){D="Callback returned true";break}if(!T(R(g))){D="Gradient has Infinity or NaN";break}if(h=O(A(M,g)),
!T(R(h))){D="Search direction has Infinity or NaN";break}if(I=m(h),n>I){D="Newton step smaller than tol";break}for(x=1,f=A(g,h),y=e;u>C&&!(n>x*I)&&(d=S(h,x),y=_(e,d),s=r(y),s-c>=.1*x*f||isNaN(s));)x*=.5,++C;if(n>x*I){D="Line search step size smaller than tol";break}if(C===u){D="maxit reached during line search";break}v=t(y),b=w(v,g),N=A(b,d),E=A(M,b),M=w(_(M,S((N+A(b,E))/(N*N),$(d,d))),V(_($(E,d),$(d,E)),N)),e=y,c=s,g=v,++C}return{solution:e,f:c,gradient:g,invHessian:M,iterations:C,message:D}},numeric.Dopri=function(r,e,n,t,u,i,a){this.x=r,this.y=e,this.f=n,this.ymid=t,this.iterations=u,this.events=a,this.message=i},numeric.Dopri.prototype._at=function(r,e){function n(r){return r*r}var t,u,i,a,o,s,r,f,l,c,p,m=this,h=m.x,g=m.y,v=m.f,d=m.ymid,y=(h.length,Math.floor,.5),b=numeric.add,E=numeric.mul,N=numeric.sub;return t=h[e],u=h[e+1],a=g[e],o=g[e+1],f=u-t,i=t+y*f,s=d[e],l=N(v[e],E(a,1/(t-i)+2/(t-u))),c=N(v[e+1],E(o,1/(u-i)+2/(u-t))),p=[n(r-u)*(r-i)/n(t-u)/(t-i),n(r-t)*n(r-u)/n(t-i)/n(u-i),n(r-t)*(r-i)/n(u-t)/(u-i),(r-t)*n(r-u)*(r-i)/n(t-u)/(t-i),(r-u)*n(r-t)*(r-i)/n(t-u)/(u-i)],b(b(b(b(E(a,p[0]),E(s,p[1])),E(o,p[2])),E(l,p[3])),E(c,p[4]))},numeric.Dopri.prototype.at=function(r){var e,n,t,u=Math.floor;if("number"!=typeof r){var i=r.length,a=Array(i);for(e=i-1;-1!==e;--e)a[e]=this.at(r[e]);return a}var o=this.x;for(e=0,n=o.length-1;n-e>1;)t=u(.5*(e+n)),o[t]<=r?e=t:n=t;return this._at(r,e)},numeric.dopri=function(r,e,n,t,u,i,a){"undefined"==typeof u&&(u=1e-6),"undefined"==typeof i&&(i=1e3);var o,s,f,l,c,p,m,h,g,v,d,y,b,E=[r],N=[n],x=[t(r,n)],I=[],M=.2,A=[.075,.225],w=[44/45,-56/15,32/9],_=[19372/6561,-25360/2187,64448/6561,-212/729],$=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],V=[35/384,0,500/1113,125/192,-2187/6784,11/84],S=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],T=[.2,.3,.8,8/9,1,1],R=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],O=0,C=(e-r)/10,D=0,L=numeric.add,k=numeric.mul,j=(Math.max,Math.min),P=Math.abs,F=numeric.norminf,U=Math.pow,q=numeric.any,B=numeric.lt,G=numeric.and,Y=(numeric.sub,new numeric.Dopri(E,N,x,I,-1,""));for("function"==typeof a&&(d=a(r,n));e>r&&i>D;)if(++D,r+C>e&&(C=e-r),o=t(r+T[0]*C,L(n,k(M*C,x[O]))),s=t(r+T[1]*C,L(L(n,k(A[0]*C,x[O])),k(A[1]*C,o))),f=t(r+T[2]*C,L(L(L(n,k(w[0]*C,x[O])),k(w[1]*C,o)),k(w[2]*C,s))),l=t(r+T[3]*C,L(L(L(L(n,k(_[0]*C,x[O])),k(_[1]*C,o)),k(_[2]*C,s)),k(_[3]*C,f))),c=t(r+T[4]*C,L(L(L(L(L(n,k($[0]*C,x[O])),k($[1]*C,o)),k($[2]*C,s)),k($[3]*C,f)),k($[4]*C,l))),g=L(L(L(L(L(n,k(x[O],C*V[0])),k(s,C*V[2])),k(f,C*V[3])),k(l,C*V[4])),k(c,C*V[5])),p=t(r+C,g),m=L(L(L(L(L(k(x[O],C*R[0]),k(s,C*R[2])),k(f,C*R[3])),k(l,C*R[4])),k(c,C*R[5])),k(p,C*R[6])),v="number"==typeof m?P(m):F(m),v>u){if(C=.2*C*U(u/v,.25),r+C===r){Y.msg="Step size became too small";break}}else{if(I[O]=L(L(L(L(L(L(n,k(x[O],C*S[0])),k(s,C*S[2])),k(f,C*S[3])),k(l,C*S[4])),k(c,C*S[5])),k(p,C*S[6])),++O,E[O]=r+C,N[O]=g,x[O]=p,"function"==typeof a){var X,H,Q=r,W=r+.5*C;if(y=a(W,I[O-1]),b=G(B(d,0),B(0,y)),q(b)||(Q=W,W=r+C,d=y,y=a(W,g),b=G(B(d,0),B(0,y))),q(b)){for(var K,z,Z=0,J=1,rr=1;;){if("number"==typeof d)H=(rr*y*Q-J*d*W)/(rr*y-J*d);else for(H=W,h=d.length-1;-1!==h;--h)d[h]<0&&y[h]>0&&(H=j(H,(rr*y[h]*Q-J*d[h]*W)/(rr*y[h]-J*d[h])));if(Q>=H||H>=W)break;X=Y._at(H,O-1),z=a(H,X),K=G(B(d,0),B(0,z)),q(K)?(W=H,y=z,b=K,rr=1,-1===Z?J*=.5:J=1,Z=-1):(Q=H,d=z,J=1,1===Z?rr*=.5:rr=1,Z=1)}return g=Y._at(.5*(r+H),O-1),Y.f[O]=t(H,X),Y.x[O]=H,Y.y[O]=X,Y.ymid[O-1]=g,Y.events=b,Y.iterations=D,Y}}r+=C,n=g,d=y,C=j(.8*C*U(u/v,.25),4*C)}return Y.iterations=D,Y},numeric.LU=function(r,e){e=e||!1;var n,t,u,i,a,o,s,f,l,c=Math.abs,p=r.length,m=p-1,h=new Array(p);for(e||(r=numeric.clone(r)),u=0;p>u;++u){for(s=u,o=r[u],l=c(o[u]),t=u+1;p>t;++t)i=c(r[t][u]),i>l&&(l=i,s=t);for(h[u]=s,s!=u&&(r[u]=r[s],r[s]=o,o=r[u]),a=o[u],n=u+1;p>n;++n)r[n][u]/=a;for(n=u+1;p>n;++n){for(f=r[n],t=u+1;m>t;++t)f[t]-=f[u]*o[t],++t,f[t]-=f[u]*o[t];t===m&&(f[t]-=f[u]*o[t])}}return{LU:r,P:h}},numeric.LUsolve=function(r,e){var n,t,u,i,a,o=r.LU,s=o.length,f=numeric.clone(e),l=r.P;for(n=s-1;-1!==n;--n)f[n]=e[n];for(n=0;s>n;++n)for(u=l[n],l[n]!==n&&(a=f[n],f[n]=f[u],f[u]=a),i=o[n],t=0;n>t;++t)f[n]-=f[t]*i[t];for(n=s-1;n>=0;--n){for(i=o[n],t=n+1;s>t;++t)f[n]-=f[t]*i[t];f[n]/=i[n]}return f},numeric.solve=function(r,e,n){return numeric.LUsolve(numeric.LU(r,n),e)},numeric.echelonize=function(r){var e,n,t,u,i,a,o,s,f=numeric.dim(r),l=f[0],c=f[1],p=numeric.identity(l),m=Array(l),h=Math.abs,g=numeric.diveq;for(r=numeric.clone(r),e=0;l>e;++e){for(t=0,i=r[e],a=p[e],n=1;c>n;++n)h(i[t])<h(i[n])&&(t=n);for(m[e]=t,g(a,i[t]),g(i,i[t]),n=0;l>n;++n)if(n!==e){for(o=r[n],s=o[t],u=c-1;-1!==u;--u)o[u]-=i[u]*s;for(o=p[n],u=l-1;-1!==u;--u)o[u]-=a[u]*s}}return{I:p,A:r,P:m}},numeric.__solveLP=function(r,e,n,t,u,i,a){var o,s,f,l,c=numeric.sum,p=(numeric.log,numeric.mul),m=numeric.sub,h=numeric.dot,g=numeric.div,v=numeric.add,d=r.length,y=n.length,b=!1,E=0,N=1,x=(numeric.transpose(e),numeric.svd,numeric.transpose),I=(numeric.leq,Math.sqrt),M=Math.abs,A=(numeric.muleq,numeric.norminf,numeric.any,Math.min),w=numeric.all,_=numeric.gt,$=Array(d),V=Array(y),S=(numeric.rep([y],1),numeric.solve),T=m(n,h(e,i)),R=h(r,r);for(f=E;u>f;++f){var O,C;for(O=y-1;-1!==O;--O)V[O]=g(e[O],T[O]);var D=x(V);for(O=d-1;-1!==O;--O)$[O]=c(D[O]);N=.25*M(R/h(r,$));var L=100*I(R/h($,$));for((!isFinite(N)||N>L)&&(N=L),l=v(r,p(N,$)),s=h(D,V),O=d-1;-1!==O;--O)s[O][O]+=1;C=S(s,g(l,N),!0);var k=g(T,h(e,C)),j=1;for(O=y-1;-1!==O;--O)k[O]<0&&(j=A(j,-.999*k[O]));if(o=m(i,p(C,j)),T=m(n,h(e,o)),!w(_(T,0)))return{solution:i,message:"",iterations:f};if(i=o,t>N)return{solution:o,message:"",iterations:f};if(a){var P=h(r,l),F=h(e,l);for(b=!0,O=y-1;-1!==O;--O)if(P*F[O]<0){b=!1;break}}else b=i[d-1]>=0?!1:!0;if(b)return{solution:o,message:"Unbounded",iterations:f}}return{solution:i,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,e,n,t,u){var i,a=r.length,o=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),f=numeric.dot,l=(numeric.div,numeric.add,numeric.rep([a],0).concat([1])),c=numeric.rep([o,1],-1),p=numeric.blockMatrix([[e,c]]),m=n,i=numeric.rep([a],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),h=numeric.__solveLP(l,p,m,t,u,i,!1),g=numeric.clone(h.solution);g.length=a;var v=numeric.inf(s(n,f(e,g)));if(0>v)return{solution:NaN,message:"Infeasible",iterations:h.iterations};var d=numeric.__solveLP(r,e,n,t,u-h.iterations,g,!0);return d.iterations+=h.iterations,d},numeric.solveLP=function(r,e,n,t,u,i,a){if("undefined"==typeof a&&(a=1e3),"undefined"==typeof i&&(i=numeric.epsilon),"undefined"==typeof t)return numeric._solveLP(r,e,n,i,a);var o,s=t.length,f=t[0].length,l=e.length,c=numeric.echelonize(t),p=numeric.rep([f],0),m=c.P,h=[];for(o=m.length-1;-1!==o;--o)p[m[o]]=1;for(o=f-1;-1!==o;--o)0===p[o]&&h.push(o);var g=numeric.getRange,v=numeric.linspace(0,s-1),d=numeric.linspace(0,l-1),y=g(t,v,h),b=g(e,d,m),E=g(e,d,h),N=numeric.dot,x=numeric.sub,I=N(b,c.I),M=x(E,N(I,y)),A=x(n,N(I,u)),w=Array(m.length),_=Array(h.length);for(o=m.length-1;-1!==o;--o)w[o]=r[m[o]];for(o=h.length-1;-1!==o;--o)_[o]=r[h[o]];var $=x(_,N(w,N(c.I,y))),V=numeric._solveLP($,M,A,i,a),S=V.solution;if(S!==S)return V;var T=N(c.I,x(u,N(y,S))),R=Array(r.length);for(o=m.length-1;-1!==o;--o)R[m[o]]=T[o];for(o=h.length-1;-1!==o;--o)R[h[o]]=S[o];return{solution:R,message:V.message,iterations:V.iterations}},numeric.MPStoLP=function(r){function e(e){throw new Error("MPStoLP: "+e+"\nLine "+n+": "+r[n]+"\nCurrent state: "+o[a]+"\n")}r instanceof String&&r.split("\n");var n,t,u,i,a=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=r.length,f=0,l={},c=[],p=0,m={},h=0,g=[],v=[],d=[];for(n=0;s>n;++n){u=r[n];var y=u.match(/\S*/g),b=[];for(t=0;t<y.length;++t)""!==y[t]&&b.push(y[t]);if(0!==b.length){for(t=0;t<o.length&&u.substr(0,o[t].length)!==o[t];++t);if(t<o.length){if(a=t,1===t&&(i=b[1]),6===t)return{name:i,c:g,A:numeric.transpose(v),b:d,rows:l,vars:m}}else switch(a){case 0:case 1:e("Unexpected line");case 2:switch(b[0]){case"N":0===f?f=b[1]:e("Two or more N rows");break;case"L":l[b[1]]=p,c[p]=1,d[p]=0,++p;break;case"G":l[b[1]]=p,c[p]=-1,d[p]=0,++p;break;case"E":l[b[1]]=p,c[p]=0,d[p]=0,++p;break;default:e("Parse error "+numeric.prettyPrint(b))}break;case 3:m.hasOwnProperty(b[0])||(m[b[0]]=h,g[h]=0,v[h]=numeric.rep([p],0),++h);var E=m[b[0]];for(t=1;t<b.length;t+=2)if(b[t]!==f){var N=l[b[t]];v[E][N]=(c[N]<0?-1:1)*parseFloat(b[t+1])}else g[E]=parseFloat(b[t+1]);break;case 4:for(t=1;t<b.length;t+=2)d[l[b[t]]]=(c[l[b[t]]]<0?-1:1)*parseFloat(b[t+1]);break;case 5:break;case 6:e("Internal error")}}}e("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,e,n,t,u,i,a){function o(r){var e,t,u=this,i=r.length,a=0,o=u.i=u.j=u.m=0;for(u.S=[],u.c=[],i||(r=[i++]);n>a;)u.S[a]=a++;for(a=0;n>a;a++)e=u.S[a],o=l(o+e+r[a%i]),t=u.S[o],u.S[a]=t,u.S[o]=e;u.g=function(r){var e=u.S,t=l(u.i+1),i=e[t],a=l(u.j+i),o=e[a];e[t]=o,e[a]=i;for(var s=e[l(i+o)];--r;)t=l(t+1),i=e[t],a=l(a+i),o=e[a],e[t]=o,e[a]=i,s=s*n+e[l(i+o)];return u.i=t,u.j=a,s},u.g(n)}function s(r,e,n,t,u){if(n=[],u=typeof r,e&&"object"==u)for(t in r)if(t.indexOf("S")<5)try{n.push(s(r[t],e-1))}catch(i){}return n.length?n:r+("string"!=u?"\x00":"")}function f(r,e,n,t){for(r+="",n=0,t=0;t<r.length;t++)e[l(t)]=l((n^=19*e[l(t)])+r.charCodeAt(t));r="";for(t in e)r+=String.fromCharCode(e[t]);return r}function l(r){return r&n-1}e.seedrandom=function(l,c){var p,m=[];return l=f(s(c?[l,r]:arguments.length?l:[(new Date).getTime(),r,window],3),m),p=new o(m),f(p.S,r),e.random=function(){for(var r=p.g(t),e=a,o=0;u>r;)r=(r+o)*n,e*=n,o=p.g(1);for(;r>=i;)r/=2,e/=2,o>>>=1;return(r+o)/e},l},a=e.pow(n,t),u=e.pow(2,u),i=2*u,f(e.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function e(r){if("object"!=typeof r)return r;var n,t=[],u=r.length;for(n=0;u>n;n++)t[n+1]=e(r[n]);return t}function n(r){if("object"!=typeof r)return r;var e,t=[],u=r.length;for(e=1;u>e;e++)t[e-1]=n(r[e]);return t}function t(r,e,n){var t,u,i,a,o;for(i=1;n>=i;i+=1){for(r[i][i]=1/r[i][i],o=-r[i][i],t=1;i>t;t+=1)r[t][i]=o*r[t][i];if(a=i+1,a>n)break;for(u=a;n>=u;u+=1)for(o=r[i][u],r[i][u]=0,t=1;i>=t;t+=1)r[t][u]=r[t][u]+o*r[t][i]}}function u(r,e,n,t){var u,i,a,o;for(i=1;n>=i;i+=1){for(o=0,u=1;i>u;u+=1)o+=r[u][i]*t[u];t[i]=(t[i]-o)/r[i][i]}for(a=1;n>=a;a+=1)for(i=n+1-a,t[i]=t[i]/r[i][i],o=-t[i],u=1;i>u;u+=1)t[u]=t[u]+o*r[u][i]}function i(r,e,n,t){var u,i,a,o,s,f;for(i=1;n>=i;i+=1){if(t[1]=i,f=0,a=i-1,1>a){if(f=r[i][i]-f,0>=f)break;r[i][i]=Math.sqrt(f)}else{for(o=1;a>=o;o+=1){for(s=r[o][i],u=1;o>u;u+=1)s-=r[u][i]*r[u][o];s/=r[o][o],r[o][i]=s,f+=s*s}if(f=r[i][i]-f,0>=f)break;r[i][i]=Math.sqrt(f)}t[1]=0}}function a(r,e,n,a,o,s,f,l,c,p,m,h,g,v,d,y){function b(){for(v[1]=v[1]+1,w=O,M=1;p>=M;M+=1){for(w+=1,P=-l[M],A=1;a>=A;A+=1)P+=f[A][M]*o[A];if(Math.abs(P)<H&&(P=0),M>m)d[w]=P;else if(d[w]=-Math.abs(P),P>0){for(A=1;a>=A;A+=1)f[A][M]=-f[A][M];l[M]=-l[M]}}for(M=1;g>=M;M+=1)d[O+h[M]]=0;for(D=0,j=0,M=1;p>=M;M+=1)d[O+M]<j*d[k+M]&&(D=M,j=d[O+M]/d[k+M]);return 0===D?999:0}function E(){for(M=1;a>=M;M+=1){for(P=0,A=1;a>=A;A+=1)P+=r[A][M]*f[A][D];d[M]=P}for(_=S,M=1;a>=M;M+=1)d[_+M]=0;for(A=g+1;a>=A;A+=1)for(M=1;a>=M;M+=1)d[_+M]=d[_+M]+r[M][A]*d[A];for(Y=!0,M=g;M>=1;M-=1){for(P=d[M],w=R+M*(M+3)/2,_=w-M,A=M+1;g>=A;A+=1)P-=d[w]*d[T+A],w+=A;if(P/=d[_],d[T+M]=P,h[M]<m)break;if(0>P)break;Y=!1,V=M}if(!Y)for(F=d[C+V]/d[T+V],M=1;g>=M&&!(h[M]<m)&&!(d[T+M]<0);M+=1)j=d[C+M]/d[T+M],F>j&&(F=j,V=M);for(P=0,M=S+1;S+a>=M;M+=1)P+=d[M]*d[M];if(Math.abs(P)<=H){if(Y)return y[1]=1,999;for(M=1;g>=M;M+=1)d[C+M]=d[C+M]-F*d[T+M];return d[C+g+1]=d[C+g+1]+F,700}for(P=0,M=1;a>=M;M+=1)P+=d[S+M]*f[M][D];for(U=-d[O+D]/P,X=!0,Y||U>F&&(U=F,X=!1),M=1;a>=M;M+=1)o[M]=o[M]+U*d[S+M],Math.abs(o[M])<H&&(o[M]=0);for(s[1]=s[1]+U*P*(U/2+d[C+g+1]),M=1;g>=M;M+=1)d[C+M]=d[C+M]-U*d[T+M];if(d[C+g+1]=d[C+g+1]+U,!X){for(P=-l[D],A=1;a>=A;A+=1)P+=o[A]*f[A][D];if(D>m)d[O+D]=P;else if(d[O+D]=-Math.abs(P),P>0){for(A=1;a>=A;A+=1)f[A][D]=-f[A][D];l[D]=-l[D]}return 700}for(g+=1,h[g]=D,w=R+(g-1)*g/2+1,M=1;g-1>=M;M+=1)d[w]=d[M],w+=1;if(g===a)d[w]=d[a];else{for(M=a;M>=g+1&&0!==d[M]&&(q=Math.max(Math.abs(d[M-1]),Math.abs(d[M])),B=Math.min(Math.abs(d[M-1]),Math.abs(d[M])),j=d[M-1]>=0?Math.abs(q*Math.sqrt(1+B*B/(q*q))):-Math.abs(q*Math.sqrt(1+B*B/(q*q))),q=d[M-1]/j,B=d[M]/j,1!==q);M-=1)if(0===q)for(d[M-1]=B*j,A=1;a>=A;A+=1)j=r[A][M-1],r[A][M-1]=r[A][M],r[A][M]=j;else for(d[M-1]=j,G=B/(1+q),A=1;a>=A;A+=1)j=q*r[A][M-1]+B*r[A][M],r[A][M]=G*(r[A][M-1]+j)-r[A][M],r[A][M-1]=j;d[w]=d[g]}return 0}function N(){if(w=R+V*(V+1)/2+1,_=w+V,0===d[_])return 798;if(q=Math.max(Math.abs(d[_-1]),Math.abs(d[_])),B=Math.min(Math.abs(d[_-1]),Math.abs(d[_])),j=d[_-1]>=0?Math.abs(q*Math.sqrt(1+B*B/(q*q))):-Math.abs(q*Math.sqrt(1+B*B/(q*q))),q=d[_-1]/j,B=d[_]/j,1===q)return 798;if(0===q){for(M=V+1;g>=M;M+=1)j=d[_-1],d[_-1]=d[_],d[_]=j,_+=M;for(M=1;a>=M;M+=1)j=r[M][V],r[M][V]=r[M][V+1],r[M][V+1]=j}else{for(G=B/(1+q),M=V+1;g>=M;M+=1)j=q*d[_-1]+B*d[_],d[_]=G*(d[_-1]+j)-d[_],d[_-1]=j,_+=M;for(M=1;a>=M;M+=1)j=q*r[M][V]+B*r[M][V+1],r[M][V+1]=G*(r[M][V]+j)-r[M][V+1],r[M][V]=j}return 0}function x(){for(_=w-V,M=1;V>=M;M+=1)d[_]=d[w],w+=1,_+=1;return d[C+V]=d[C+V+1],h[V]=h[V+1],V+=1,g>V?797:0}function I(){return d[C+g]=d[C+g+1],d[C+g+1]=0,h[g]=0,g-=1,v[2]=v[2]+1,0}var M,A,w,_,$,V,S,T,R,O,C,D,L,k,j,P,F,U,q,B,G,Y,X,H,Q,W,K;L=Math.min(a,p),w=2*a+L*(L+5)/2+2*p+1,H=1e-60;do H+=H,Q=1+.1*H,W=1+.2*H;while(1>=Q||1>=W);for(M=1;a>=M;M+=1)d[M]=e[M];for(M=a+1;w>=M;M+=1)d[M]=0;for(M=1;p>=M;M+=1)h[M]=0;if($=[],0===y[1]){if(i(r,n,a,$),0!==$[1])return void(y[1]=2);u(r,n,a,e),t(r,n,a)}else{for(A=1;a>=A;A+=1)for(o[A]=0,M=1;A>=M;M+=1)o[A]=o[A]+r[M][A]*e[M];for(A=1;a>=A;A+=1)for(e[A]=0,M=A;a>=M;M+=1)e[A]=e[A]+r[A][M]*o[M]}for(s[1]=0,A=1;a>=A;A+=1)for(o[A]=e[A],s[1]=s[1]+d[A]*o[A],d[A]=0,M=A+1;a>=M;M+=1)r[M][A]=0;for(s[1]=-s[1]/2,y[1]=0,S=a,T=S+a,C=T+L,R=C+L+1,O=R+L*(L+1)/2,k=O+p,M=1;p>=M;M+=1){for(P=0,A=1;a>=A;A+=1)P+=f[A][M]*f[A][M];d[k+M]=Math.sqrt(P)}for(g=0,v[1]=0,v[2]=0,K=0;;){if(K=b(),999===K)return;for(;;){if(K=E(),0===K)break;if(999===K)return;if(700===K)if(V===g)I();else{for(;;)if(N(),K=x(),797!==K)break;I()}}}}function o(r,t,u,i,o,s){r=e(r),t=e(t),u=e(u);var f,l,c,p,m,h,g=[],v=[],d=[],y=[],b=[];if(o=o||0,s=s?e(s):[void 0,0],i=i?e(i):[],l=r.length-1,c=u[1].length-1,!i)for(f=1;c>=f;f+=1)i[f]=0;for(f=1;c>=f;f+=1)v[f]=0;for(p=0,m=Math.min(l,c),f=1;l>=f;f+=1)d[f]=0;for(g[1]=0,f=1;2*l+m*(m+5)/2+2*c+1>=f;f+=1)y[f]=0;for(f=1;2>=f;f+=1)b[f]=0;return a(r,t,l,l,d,g,u,i,l,c,o,v,p,b,y,s),h="",1===s[1]&&(h="constraints are inconsistent, no solution!"),2===s[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:n(d),value:n(g),unconstrained_solution:n(t),iterations:n(b),iact:n(v),message:h}}r.solveQP=o}(numeric),numeric.svd=function(r){function e(r,e){return r=Math.abs(r),e=Math.abs(e),r>e?r*Math.sqrt(1+e*e/r/r):0==e?r:e*Math.sqrt(1+r*r/e/e)}var n,t=numeric.epsilon,u=1e-64/t,i=50,a=0,o=0,s=0,f=0,l=0,c=numeric.clone(r),p=c.length,m=c[0].length;if(m>p)throw"Need more rows than columns";var h=new Array(m),g=new Array(m);for(o=0;m>o;o++)h[o]=g[o]=0;var v=numeric.rep([m,m],0),d=0,y=0,b=0,E=0,N=0,x=0,I=0;for(o=0;m>o;o++){for(h[o]=y,I=0,l=o+1,s=o;p>s;s++)I+=c[s][o]*c[s][o];if(u>=I)y=0;else for(d=c[o][o],y=Math.sqrt(I),d>=0&&(y=-y),b=d*y-I,c[o][o]=d-y,s=l;m>s;s++){for(I=0,f=o;p>f;f++)I+=c[f][o]*c[f][s];for(d=I/b,f=o;p>f;f++)c[f][s]+=d*c[f][o]}for(g[o]=y,I=0,s=l;m>s;s++)I+=c[o][s]*c[o][s];if(u>=I)y=0;else{for(d=c[o][o+1],y=Math.sqrt(I),d>=0&&(y=-y),b=d*y-I,c[o][o+1]=d-y,s=l;m>s;s++)h[s]=c[o][s]/b;for(s=l;p>s;s++){for(I=0,f=l;m>f;f++)I+=c[s][f]*c[o][f];for(f=l;m>f;f++)c[s][f]+=I*h[f]}}N=Math.abs(g[o])+Math.abs(h[o]),N>E&&(E=N)}for(o=m-1;-1!=o;o+=-1){if(0!=y){for(b=y*c[o][o+1],s=l;m>s;s++)v[s][o]=c[o][s]/b;for(s=l;m>s;s++){for(I=0,f=l;m>f;f++)I+=c[o][f]*v[f][s];for(f=l;m>f;f++)v[f][s]+=I*v[f][o]}}for(s=l;m>s;s++)v[o][s]=0,v[s][o]=0;v[o][o]=1,y=h[o],l=o}for(o=m-1;-1!=o;o+=-1){for(l=o+1,y=g[o],s=l;m>s;s++)c[o][s]=0;if(0!=y){for(b=c[o][o]*y,s=l;m>s;s++){for(I=0,f=l;p>f;f++)I+=c[f][o]*c[f][s];for(d=I/b,f=o;p>f;f++)c[f][s]+=d*c[f][o]}for(s=o;p>s;s++)c[s][o]=c[s][o]/y}else for(s=o;p>s;s++)c[s][o]=0;c[o][o]+=1}for(t*=E,f=m-1;-1!=f;f+=-1)for(var M=0;i>M;M++){var A=!1;for(l=f;-1!=l;l+=-1){if(Math.abs(h[l])<=t){A=!0;break}if(Math.abs(g[l-1])<=t)break}if(!A){a=0,I=1;var w=l-1;for(o=l;f+1>o&&(d=I*h[o],h[o]=a*h[o],!(Math.abs(d)<=t));o++)for(y=g[o],b=e(d,y),g[o]=b,a=y/b,I=-d/b,s=0;p>s;s++)N=c[s][w],x=c[s][o],c[s][w]=N*a+x*I,c[s][o]=-N*I+x*a}if(x=g[f],l==f){if(0>x)for(g[f]=-x,s=0;m>s;s++)v[s][f]=-v[s][f];break}if(M>=i-1)throw"Error: no convergence.";for(E=g[l],N=g[f-1],y=h[f-1],b=h[f],d=((N-x)*(N+x)+(y-b)*(y+b))/(2*b*N),y=e(d,1),d=0>d?((E-x)*(E+x)+b*(N/(d-y)-b))/E:((E-x)*(E+x)+b*(N/(d+y)-b))/E,a=1,I=1,o=l+1;f+1>o;o++){for(y=h[o],N=g[o],b=I*y,y=a*y,x=e(d,b),h[o-1]=x,a=d/x,I=b/x,d=E*a+y*I,y=-E*I+y*a,b=N*I,N*=a,s=0;m>s;s++)E=v[s][o-1],x=v[s][o],v[s][o-1]=E*a+x*I,v[s][o]=-E*I+x*a;for(x=e(d,b),g[o-1]=x,a=d/x,I=b/x,d=a*y+I*N,E=-I*y+a*N,s=0;p>s;s++)N=c[s][o-1],x=c[s][o],c[s][o-1]=N*a+x*I,c[s][o]=-N*I+x*a}h[l]=0,h[f]=d,g[f]=E}for(o=0;o<g.length;o++)g[o]<t&&(g[o]=0);for(o=0;m>o;o++)for(s=o-1;s>=0;s--)if(g[s]<g[o]){for(a=g[s],g[s]=g[o],g[o]=a,f=0;f<c.length;f++)n=c[f][o],c[f][o]=c[f][s],c[f][s]=n;for(f=0;f<v.length;f++)n=v[f][o],v[f][o]=v[f][s],v[f][s]=n;o=s}return{U:c,S:g,V:v}}}).call(exports,function(){return this}())},function(r,e,n){function t(r){return r&&r.reduce?r.reduce(function(r,e){var n=Array.isArray(r),t=Array.isArray(e);return n&&t?r.concat(e):n?(r.push(e),r):t?[r].concat(e):[r,e]}):r}function u(r){if(!r)return!1;for(var e=0;e<r.length;++e)if(Array.isArray(r[e]))return!1;return!0}var i=n(10);e.flatten=function(){for(var r=e.argsToArray.apply(null,arguments);!u(r);)r=t(r);return r},e.argsToArray=function(r){return Array.prototype.slice.call(r,0)},e.numbers=function(){var r=this.flatten.apply(null,arguments);return r.filter(function(r){return"number"==typeof r})},e.cleanFloat=function(r){var e=1e14;return Math.round(r*e)/e},e.parseBool=function(r){if("boolean"==typeof r)return r;if(r instanceof Error)return r;if("number"==typeof r)return 0!==r;if("string"==typeof r){var e=r.toUpperCase();if("TRUE"===e)return!0;if("FALSE"===e)return!1}return r instanceof Date&&!isNaN(r)?!0:i.value},e.parseNumber=function(r){return void 0===r||""===r?i.value:isNaN(r)?i.value:parseFloat(r)},e.parseNumberArray=function(r){var n;if(!r||0===(n=r.length))return i.value;for(var t;n--;){if(t=e.parseNumber(r[n]),t===i.value)return t;r[n]=t}return r},e.parseMatrix=function(r){var n;if(!r||0===(n=r.length))return i.value;for(var t,u=0;u<r.length;u++)if(t=e.parseNumberArray(r[u]),r[u]=t,t instanceof Error)return t;return r};var a=new Date(1900,0,1);e.parseDate=function(r){if(!isNaN(r)){if(r instanceof Date)return new Date(r);var e=parseInt(r,10);return 0>e?i.num:60>=e?new Date(a.getTime()+864e5*(e-1)):new Date(a.getTime()+864e5*(e-2))}return"string"!=typeof r||(r=new Date(r),isNaN(r))?i.value:r},e.parseDateArray=function(r){for(var e,n=r.length;n--;){if(e=this.parseDate(r[n]),e===i.value)return e;r[n]=e}return r},e.anyIsError=function(){for(var r=arguments.length;r--;)if(arguments[r]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(r){for(var e,n=r.length;n--;)if(e=r[n],"number"!=typeof e)if(e!==!0)if(e!==!1){if("string"==typeof e){var t=this.parseNumber(e);t instanceof Error?r[n]=0:r[n]=t}}else r[n]=0;else r[n]=1;return r},e.rest=function(r,e){return e=e||1,r&&"function"==typeof r.slice?r.slice(e):r},e.initial=function(r,e){return e=e||1,r&&"function"==typeof r.slice?r.slice(0,r.length-e):r}},function(r,e){e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA")},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(7),text=__webpack_require__(12),jStat=__webpack_require__(14).jStat,utils=__webpack_require__(9),error=__webpack_require__(10),misc=__webpack_require__(15),SQRT2PI=2.5066282746310002;exports.AVEDEV=function(){var r=utils.parseNumberArray(utils.flatten(arguments));return r instanceof Error?r:jStat.sum(jStat(r).subtract(jStat.mean(r)).abs()[0])/r.length},exports.AVERAGE=function(){for(var r=utils.numbers(utils.flatten(arguments)),e=r.length,n=0,t=0,u=0;e>u;u++)n+=r[u],t+=1;return n/t},exports.AVERAGEA=function(){for(var r=utils.flatten(arguments),e=r.length,n=0,t=0,u=0;e>u;u++){var i=r[u];"number"==typeof i&&(n+=i),i===!0&&n++,null!==i&&t++}return n/t},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=function(){for(var args=utils.argsToArray(arguments),criteria=(args.length-1)/2,range=utils.flatten(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;criteria>j;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},exports.BETA={},exports.BETA.DIST=function(r,e,n,t,u,i){return u=void 0===u?0:u,i=void 0===i?1:i,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),u=utils.parseNumber(u),i=utils.parseNumber(i),utils.anyIsError(r,e,n,u,i)?error.value:(r=(r-u)/(i-u),t?jStat.beta.cdf(r,e,n):jStat.beta.pdf(r,e,n))},exports.BETA.INV=function(r,e,n,t,u){return t=void 0===t?0:t,u=void 0===u?1:u,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),t=utils.parseNumber(t),u=utils.parseNumber(u),utils.anyIsError(r,e,n,t,u)?error.value:jStat.beta.inv(r,e,n)*(u-t)+t},exports.BINOM={},exports.BINOM.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(r,e,n,t)?error.value:t?jStat.binomial.cdf(r,e,n):jStat.binomial.pdf(r,e,n)},exports.BINOM.DIST.RANGE=function(r,e,n,t){if(t=void 0===t?n:t,r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(r,e,n,t))return error.value;for(var u=0,i=n;t>=i;i++)u+=mathTrig.COMBIN(r,i)*Math.pow(e,i)*Math.pow(1-e,r-i);return u},exports.BINOM.INV=function(r,e,n){if(r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;for(var t=0;r>=t;){if(jStat.binomial.cdf(t,r,e)>=n)return t;t++}},exports.CHISQ={},exports.CHISQ.DIST=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:n?jStat.chisquare.cdf(r,e):jStat.chisquare.pdf(r,e)},exports.CHISQ.DIST.RT=function(r,e){return!r|!e?error.na:1>r||e>Math.pow(10,10)?error.num:"number"!=typeof r||"number"!=typeof e?error.value:1-jStat.chisquare.cdf(r,e)},exports.CHISQ.INV=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:jStat.chisquare.inv(r,e)},exports.CHISQ.INV.RT=function(r,e){return!r|!e?error.na:0>r||r>1||1>e||e>Math.pow(10,10)?error.num:"number"!=typeof r||"number"!=typeof e?error.value:jStat.chisquare.inv(1-r,e)},exports.CHISQ.TEST=function(r,e){function n(r,e){var n=Math.exp(-.5*r);e%2===1&&(n*=Math.sqrt(2*r/l));for(var t=e;t>=2;)n=n*r/t,t-=2;for(var u=n,i=e;u>1e-10*n;)i+=2,u=u*r/i,n+=u;return 1-n}if(2!==arguments.length)return error.na;if(!(r instanceof Array&&e instanceof Array))return error.value;if(r.length!==e.length)return error.value;if(r[0]&&e[0]&&r[0].length!==e[0].length)return error.value;var t,u,i,a=r.length;for(u=0;a>u;u++)r[u]instanceof Array||(t=r[u],r[u]=[],r[u].push(t)),e[u]instanceof Array||(t=e[u],e[u]=[],e[u].push(t));var o=r[0].length,s=1===o?a-1:(a-1)*(o-1),f=0,l=Math.PI;for(u=0;a>u;u++)for(i=0;o>i;i++)f+=Math.pow(r[u][i]-e[u][i],2)/e[u][i];return Math.round(1e6*n(f,s))/1e6},exports.COLUMN=function(r,e){return 2!==arguments.length?error.na:0>e?error.num:r instanceof Array&&"number"==typeof e?0===r.length?void 0:jStat.col(r,e):error.value},exports.COLUMNS=function(r){return 1!==arguments.length?error.na:r instanceof Array?0===r.length?0:jStat.cols(r):error.value},exports.CONFIDENCE={},exports.CONFIDENCE.NORM=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:jStat.normalci(1,r,e,n)[1]-1},exports.CONFIDENCE.T=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:jStat.tci(1,r,e,n)[1]-1},exports.CORREL=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e)?error.value:jStat.corrcoeff(r,e)},exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var r=utils.flatten(arguments);return r.length-exports.COUNTBLANK(r)},exports.COUNTIN=function(r,e){for(var n=0,t=0;t<r.length;t++)r[t]===e&&n++;return n},exports.COUNTBLANK=function(){for(var r,e=utils.flatten(arguments),n=0,t=0;t<e.length;t++)r=e[t],(null===r||""===r)&&n++;return n},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!=typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length},exports.COVARIANCE={},exports.COVARIANCE.P=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=jStat.mean(r),t=jStat.mean(e),u=0,i=r.length,a=0;i>a;a++)u+=(r[a]-n)*(e[a]-t);return u/i},exports.COVARIANCE.S=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e)?error.value:jStat.covariance(r,e)},exports.DEVSQ=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=jStat.mean(r),n=0,t=0;t<r.length;t++)n+=Math.pow(r[t]-e,2);return n},exports.EXPON={},exports.EXPON.DIST=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:n?jStat.exponential.cdf(r,e):jStat.exponential.pdf(r,e)},exports.F={},exports.F.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:t?jStat.centralF.cdf(r,e,n):jStat.centralF.pdf(r,e,n)},exports.F.DIST.RT=function(r,e,n){return 3!==arguments.length?error.na:0>r||1>e||1>n?error.num:"number"!=typeof r||"number"!=typeof e||"number"!=typeof n?error.value:1-jStat.centralF.cdf(r,e,n)},exports.F.INV=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:0>=r||r>1?error.num:jStat.centralF.inv(r,e,n)},exports.F.INV.RT=function(r,e,n){return 3!==arguments.length?error.na:0>r||r>1||1>e||e>Math.pow(10,10)||1>n||n>Math.pow(10,10)?error.num:"number"!=typeof r||"number"!=typeof e||"number"!=typeof n?error.value:jStat.centralF.inv(1-r,e,n)},exports.F.TEST=function(r,e){if(!r||!e)return error.na;if(!(r instanceof Array&&e instanceof Array))return error.na;if(r.length<2||e.length<2)return error.div0;var n=function(r,e){for(var n=0,t=0;t<r.length;t++)n+=Math.pow(r[t]-e,2);return n},t=mathTrig.SUM(r)/r.length,u=mathTrig.SUM(e)/e.length,i=n(r,t)/(r.length-1),a=n(e,u)/(e.length-1);return i/a},exports.FISHER=function(r){return r=utils.parseNumber(r),r instanceof Error?r:Math.log((1+r)/(1-r))/2},exports.FISHERINV=function(r){if(r=utils.parseNumber(r),r instanceof Error)return r;var e=Math.exp(2*r);return(e-1)/(e+1)},exports.FORECAST=function(r,e,n){if(r=utils.parseNumber(r),e=utils.parseNumberArray(utils.flatten(e)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(r,e,n))return error.value;for(var t=jStat.mean(n),u=jStat.mean(e),i=n.length,a=0,o=0,s=0;i>s;s++)a+=(n[s]-t)*(e[s]-u),o+=Math.pow(n[s]-t,2);var f=a/o,l=u-f*t;return l+f*r},exports.FREQUENCY=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=r.length,t=e.length,u=[],i=0;t>=i;i++){u[i]=0;for(var a=0;n>a;a++)0===i?r[a]<=e[0]&&(u[0]+=1):t>i?r[a]>e[i-1]&&r[a]<=e[i]&&(u[i]+=1):i===t&&r[a]>e[t-1]&&(u[t]+=1)}return u},exports.GAMMA=function(r){return r=utils.parseNumber(r),r instanceof Error?r:0===r?error.num:parseInt(r,10)===r&&0>r?error.num:jStat.gammafn(r)},exports.GAMMA.DIST=function(r,e,n,t){return 4!==arguments.length?error.na:0>r||0>=e||0>=n?error.value:"number"!=typeof r||"number"!=typeof e||"number"!=typeof n?error.value:t?jStat.gamma.cdf(r,e,n,!0):jStat.gamma.pdf(r,e,n,!1)},exports.GAMMA.INV=function(r,e,n){return 3!==arguments.length?error.na:0>r||r>1||0>=e||0>=n?error.num:"number"!=typeof r||"number"!=typeof e||"number"!=typeof n?error.value:jStat.gamma.inv(r,e,n)},exports.GAMMALN=function(r){return r=utils.parseNumber(r),r instanceof Error?r:jStat.gammaln(r)},exports.GAMMALN.PRECISE=function(r){return 1!==arguments.length?error.na:0>=r?error.num:"number"!=typeof r?error.value:jStat.gammaln(r)},exports.GAUSS=function(r){return r=utils.parseNumber(r),r instanceof Error?r:jStat.normal.cdf(r,0,1)-.5},exports.GEOMEAN=function(){var r=utils.parseNumberArray(utils.flatten(arguments));return r instanceof Error?r:jStat.geomean(r)},exports.GROWTH=function(r,e,n,t){if(r=utils.parseNumberArray(r),r instanceof Error)return r;var u;if(void 0===e)for(e=[],u=1;u<=r.length;u++)e.push(u);if(void 0===n)for(n=[],u=1;u<=r.length;u++)n.push(u);if(e=utils.parseNumberArray(e),n=utils.parseNumberArray(n),utils.anyIsError(e,n))return error.value;void 0===t&&(t=!0);var i=r.length,a=0,o=0,s=0,f=0;for(u=0;i>u;u++){var l=e[u],c=Math.log(r[u]);a+=l,o+=c,s+=l*c,f+=l*l}a/=i,o/=i,s/=i,f/=i;var p,m;t?(p=(s-a*o)/(f-a*a),m=o-p*a):(p=s/f,m=0);var h=[];for(u=0;u<n.length;u++)h.push(Math.exp(m+p*n[u]));return h},exports.HARMEAN=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=r.length,n=0,t=0;e>t;t++)n+=1/r[t];return e/n},exports.HYPGEOM={},exports.HYPGEOM.DIST=function(r,e,n,t,u){function i(r,e,n,t){return mathTrig.COMBIN(n,r)*mathTrig.COMBIN(t-n,e-r)/mathTrig.COMBIN(t,e)}function a(r,e,n,t){for(var u=0,a=0;r>=a;a++)u+=i(a,e,n,t);return u}return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(r,e,n,t)?error.value:u?a(r,e,n,t):i(r,e,n,t)},exports.INTERCEPT=function(r,e){return r=utils.parseNumberArray(r),e=utils.parseNumberArray(e),utils.anyIsError(r,e)?error.value:r.length!==e.length?error.na:exports.FORECAST(0,r,e)},exports.KURT=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=jStat.mean(r),n=r.length,t=0,u=0;n>u;u++)t+=Math.pow(r[u]-e,4);return t/=Math.pow(jStat.stdev(r,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*t-3*(n-1)*(n-1)/((n-2)*(n-3))},exports.LARGE=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e)?r:r.sort(function(r,e){return e-r})[e-1];
},exports.LINEST=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=jStat.mean(r),t=jStat.mean(e),u=e.length,i=0,a=0,o=0;u>o;o++)i+=(e[o]-t)*(r[o]-n),a+=Math.pow(e[o]-t,2);var s=i/a,f=n-s*t;return[s,f]},exports.LOGEST=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=0;n<r.length;n++)r[n]=Math.log(r[n]);var t=exports.LINEST(r,e);return t[0]=Math.round(1e6*Math.exp(t[0]))/1e6,t[1]=Math.round(1e6*Math.exp(t[1]))/1e6,t},exports.LOGNORM={},exports.LOGNORM.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:t?jStat.lognormal.cdf(r,e,n):jStat.lognormal.pdf(r,e,n)},exports.LOGNORM.INV=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:jStat.lognormal.inv(r,e,n)},exports.MAX=function(){var r=utils.numbers(utils.flatten(arguments));return 0===r.length?0:Math.max.apply(Math,r)},exports.MAXA=function(){var r=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===r.length?0:Math.max.apply(Math,r)},exports.MEDIAN=function(){var r=utils.arrayValuesToNumbers(utils.flatten(arguments));return jStat.median(r)},exports.MIN=function(){var r=utils.numbers(utils.flatten(arguments));return 0===r.length?0:Math.min.apply(Math,r)},exports.MINA=function(){var r=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===r.length?0:Math.min.apply(Math,r)},exports.MODE={},exports.MODE.MULT=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e,n=r.length,t={},u=[],i=0,a=0;n>a;a++)e=r[a],t[e]=t[e]?t[e]+1:1,t[e]>i&&(i=t[e],u=[]),t[e]===i&&(u[u.length]=e);return u},exports.MODE.SNGL=function(){var r=utils.parseNumberArray(utils.flatten(arguments));return r instanceof Error?r:exports.MODE.MULT(r).sort(function(r,e){return r-e})[0]},exports.NEGBINOM={},exports.NEGBINOM.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:t?jStat.negbin.cdf(r,e,n):jStat.negbin.pdf(r,e,n)},exports.NORM={},exports.NORM.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:0>=n?error.num:t?jStat.normal.cdf(r,e,n):jStat.normal.pdf(r,e,n)},exports.NORM.INV=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:jStat.normal.inv(r,e,n)},exports.NORM.S={},exports.NORM.S.DIST=function(r,e){return r=utils.parseNumber(r),r instanceof Error?error.value:e?jStat.normal.cdf(r,0,1):jStat.normal.pdf(r,0,1)},exports.NORM.S.INV=function(r){return r=utils.parseNumber(r),r instanceof Error?error.value:jStat.normal.inv(r,0,1)},exports.PEARSON=function(r,e){if(e=utils.parseNumberArray(utils.flatten(e)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(e,r))return error.value;for(var n=jStat.mean(r),t=jStat.mean(e),u=r.length,i=0,a=0,o=0,s=0;u>s;s++)i+=(r[s]-n)*(e[s]-t),a+=Math.pow(r[s]-n,2),o+=Math.pow(e[s]-t,2);return i/Math.sqrt(a*o)},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;r=r.sort(function(r,e){return r-e});var n=r.length;if(1/(n+1)>e||e>1-1/(n+1))return error.num;var t=e*(n+1)-1,u=Math.floor(t);return utils.cleanFloat(t===u?r[t]:r[u]+(t-u)*(r[u+1]-r[u]))},exports.PERCENTILE.INC=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;r=r.sort(function(r,e){return r-e});var n=r.length,t=e*(n-1),u=Math.floor(t);return utils.cleanFloat(t===u?r[t]:r[u]+(t-u)*(r[u+1]-r[u]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(r,e,n){if(n=void 0===n?3:n,r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;r=r.sort(function(r,e){return r-e});for(var t=misc.UNIQUE.apply(null,r),u=r.length,i=t.length,a=Math.pow(10,n),o=0,s=!1,f=0;!s&&i>f;)e===t[f]?(o=(r.indexOf(t[f])+1)/(u+1),s=!0):e>=t[f]&&(e<t[f+1]||f===i-1)&&(o=(r.indexOf(t[f])+1+(e-t[f])/(t[f+1]-t[f]))/(u+1),s=!0),f++;return Math.floor(o*a)/a},exports.PERCENTRANK.INC=function(r,e,n){if(n=void 0===n?3:n,r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n))return error.value;r=r.sort(function(r,e){return r-e});for(var t=misc.UNIQUE.apply(null,r),u=r.length,i=t.length,a=Math.pow(10,n),o=0,s=!1,f=0;!s&&i>f;)e===t[f]?(o=r.indexOf(t[f])/(u-1),s=!0):e>=t[f]&&(e<t[f+1]||f===i-1)&&(o=(r.indexOf(t[f])+(e-t[f])/(t[f+1]-t[f]))/(u-1),s=!0),f++;return Math.floor(o*a)/a},exports.PERMUT=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:mathTrig.FACT(r)/mathTrig.FACT(r-e)},exports.PERMUTATIONA=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:Math.pow(r,e)},exports.PHI=function(r){return r=utils.parseNumber(r),r instanceof Error?error.value:Math.exp(-.5*r*r)/SQRT2PI},exports.POISSON={},exports.POISSON.DIST=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:n?jStat.poisson.cdf(r,e):jStat.poisson.pdf(r,e)},exports.PROB=function(r,e,n,t){if(void 0===n)return 0;if(t=void 0===t?n:t,r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),n=utils.parseNumber(n),t=utils.parseNumber(t),utils.anyIsError(r,e,n,t))return error.value;if(n===t)return r.indexOf(n)>=0?e[r.indexOf(n)]:0;for(var u=r.sort(function(r,e){return r-e}),i=u.length,a=0,o=0;i>o;o++)u[o]>=n&&u[o]<=t&&(a+=e[r.indexOf(u[o])]);return a},exports.QUARTILE={},exports.QUARTILE.EXC=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;switch(e){case 1:return exports.PERCENTILE.EXC(r,.25);case 2:return exports.PERCENTILE.EXC(r,.5);case 3:return exports.PERCENTILE.EXC(r,.75);default:return error.num}},exports.QUARTILE.INC=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;switch(e){case 1:return exports.PERCENTILE.INC(r,.25);case 2:return exports.PERCENTILE.INC(r,.5);case 3:return exports.PERCENTILE.INC(r,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(r,e,n){if(r=utils.parseNumber(r),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;e=utils.flatten(e),n=n||!1;var t=n?function(r,e){return r-e}:function(r,e){return e-r};e=e.sort(t);for(var u=e.length,i=0,a=0;u>a;a++)e[a]===r&&i++;return i>1?(2*e.indexOf(r)+i+1)/2:e.indexOf(r)+1},exports.RANK.EQ=function(r,e,n){if(r=utils.parseNumber(r),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;n=n||!1;var t=n?function(r,e){return r-e}:function(r,e){return e-r};return e=e.sort(t),e.indexOf(r)+1},exports.ROW=function(r,e){return 2!==arguments.length?error.na:0>e?error.num:r instanceof Array&&"number"==typeof e?0===r.length?void 0:jStat.row(r,e):error.value},exports.ROWS=function(r){return 1!==arguments.length?error.na:r instanceof Array?0===r.length?0:jStat.rows(r):error.value},exports.RSQ=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e)?error.value:Math.pow(exports.PEARSON(r,e),2)},exports.SKEW=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=jStat.mean(r),n=r.length,t=0,u=0;n>u;u++)t+=Math.pow(r[u]-e,3);return n*t/((n-1)*(n-2)*Math.pow(jStat.stdev(r,!0),3))},exports.SKEW.P=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var e=jStat.mean(r),n=r.length,t=0,u=0,i=0;n>i;i++)u+=Math.pow(r[i]-e,3),t+=Math.pow(r[i]-e,2);return u/=n,t/=n,u/Math.pow(t,1.5)},exports.SLOPE=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=jStat.mean(e),t=jStat.mean(r),u=e.length,i=0,a=0,o=0;u>o;o++)i+=(e[o]-n)*(r[o]-t),a+=Math.pow(e[o]-n,2);return i/a},exports.SMALL=function(r,e){return r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e)?r:r.sort(function(r,e){return r-e})[e-1]},exports.STANDARDIZE=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:(r-e)/n},exports.STDEV={},exports.STDEV.P=function(){var r=exports.VAR.P.apply(this,arguments);return Math.sqrt(r)},exports.STDEV.S=function(){var r=exports.VAR.S.apply(this,arguments);return Math.sqrt(r)},exports.STDEVA=function(){var r=exports.VARA.apply(this,arguments);return Math.sqrt(r)},exports.STDEVPA=function(){var r=exports.VARPA.apply(this,arguments);return Math.sqrt(r)},exports.STEYX=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;for(var n=jStat.mean(e),t=jStat.mean(r),u=e.length,i=0,a=0,o=0,s=0;u>s;s++)i+=Math.pow(r[s]-t,2),a+=(e[s]-n)*(r[s]-t),o+=Math.pow(e[s]-n,2);return Math.sqrt((i-a*a/o)/(u-2))},exports.TRANSPOSE=function(r){return r?jStat.transpose(r):error.na},exports.T=text.T,exports.T.DIST=function(r,e,n){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:n?jStat.studentt.cdf(r,e):jStat.studentt.pdf(r,e)},exports.T.DIST["2T"]=function(r,e){return 2!==arguments.length?error.na:0>r||1>e?error.num:"number"!=typeof r||"number"!=typeof e?error.value:2*(1-jStat.studentt.cdf(r,e))},exports.T.DIST.RT=function(r,e){return 2!==arguments.length?error.na:0>r||1>e?error.num:"number"!=typeof r||"number"!=typeof e?error.value:1-jStat.studentt.cdf(r,e)},exports.T.INV=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),utils.anyIsError(r,e)?error.value:jStat.studentt.inv(r,e)},exports.T.INV["2T"]=function(r,e){return r=utils.parseNumber(r),e=utils.parseNumber(e),0>=r||r>1||1>e?error.num:utils.anyIsError(r,e)?error.value:Math.abs(jStat.studentt.inv(r/2,e))},exports.T.TEST=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(r,e))return error.value;var n,t=jStat.mean(r),u=jStat.mean(e),i=0,a=0;for(n=0;n<r.length;n++)i+=Math.pow(r[n]-t,2);for(n=0;n<e.length;n++)a+=Math.pow(e[n]-u,2);i/=r.length-1,a/=e.length-1;var o=Math.abs(t-u)/Math.sqrt(i/r.length+a/e.length);return exports.T.DIST["2T"](o,r.length+e.length-2)},exports.TREND=function(r,e,n){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumberArray(utils.flatten(e)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(r,e,n))return error.value;var t=exports.LINEST(r,e),u=t[0],i=t[1],a=[];return n.forEach(function(r){a.push(u*r+i)}),a},exports.TRIMMEAN=function(r,e){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;var n=mathTrig.FLOOR(r.length*e,2)/2;return jStat.mean(utils.initial(utils.rest(r.sort(function(r,e){return r-e}),n),n))},exports.VAR={},exports.VAR.P=function(){for(var r=utils.numbers(utils.flatten(arguments)),e=r.length,n=0,t=exports.AVERAGE(r),u=0;e>u;u++)n+=Math.pow(r[u]-t,2);return n/e},exports.VAR.S=function(){for(var r=utils.numbers(utils.flatten(arguments)),e=r.length,n=0,t=exports.AVERAGE(r),u=0;e>u;u++)n+=Math.pow(r[u]-t,2);return n/(e-1)},exports.VARA=function(){for(var r=utils.flatten(arguments),e=r.length,n=0,t=0,u=exports.AVERAGEA(r),i=0;e>i;i++){var a=r[i];n+="number"==typeof a?Math.pow(a-u,2):a===!0?Math.pow(1-u,2):Math.pow(0-u,2),null!==a&&t++}return n/(t-1)},exports.VARPA=function(){for(var r=utils.flatten(arguments),e=r.length,n=0,t=0,u=exports.AVERAGEA(r),i=0;e>i;i++){var a=r[i];n+="number"==typeof a?Math.pow(a-u,2):a===!0?Math.pow(1-u,2):Math.pow(0-u,2),null!==a&&t++}return n/t},exports.WEIBULL={},exports.WEIBULL.DIST=function(r,e,n,t){return r=utils.parseNumber(r),e=utils.parseNumber(e),n=utils.parseNumber(n),utils.anyIsError(r,e,n)?error.value:t?1-Math.exp(-Math.pow(r/n,e)):Math.pow(r,e-1)*Math.exp(-Math.pow(r/n,e))*e/Math.pow(n,e)},exports.Z={},exports.Z.TEST=function(r,e,n){if(r=utils.parseNumberArray(utils.flatten(r)),e=utils.parseNumber(e),utils.anyIsError(r,e))return error.value;n=n||exports.STDEV.S(r);var t=r.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(r)-e)/(n/Math.sqrt(t)),!0)}},function(r,e,n){var t=n(9),u=n(10),i=n(13);e.ASC=function(){throw new Error("ASC is not implemented")},e.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},e.CHAR=function(r){return r=t.parseNumber(r),r instanceof Error?r:String.fromCharCode(r)},e.CLEAN=function(r){r=r||"";var e=/[\0-\x1F]/g;return r.replace(e,"")},e.CODE=function(r){return r=r||"",r.charCodeAt(0)},e.CONCATENATE=function(){for(var r=t.flatten(arguments),e=0;(e=r.indexOf(!0))>-1;)r[e]="TRUE";for(var n=0;(n=r.indexOf(!1))>-1;)r[n]="FALSE";return r.join("")},e.DBCS=function(){throw new Error("DBCS is not implemented")},e.DOLLAR=function(r,e){if(e=void 0===e?2:e,r=t.parseNumber(r),e=t.parseNumber(e),t.anyIsError(r,e))return u.value;var n="";return 0>=e?(r=Math.round(r*Math.pow(10,e))/Math.pow(10,e),n="($0,0)"):e>0&&(n="($0,0."+new Array(e+1).join("0")+")"),i(r).format(n)},e.EXACT=function(r,e){return r===e},e.FIND=function(r,e,n){return n=void 0===n?0:n,e?e.indexOf(r,n-1)+1:null},e.FIXED=function(r,e,n){if(e=void 0===e?2:e,n=void 0===n?!1:n,r=t.parseNumber(r),e=t.parseNumber(e),t.anyIsError(r,e))return u.value;var a=n?"0":"0,0";return 0>=e?r=Math.round(r*Math.pow(10,e))/Math.pow(10,e):e>0&&(a+="."+new Array(e+1).join("0")),i(r).format(a)},e.HTML2TEXT=function(r){var e="";return r&&(r instanceof Array?r.forEach(function(r){""!==e&&(e+="\n"),e+=r.replace(/<(?:.|\n)*?>/gm,"")}):e=r.replace(/<(?:.|\n)*?>/gm,"")),e},e.LEFT=function(r,e){return e=void 0===e?1:e,e=t.parseNumber(e),e instanceof Error||"string"!=typeof r?u.value:r?r.substring(0,e):null},e.LEN=function(r){return 0===arguments.length?u.error:"string"==typeof r?r?r.length:0:r.length?r.length:u.value},e.LOWER=function(r){return"string"!=typeof r?u.value:r?r.toLowerCase():r},e.MID=function(r,e,n){return e=t.parseNumber(e),n=t.parseNumber(n),t.anyIsError(e,n)||"string"!=typeof r?n:r.substring(e-1,n)},e.NUMBERVALUE=function(r,e,n){return e="undefined"==typeof e?".":e,n="undefined"==typeof n?",":n,Number(r.replace(e,".").replace(n,""))},e.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},e.PROPER=function(r){return void 0===r||0===r.length?u.value:(r===!0&&(r="TRUE"),r===!1&&(r="FALSE"),isNaN(r)&&"number"==typeof r?u.value:("number"==typeof r&&(r=""+r),r.replace(/\w\S*/g,function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()})))},e.REGEXEXTRACT=function(r,e){var n=r.match(new RegExp(e));return n?n[n.length>1?n.length-1:0]:null},e.REGEXMATCH=function(r,e,n){var t=r.match(new RegExp(e));return n?t:!!t},e.REGEXREPLACE=function(r,e,n){return r.replace(new RegExp(e),n)},e.REPLACE=function(r,e,n,i){return e=t.parseNumber(e),n=t.parseNumber(n),t.anyIsError(e,n)||"string"!=typeof r||"string"!=typeof i?u.value:r.substr(0,e-1)+i+r.substr(e-1+n)},e.REPT=function(r,e){return e=t.parseNumber(e),e instanceof Error?e:new Array(e+1).join(r)},e.RIGHT=function(r,e){return e=void 0===e?1:e,e=t.parseNumber(e),e instanceof Error?e:r?r.substring(r.length-e):null},e.SEARCH=function(r,e,n){var t;return"string"!=typeof r||"string"!=typeof e?u.value:(n=void 0===n?0:n,t=e.toLowerCase().indexOf(r.toLowerCase(),n-1)+1,0===t?u.value:t)},e.SPLIT=function(r,e){return r.split(e)},e.SUBSTITUTE=function(r,e,n,t){if(!(r&&e&&n))return r;if(void 0===t)return r.replace(new RegExp(e,"g"),n);for(var u=0,i=0;r.indexOf(e,u)>0;)if(u=r.indexOf(e,u+1),i++,i===t)return r.substring(0,u)+n+r.substring(u+e.length)},e.T=function(r){return"string"==typeof r?r:""},e.TEXT=function(r,e){return r=t.parseNumber(r),t.anyIsError(r)?u.na:i(r).format(e)},e.TRIM=function(r){return"string"!=typeof r?u.value:r.replace(/ +/g," ").trim()},e.UNICHAR=this.CHAR,e.UNICODE=this.CODE,e.UPPER=function(r){return"string"!=typeof r?u.value:r.toUpperCase()},e.VALUE=function(r){return"string"!=typeof r?u.value:i().unformat(r)}},function(r,e,n){var t,u;/*!
	 * numeral.js
	 * version : 1.5.3
	 * author : Adam Draper
	 * license : MIT
	 * http://adamwdraper.github.com/Numeral-js/
	 */
(function(){function n(r){this._value=r}function i(r,e,n,t){var u,i,a=Math.pow(10,e);return i=(n(r*a)/a).toFixed(e),t&&(u=new RegExp("0{1,"+t+"}$"),i=i.replace(u,"")),i}function a(r,e,n){var t;return t=e.indexOf("$")>-1?s(r,e,n):e.indexOf("%")>-1?f(r,e,n):e.indexOf(":")>-1?l(r,e):p(r._value,e,n)}function o(r,e){var n,t,u,i,a,o=e,s=["KB","MB","GB","TB","PB","EB","ZB","YB"],f=!1;if(e.indexOf(":")>-1)r._value=c(e);else if(e===E)r._value=0;else{for("."!==y[b].delimiters.decimal&&(e=e.replace(/\./g,"").replace(y[b].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+y[b].abbreviations.thousand+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),t=new RegExp("[^a-zA-Z]"+y[b].abbreviations.million+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),u=new RegExp("[^a-zA-Z]"+y[b].abbreviations.billion+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+y[b].abbreviations.trillion+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),a=0;a<=s.length&&!(f=e.indexOf(s[a])>-1?Math.pow(1024,a+1):!1);a++);r._value=(f?f:1)*(o.match(n)?Math.pow(10,3):1)*(o.match(t)?Math.pow(10,6):1)*(o.match(u)?Math.pow(10,9):1)*(o.match(i)?Math.pow(10,12):1)*(e.indexOf("%")>-1?.01:1)*((e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1)*Number(e.replace(/[^0-9\.]+/g,"")),r._value=f?Math.ceil(r._value):r._value}return r._value}function s(r,e,n){var t,u,i=e.indexOf("$"),a=e.indexOf("("),o=e.indexOf("-"),s="";return e.indexOf(" $")>-1?(s=" ",e=e.replace(" $","")):e.indexOf("$ ")>-1?(s=" ",e=e.replace("$ ","")):e=e.replace("$",""),u=p(r._value,e,n),1>=i?u.indexOf("(")>-1||u.indexOf("-")>-1?(u=u.split(""),t=1,(a>i||o>i)&&(t=0),u.splice(t,0,y[b].currency.symbol+s),u=u.join("")):u=y[b].currency.symbol+s+u:u.indexOf(")")>-1?(u=u.split(""),u.splice(-1,0,s+y[b].currency.symbol),u=u.join("")):u=u+s+y[b].currency.symbol,u}function f(r,e,n){var t,u="",i=100*r._value;return e.indexOf(" %")>-1?(u=" ",e=e.replace(" %","")):e=e.replace("%",""),t=p(i,e,n),t.indexOf(")")>-1?(t=t.split(""),t.splice(-1,0,u+"%"),t=t.join("")):t=t+u+"%",t}function l(r){var e=Math.floor(r._value/60/60),n=Math.floor((r._value-60*e*60)/60),t=Math.round(r._value-60*e*60-60*n);return e+":"+(10>n?"0"+n:n)+":"+(10>t?"0"+t:t)}function c(r){var e=r.split(":"),n=0;return 3===e.length?(n+=60*Number(e[0])*60,n+=60*Number(e[1]),n+=Number(e[2])):2===e.length&&(n+=60*Number(e[0]),n+=Number(e[1])),Number(n)}function p(r,e,n){var t,u,a,o,s,f,l=!1,c=!1,p=!1,m="",h=!1,g=!1,v=!1,d=!1,N=!1,x="",I="",M=Math.abs(r),A=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],w="",_=!1;if(0===r&&null!==E)return E;if(e.indexOf("(")>-1?(l=!0,e=e.slice(1,-1)):e.indexOf("+")>-1&&(c=!0,e=e.replace(/\+/g,"")),e.indexOf("a")>-1&&(h=e.indexOf("aK")>=0,g=e.indexOf("aM")>=0,v=e.indexOf("aB")>=0,d=e.indexOf("aT")>=0,N=h||g||v||d,e.indexOf(" a")>-1?(m=" ",e=e.replace(" a","")):e=e.replace("a",""),M>=Math.pow(10,12)&&!N||d?(m+=y[b].abbreviations.trillion,r/=Math.pow(10,12)):M<Math.pow(10,12)&&M>=Math.pow(10,9)&&!N||v?(m+=y[b].abbreviations.billion,r/=Math.pow(10,9)):M<Math.pow(10,9)&&M>=Math.pow(10,6)&&!N||g?(m+=y[b].abbreviations.million,r/=Math.pow(10,6)):(M<Math.pow(10,6)&&M>=Math.pow(10,3)&&!N||h)&&(m+=y[b].abbreviations.thousand,r/=Math.pow(10,3))),e.indexOf("b")>-1)for(e.indexOf(" b")>-1?(x=" ",e=e.replace(" b","")):e=e.replace("b",""),a=0;a<=A.length;a++)if(t=Math.pow(1024,a),u=Math.pow(1024,a+1),r>=t&&u>r){x+=A[a],t>0&&(r/=t);break}return e.indexOf("o")>-1&&(e.indexOf(" o")>-1?(I=" ",e=e.replace(" o","")):e=e.replace("o",""),I+=y[b].ordinal(r)),e.indexOf("[.]")>-1&&(p=!0,e=e.replace("[.]",".")),o=r.toString().split(".")[0],s=e.split(".")[1],f=e.indexOf(","),s?(s.indexOf("[")>-1?(s=s.replace("]",""),s=s.split("["),w=i(r,s[0].length+s[1].length,n,s[1].length)):w=i(r,s.length,n),o=w.split(".")[0],w=w.split(".")[1].length?y[b].delimiters.decimal+w.split(".")[1]:"",p&&0===Number(w.slice(1))&&(w="")):o=i(r,null,n),o.indexOf("-")>-1&&(o=o.slice(1),_=!0),f>-1&&(o=o.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+y[b].delimiters.thousands)),0===e.indexOf(".")&&(o=""),(l&&_?"(":"")+(!l&&_?"-":"")+(!_&&c?"+":"")+o+w+(I?I:"")+(m?m:"")+(x?x:"")+(l&&_?")":"")}function m(r,e){y[r]=e}function h(r){var e=r.toString().split(".");return e.length<2?1:Math.pow(10,e[1].length)}function g(){var r=Array.prototype.slice.call(arguments);return r.reduce(function(r,e){var n=h(r),t=h(e);return n>t?n:t},-(1/0))}var v,d="1.5.3",y={},b="en",E=null,N="0,0",x="undefined"!=typeof r&&r.exports;v=function(r){return v.isNumeral(r)?r=r.value():0===r||"undefined"==typeof r?r=0:Number(r)||(r=v.fn.unformat(r)),new n(Number(r))},v.version=d,v.isNumeral=function(r){return r instanceof n},v.language=function(r,e){if(!r)return b;if(r&&!e){if(!y[r])throw new Error("Unknown language : "+r);b=r}return(e||!y[r])&&m(r,e),v},v.languageData=function(r){if(!r)return y[b];if(!y[r])throw new Error("Unknown language : "+r);return y[r]},v.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(r){var e=r%10;return 1===~~(r%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$"}}),v.zeroFormat=function(r){E="string"==typeof r?r:null},v.defaultFormat=function(r){N="string"==typeof r?r:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(r,e){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof r)throw new TypeError(r+" is not a function");var n,t,u=this.length>>>0,i=!1;for(1<arguments.length&&(t=e,i=!0),n=0;u>n;++n)this.hasOwnProperty(n)&&(i?t=r(t,this[n],n,this):(t=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return t}),v.fn=n.prototype={clone:function(){return v(this)},format:function(r,e){return a(this,r?r:N,void 0!==e?e:Math.round)},unformat:function(r){return"[object Number]"===Object.prototype.toString.call(r)?r:o(this,r?r:N)},value:function(){return this._value},valueOf:function(){return this._value},set:function(r){return this._value=Number(r),this},add:function(r){function e(r,e,t,u){return r+n*e}var n=g.call(null,this._value,r);return this._value=[this._value,r].reduce(e,0)/n,this},subtract:function(r){function e(r,e,t,u){return r-n*e}var n=g.call(null,this._value,r);return this._value=[r].reduce(e,this._value*n)/n,this},multiply:function(r){function e(r,e,n,t){var u=g(r,e);return r*u*(e*u)/(u*u)}return this._value=[this._value,r].reduce(e,1),this},divide:function(r){function e(r,e,n,t){var u=g(r,e);return r*u/(e*u)}return this._value=[this._value,r].reduce(e),this},difference:function(r){return Math.abs(v(this._value).subtract(r).value())}},x&&(r.exports=v),"undefined"==typeof ender&&(this.numeral=v),t=[],u=function(){return v}.apply(e,t),!(void 0!==u&&(r.exports=u))}).call(this)},function(r,e){this.j$=this.jStat=function(r,e){function n(e,n){var t=e>n?e:n;return r.pow(10,17-~~(r.log(t>0?t:-t)*r.LOG10E))}function t(r){return"[object Function]"===p.call(r)}function u(r){return"number"==typeof r&&r===r}function i(r){return l.apply([],r)}function a(){return new a._init(arguments)}function o(){return 0}function s(){return 1}function f(r,e){return r===e?1:0}var l=Array.prototype.concat,c=Array.prototype.slice,p=Object.prototype.toString,m=Array.isArray||function(r){return"[object Array]"===p.call(r)};a.fn=a.prototype,a._init=function(r){var e;if(m(r[0]))if(m(r[0][0])){for(t(r[1])&&(r[0]=a.map(r[0],r[1])),e=0;e<r[0].length;e++)this[e]=r[0][e];this.length=r[0].length}else this[0]=t(r[1])?a.map(r[0],r[1]):r[0],this.length=1;else if(u(r[0]))this[0]=a.seq.apply(null,r),this.length=1;else{if(r[0]instanceof a)return a(r[0].toArray());this[0]=[],this.length=1}return this},a._init.prototype=a.prototype,a._init.constructor=a,a.utils={calcRdx:n,isArray:m,isFunction:t,isNumber:u,toVector:i},a.extend=function(r){var e,n;if(1===arguments.length){for(n in r)a[n]=r[n];return this}for(e=1;e<arguments.length;e++)for(n in arguments[e])r[n]=arguments[e][n];return r},a.rows=function(r){return r.length||1},a.cols=function(r){return r[0].length||1},a.dimensions=function(r){return{rows:a.rows(r),cols:a.cols(r)}},a.row=function(r,e){return r[e]},a.col=function(r,e){for(var n=new Array(r.length),t=0;t<r.length;t++)n[t]=[r[t][e]];return n},a.diag=function(r){for(var e=a.rows(r),n=new Array(e),t=0;e>t;t++)n[t]=[r[t][t]];return n},a.antidiag=function(r){for(var e=a.rows(r)-1,n=new Array(e),t=0;e>=0;e--,t++)n[t]=[r[t][e]];return n},a.transpose=function(r){var e,n,t,u,i,a=[];for(m(r[0])||(r=[r]),n=r.length,t=r[0].length,i=0;t>i;i++){for(e=new Array(n),u=0;n>u;u++)e[u]=r[u][i];a.push(e)}return 1===a.length?a[0]:a},a.map=function(r,e,n){var t,u,i,a,o;for(m(r[0])||(r=[r]),u=r.length,i=r[0].length,a=n?r:new Array(u),t=0;u>t;t++)for(a[t]||(a[t]=new Array(i)),o=0;i>o;o++)a[t][o]=e(r[t][o],t,o);return 1===a.length?a[0]:a},a.alter=function(r,e){return a.map(r,e,!0)},a.create=function(r,e,n){var u,i,a=new Array(r);for(t(e)&&(n=e,e=r),u=0;r>u;u++)for(a[u]=new Array(e),i=0;e>i;i++)a[u][i]=n(u,i);return a},a.zeros=function(r,e){return u(e)||(e=r),a.create(r,e,o)},a.ones=function(r,e){return u(e)||(e=r),a.create(r,e,s)},a.rand=function(e,n){return u(n)||(n=e),a.create(e,n,r.random)},a.identity=function(r,e){return u(e)||(e=r),a.create(r,e,f)},a.symmetric=function(r){var e,n,t=r.length;if(r.length!==r[0].length)return!1;for(e=0;t>e;e++)for(n=0;t>n;n++)if(r[n][e]!==r[e][n])return!1;return!0},a.clear=function(r){return a.alter(r,o)},a.seq=function(r,e,u,i){t(i)||(i=!1);var a,o=[],s=n(r,e),f=(e*s-r*s)/((u-1)*s),l=r;for(a=0;e>=l;a++,l=(r*s+f*s*a)/s)o.push(i?i(l,a):l);return o};var h=a.prototype;return h.length=0,h.push=Array.prototype.push,h.sort=Array.prototype.sort,h.splice=Array.prototype.splice,h.slice=Array.prototype.slice,h.toArray=function(){return this.length>1?c.call(this):c.call(this)[0]},h.map=function(r,e){return a(a.map(this,r,e))},h.alter=function(r){return a.alter(this,r),this},function(r){for(var e=0;e<r.length;e++)(function(r){h[r]=function(e){var n,t=this;return e?(setTimeout(function(){e.call(t,h[r].call(t))}),this):(n=a[r](this),m(n)?a(n):n)}})(r[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(r){for(var e=0;e<r.length;e++)(function(r){h[r]=function(e,n){var t=this;return n?(setTimeout(function(){n.call(t,h[r].call(t,e))}),this):a(a[r](this,e))}})(r[e])}("row col".split(" ")),function(r){for(var e=0;e<r.length;e++)(function(r){h[r]=new Function("return jStat(jStat."+r+".apply(null, arguments));")})(r[e])}("create zeros ones rand identity".split(" ")),a}(Math),function(r,e){function n(r,e){return r-e}function t(r,n,t){return e.max(n,e.min(r,t))}var u=r.utils.isFunction;r.sum=function a(r){for(var a=0,e=r.length;--e>=0;)a+=r[e];return a},r.sumsqrd=function(r){for(var e=0,n=r.length;--n>=0;)e+=r[n]*r[n];return e},r.sumsqerr=function(e){for(var n,t=r.mean(e),u=0,i=e.length;--i>=0;)n=e[i]-t,u+=n*n;return u},r.product=function(r){for(var e=1,n=r.length;--n>=0;)e*=r[n];return e},r.min=function(r){for(var e=r[0],n=0;++n<r.length;)r[n]<e&&(e=r[n]);return e},r.max=function(r){for(var e=r[0],n=0;++n<r.length;)r[n]>e&&(e=r[n]);return e},r.mean=function(e){return r.sum(e)/e.length},r.meansqerr=function(e){return r.sumsqerr(e)/e.length},r.geomean=function(n){return e.pow(r.product(n),1/n.length)},r.median=function(r){var e=r.length,t=r.slice().sort(n);return 1&e?t[e/2|0]:(t[e/2-1]+t[e/2])/2},r.cumsum=function(r){var e,n=r.length,t=new Array(n);for(t[0]=r[0],e=1;n>e;e++)t[e]=t[e-1]+r[e];return t},r.diff=function(r){var e,n=[],t=r.length;for(e=1;t>e;e++)n.push(r[e]-r[e-1]);return n},r.mode=function(r){var e,t=r.length,u=r.slice().sort(n),i=1,a=0,o=0,s=[];for(e=0;t>e;e++)u[e]===u[e+1]?i++:(i>a?(s=[u[e]],a=i,o=0):i===a&&(s.push(u[e]),o++),i=1);return 0===o?s[0]:s},r.range=function(e){return r.max(e)-r.min(e)},r.variance=function(e,n){return r.sumsqerr(e)/(e.length-(n?1:0))},r.stdev=function(n,t){return e.sqrt(r.variance(n,t))},r.meandev=function(n){var t,u=0,i=r.mean(n);for(t=n.length-1;t>=0;t--)u+=e.abs(n[t]-i);return u/n.length},r.meddev=function(n){var t,u=0,i=r.median(n);for(t=n.length-1;t>=0;t--)u+=e.abs(n[t]-i);return u/n.length},r.coeffvar=function(e){return r.stdev(e)/r.mean(e)},r.quartiles=function(r){var t=r.length,u=r.slice().sort(n);return[u[e.round(t/4)-1],u[e.round(t/2)-1],u[e.round(3*t/4)-1]]},r.quantiles=function(r,u,i,a){var o,s,f,l,c,p,m=r.slice().sort(n),h=[u.length],g=r.length;for("undefined"==typeof i&&(i=3/8),"undefined"==typeof a&&(a=3/8),o=0;o<u.length;o++)s=u[o],f=i+s*(1-i-a),l=g*s+f,c=e.floor(t(l,1,g-1)),p=t(l-c,0,1),h[o]=(1-p)*m[c-1]+p*m[c];return h},r.percentileOfScore=function(r,e,n){var t,u,i=0,a=r.length,o=!1;for("strict"===n&&(o=!0),u=0;a>u;u++)t=r[u],(o&&e>t||!o&&e>=t)&&i++;return i/a},r.covariance=function(e,n){var t,u=r.mean(e),i=r.mean(n),a=e.length,o=new Array(a);for(t=0;a>t;t++)o[t]=(e[t]-u)*(n[t]-i);return r.sum(o)/(a-1)},r.corrcoeff=function(e,n){return r.covariance(e,n)/r.stdev(e,1)/r.stdev(n,1)};var i=r.prototype;i.cumsum=function(e,n){var t=[],a=0,o=this;if(u(e)&&(n=e,e=!1),n)return setTimeout(function(){n.call(o,i.cumsum.call(o,e))}),this;if(this.length>1){for(o=e===!0?this:this.transpose();a<o.length;a++)t[a]=r.cumsum(o[a]);return t}return r.cumsum(this[0],e)},function(e){for(var n=0;n<e.length;n++)(function(e){i[e]=function(n,t){var a=[],o=0,s=this;if(u(n)&&(t=n,n=!1),t)return setTimeout(function(){t.call(s,i[e].call(s,n))}),this;if(this.length>1){for(s=n===!0?this:this.transpose();o<s.length;o++)a[o]=r[e](s[o]);return n===!0?r[e](r.utils.toVector(a)):a}return r[e](this[0],n)}})(e[n])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(e){for(var n=0;n<e.length;n++)(function(e){i[e]=function(){var n=[],t=0,a=this,o=Array.prototype.slice.call(arguments);if(u(o[o.length-1])){var s=o[o.length-1],f=o.slice(0,o.length-1);return setTimeout(function(){s.call(a,i[e].apply(a,f))}),this}var s=void 0,l=function(n){return r[e].apply(a,[n].concat(o))};if(this.length>1){for(a=a.transpose();t<a.length;t++)n[t]=l(a[t]);return n}return l(this[0])}})(e[n])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(r,e){r.gammaln=function(r){var n,t,u,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],o=1.000000000190015;for(u=(t=n=r)+5.5,u-=(n+.5)*e.log(u);6>i;i++)o+=a[i]/++t;return e.log(2.5066282746310007*o/n)-u},r.gammafn=function(r){var n,t,u,i,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],o=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,f=0,l=0,c=0,p=r;if(0>=p){if(i=p%1+3.6e-16,!i)return 1/0;s=(1&p?-1:1)*e.PI/e.sin(e.PI*i),p=1-p}for(u=p,t=1>p?p++:(p-=f=(0|p)-1)-1,n=0;8>n;++n)c=(c+a[n])*t,l=l*t+o[n];if(i=c/l+1,p>u)i/=u;else if(u>p)for(n=0;f>n;++n)i*=p,p++;return s&&(i=s/i),i},r.gammap=function(n,t){var u,i=r.gammaln(n),a=n,o=1/n,s=o,f=t+1-n,l=1/1e-30,c=1/f,p=c,m=1,h=-~(8.5*e.log(n>=1?n:1/n)+.4*n+17);if(0>t||0>=n)return NaN;if(n+1>t){for(;h>=m;m++)o+=s*=t/++a;return o*e.exp(-t+n*e.log(t)-i)}for(;h>=m;m++)u=-m*(m-n),f+=2,c=u*c+f,l=f+u/l,c=1/c,p*=c*l;return 1-p*e.exp(-t+n*e.log(t)-i)},r.factorialln=function(e){return 0>e?NaN:r.gammaln(e+1)},r.factorial=function(e){return 0>e?NaN:r.gammafn(e+1)},r.combination=function(n,t){return n>170||t>170?e.exp(r.combinationln(n,t)):r.factorial(n)/r.factorial(t)/r.factorial(n-t)},r.combinationln=function(e,n){return r.factorialln(e)-r.factorialln(n)-r.factorialln(e-n)},r.permutation=function(e,n){return r.factorial(e)/r.factorial(e-n)},r.betafn=function(n,t){return 0>=n||0>=t?void 0:n+t>170?e.exp(r.betaln(n,t)):r.gammafn(n)*r.gammafn(t)/r.gammafn(n+t)},r.betaln=function(e,n){return r.gammaln(e)+r.gammaln(n)-r.gammaln(e+n)},r.betacf=function(r,n,t){var u,i,a,o,s=1e-30,f=1,l=n+t,c=n+1,p=n-1,m=1,h=1-l*r/c;for(e.abs(h)<s&&(h=s),h=1/h,o=h;100>=f&&(u=2*f,i=f*(t-f)*r/((p+u)*(n+u)),h=1+i*h,e.abs(h)<s&&(h=s),m=1+i/m,e.abs(m)<s&&(m=s),h=1/h,o*=h*m,i=-(n+f)*(l+f)*r/((n+u)*(c+u)),h=1+i*h,e.abs(h)<s&&(h=s),m=1+i/m,e.abs(m)<s&&(m=s),h=1/h,a=h*m,o*=a,!(e.abs(a-1)<3e-7));f++);return o},r.gammapinv=function(n,t){var u,i,a,o,s,f,l,c=0,p=t-1,m=1e-8,h=r.gammaln(t);if(n>=1)return e.max(100,t+100*e.sqrt(t));if(0>=n)return 0;for(t>1?(f=e.log(p),l=e.exp(p*(f-1)-h),s=.5>n?n:1-n,a=e.sqrt(-2*e.log(s)),u=(2.30753+.27061*a)/(1+a*(.99229+.04481*a))-a,.5>n&&(u=-u),u=e.max(.001,t*e.pow(1-1/(9*t)-u/(3*e.sqrt(t)),3))):(a=1-t*(.253+.12*t),u=a>n?e.pow(n/a,1/t):1-e.log(1-(n-a)/(1-a)));12>c;c++){if(0>=u)return 0;if(i=r.gammap(t,u)-n,a=t>1?l*e.exp(-(u-p)+p*(e.log(u)-f)):e.exp(-u+p*e.log(u)-h),o=i/a,u-=a=o/(1-.5*e.min(1,o*((t-1)/u-1))),0>=u&&(u=.5*(u+a)),e.abs(a)<m*u)break}return u},r.erf=function(r){var n,t,u,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],o=a.length-1,s=!1,f=0,l=0;for(0>r&&(r=-r,s=!0),n=2/(2+r),t=4*n-2;o>0;o--)u=f,f=t*f-l+a[o],l=u;return i=n*e.exp(-r*r+.5*(a[0]+t*f)-l),s?i-1:1-i},r.erfc=function(e){return 1-r.erf(e)},r.erfcinv=function(n){var t,u,i,a,o=0;if(n>=2)return-100;if(0>=n)return 100;for(a=1>n?n:2-n,i=e.sqrt(-2*e.log(a/2)),t=-.70711*((2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i);2>o;o++)u=r.erfc(t)-a,t+=u/(1.1283791670955126*e.exp(-t*t)-t*u);return 1>n?t:-t},r.ibetainv=function(n,t,u){var i,a,o,s,f,l,c,p,m,h,g,v=1e-8,d=t-1,y=u-1,b=0;if(0>=n)return 0;if(n>=1)return 1;for(t>=1&&u>=1?(o=.5>n?n:1-n,s=e.sqrt(-2*e.log(o)),c=(2.30753+.27061*s)/(1+s*(.99229+.04481*s))-s,.5>n&&(c=-c),p=(c*c-3)/6,m=2/(1/(2*t-1)+1/(2*u-1)),h=c*e.sqrt(p+m)/m-(1/(2*u-1)-1/(2*t-1))*(p+5/6-2/(3*m)),c=t/(t+u*e.exp(2*h))):(i=e.log(t/(t+u)),a=e.log(u/(t+u)),s=e.exp(t*i)/t,f=e.exp(u*a)/u,h=s+f,c=s/h>n?e.pow(t*h*n,1/t):1-e.pow(u*h*(1-n),1/u)),g=-r.gammaln(t)-r.gammaln(u)+r.gammaln(t+u);10>b;b++){if(0===c||1===c)return c;if(l=r.ibeta(c,t,u)-n,s=e.exp(d*e.log(c)+y*e.log(1-c)+g),f=l/s,c-=s=f/(1-.5*e.min(1,f*(d/c-y/(1-c)))),0>=c&&(c=.5*(c+s)),c>=1&&(c=.5*(c+s+1)),e.abs(s)<v*c&&b>0)break}return c},r.ibeta=function(n,t,u){var i=0===n||1===n?0:e.exp(r.gammaln(t+u)-r.gammaln(t)-r.gammaln(u)+t*e.log(n)+u*e.log(1-n));return 0>n||n>1?!1:(t+1)/(t+u+2)>n?i*r.betacf(n,t,u)/t:1-i*r.betacf(1-n,u,t)/u},r.randn=function(n,t){var u,i,a,o,s;if(t||(t=n),n)return r.create(n,t,function(){return r.randn()});do u=e.random(),i=1.7156*(e.random()-.5),a=u-.449871,o=e.abs(i)+.386595,s=a*a+o*(.196*o-.25472*a);while(s>.27597&&(s>.27846||i*i>-4*e.log(u)*u*u));return i/u},r.randg=function(n,t,u){var i,a,o,s,f,l,c=n;if(u||(u=t),n||(n=1),t)return l=r.zeros(t,u),l.alter(function(){return r.randg(n)}),l;1>n&&(n+=1),i=n-1/3,a=1/e.sqrt(9*i);do{do f=r.randn(),s=1+a*f;while(0>=s);s=s*s*s,o=e.random()}while(o>1-.331*e.pow(f,4)&&e.log(o)>.5*f*f+i*(1-s+e.log(s)));if(n==c)return i*s;do o=e.random();while(0===o);return e.pow(o,1/c)*i*s},function(e){for(var n=0;n<e.length;n++)(function(e){r.fn[e]=function(){return r(r.map(this,function(n){return r[e](n)}))}})(e[n])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var n=0;n<e.length;n++)(function(e){r.fn[e]=function(){return r(r[e].apply(null,arguments))}})(e[n])}("randn".split(" "))}(this.jStat,Math),function(r,e){!function(e){for(var n=0;n<e.length;n++)(function(e){r[e]=function(r,e,n){return this instanceof arguments.callee?(this._a=r,this._b=e,this._c=n,this):new arguments.callee(r,e,n)},r.fn[e]=function(n,t,u){var i=r[e](n,t,u);return i.data=this,i},r[e].prototype.sample=function(n){var t=this._a,u=this._b,i=this._c;return n?r.alter(n,function(){return r[e].sample(t,u,i)}):r[e].sample(t,u,i)},function(n){for(var t=0;t<n.length;t++)(function(n){r[e].prototype[n]=function(t){var u=this._a,i=this._b,a=this._c;return t||0===t||(t=this.data),"number"!=typeof t?r.fn.map.call(t,function(t){return r[e][n](t,u,i,a)}):r[e][n](t,u,i,a)}})(n[t])}("pdf cdf inv".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){r[e].prototype[n]=function(){return r[e][n](this._a,this._b,this._c)}})(n[t])}("mean median mode variance".split(" "))})(e[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),r.extend(r.beta,{pdf:function(n,t,u){return n>1||0>n?0:1==t&&1==u?1:512>t||512>u?e.pow(n,t-1)*e.pow(1-n,u-1)/r.betafn(t,u):e.exp((t-1)*e.log(n)+(u-1)*e.log(1-n)-r.betaln(t,u))},cdf:function(e,n,t){return e>1||0>e?1*(e>1):r.ibeta(e,n,t)},inv:function(e,n,t){return r.ibetainv(e,n,t)},mean:function(r,e){return r/(r+e)},median:function(r,e){throw new Error("median not yet implemented")},mode:function(r,n){return r*n/(e.pow(r+n,2)*(r+n+1))},sample:function(e,n){var t=r.randg(e);return t/(t+r.randg(n))},variance:function(r,n){return r*n/(e.pow(r+n,2)*(r+n+1))}}),r.extend(r.centralF,{pdf:function(n,t,u){return 0>n?void 0:e.sqrt(e.pow(t*n,t)*e.pow(u,u)/e.pow(t*n+u,t+u))/(n*r.betafn(t/2,u/2))},cdf:function(e,n,t){return r.ibeta(n*e/(n*e+t),n/2,t/2)},inv:function(e,n,t){return t/(n*(1/r.ibetainv(e,n/2,t/2)-1))},mean:function(r,e){return e>2?e/(e-2):void 0},mode:function(r,e){return r>2?e*(r-2)/(r*(e+2)):void 0},sample:function(e,n){var t=2*r.randg(e/2),u=2*r.randg(n/2);return t/e/(u/n)},variance:function(r,e){return 4>=e?void 0:2*e*e*(r+e-2)/(r*(e-2)*(e-2)*(e-4))}}),r.extend(r.cauchy,{pdf:function(r,n,t){return t/(e.pow(r-n,2)+e.pow(t,2))/e.PI},cdf:function(r,n,t){return e.atan((r-n)/t)/e.PI+.5},inv:function(r,n,t){return n+t*e.tan(e.PI*(r-.5))},median:function(r,e){return r},mode:function(r,e){return r},sample:function(n,t){return r.randn()*e.sqrt(1/(2*r.randg(.5)))*t+n}}),r.extend(r.chisquare,{pdf:function(n,t){return e.exp((t/2-1)*e.log(n)-n/2-t/2*e.log(2)-r.gammaln(t/2))},cdf:function(e,n){return r.gammap(n/2,e/2)},inv:function(e,n){return 2*r.gammapinv(e,.5*n)},mean:function(r){return r},median:function(r){return r*e.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(e){return 2*r.randg(e/2)},variance:function(r){return 2*r}}),r.extend(r.exponential,{pdf:function(r,n){return 0>r?0:n*e.exp(-n*r)},cdf:function(r,n){return 0>r?0:1-e.exp(-n*r)},inv:function(r,n){return-e.log(1-r)/n},mean:function(r){return 1/r},median:function(r){return 1/r*e.log(2)},mode:function(r){return 0},sample:function(r){return-1/r*e.log(e.random())},variance:function(r){return e.pow(r,-2)}}),r.extend(r.gamma,{pdf:function(n,t,u){return e.exp((t-1)*e.log(n)-n/u-r.gammaln(t)-t*e.log(u))},cdf:function(e,n,t){return r.gammap(n,e/t)},inv:function(e,n,t){return r.gammapinv(e,n)*t},mean:function(r,e){return r*e},mode:function(r,e){return r>1?(r-1)*e:void 0},sample:function(e,n){return r.randg(e)*n},variance:function(r,e){return r*e*e}}),r.extend(r.invgamma,{pdf:function(n,t,u){return e.exp(-(t+1)*e.log(n)-u/n-r.gammaln(t)+t*e.log(u))},cdf:function(e,n,t){return 1-r.gammap(n,t/e)},inv:function(e,n,t){return t/r.gammapinv(1-e,n)},mean:function(r,e){return r>1?e/(r-1):void 0},mode:function(r,e){return e/(r+1)},sample:function(e,n){return n/r.randg(e)},variance:function(r,e){return 2>=r?void 0:e*e/((r-1)*(r-1)*(r-2))}}),r.extend(r.kumaraswamy,{pdf:function(r,n,t){return e.exp(e.log(n)+e.log(t)+(n-1)*e.log(r)+(t-1)*e.log(1-e.pow(r,n)))},cdf:function(r,n,t){return 1-e.pow(1-e.pow(r,n),t)},mean:function(e,n){return n*r.gammafn(1+1/e)*r.gammafn(n)/r.gammafn(1+1/e+n)},median:function(r,n){return e.pow(1-e.pow(2,-1/n),1/r)},mode:function(r,n){return r>=1&&n>=1&&1!==r&&1!==n?e.pow((r-1)/(r*n-1),1/r):void 0},variance:function(r,e){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(r,n,t){return e.exp(-e.log(r)-.5*e.log(2*e.PI)-e.log(t)-e.pow(e.log(r)-n,2)/(2*t*t))},cdf:function(n,t,u){return.5+.5*r.erf((e.log(n)-t)/e.sqrt(2*u*u))},inv:function(n,t,u){return e.exp(-1.4142135623730951*u*r.erfcinv(2*n)+t)},mean:function(r,n){return e.exp(r+n*n/2)},median:function(r,n){return e.exp(r)},mode:function(r,n){return e.exp(r-n*n)},sample:function(n,t){return e.exp(r.randn()*t+n)},variance:function(r,n){return(e.exp(n*n)-1)*e.exp(2*r+n*n)}}),r.extend(r.normal,{pdf:function(r,n,t){return e.exp(-.5*e.log(2*e.PI)-e.log(t)-e.pow(r-n,2)/(2*t*t))},cdf:function(n,t,u){return.5*(1+r.erf((n-t)/e.sqrt(2*u*u)))},inv:function(e,n,t){return-1.4142135623730951*t*r.erfcinv(2*e)+n},mean:function(r,e){return r},median:function(r,e){return r},mode:function(r,e){return r},sample:function(e,n){return r.randn()*n+e},variance:function(r,e){return e*e}}),r.extend(r.pareto,{pdf:function(r,n,t){return n>=r?void 0:t*e.pow(n,t)/e.pow(r,t+1)},cdf:function(r,n,t){return 1-e.pow(n/r,t)},mean:function(r,n){return 1>=n?void 0:n*e.pow(r,n)/(n-1)},median:function(r,n){return r*(n*e.SQRT2)},mode:function(r,e){return r},variance:function(r,n){return 2>=n?void 0:r*r*n/(e.pow(n-1,2)*(n-2))}}),r.extend(r.studentt,{pdf:function(n,t){return r.gammafn((t+1)/2)/(e.sqrt(t*e.PI)*r.gammafn(t/2))*e.pow(1+n*n/t,-((t+1)/2))},cdf:function(n,t){var u=t/2;return r.ibeta((n+e.sqrt(n*n+t))/(2*e.sqrt(n*n+t)),u,u)},inv:function(n,t){var u=r.ibetainv(2*e.min(n,1-n),.5*t,.5);return u=e.sqrt(t*(1-u)/u),n>.5?u:-u},mean:function(r){return r>1?0:void 0},median:function(r){return 0},mode:function(r){return 0},sample:function(n){return r.randn()*e.sqrt(n/(2*r.randg(n/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(r,n,t){return 0>r?0:t/n*e.pow(r/n,t-1)*e.exp(-e.pow(r/n,t))},cdf:function(r,n,t){return 0>r?0:1-e.exp(-e.pow(r/n,t))},inv:function(r,n,t){return n*e.pow(-e.log(1-r),1/t)},mean:function(e,n){return e*r.gammafn(1+1/n)},median:function(r,n){return r*e.pow(e.log(2),1/n)},mode:function(r,n){return 1>=n?void 0:r*e.pow((n-1)/n,1/n)},sample:function(r,n){return r*e.pow(-e.log(e.random()),1/n)},variance:function(n,t){return n*n*r.gammafn(1+2/t)-e.pow(this.mean(n,t),2)}}),r.extend(r.uniform,{pdf:function(r,e,n){return e>r||r>n?0:1/(n-e)},cdf:function(r,e,n){return e>r?0:n>r?(r-e)/(n-e):1},mean:function(r,e){return.5*(r+e)},median:function(e,n){return r.mean(e,n)},mode:function(r,e){throw new Error("mode is not yet implemented")},sample:function(r,n){return r/2+n/2+(n/2-r/2)*(2*e.random()-1)},variance:function(r,n){return e.pow(n-r,2)/12}}),r.extend(r.binomial,{pdf:function(n,t,u){return 0===u||1===u?t*u===n?1:0:r.combination(t,n)*e.pow(u,n)*e.pow(1-u,t-n)},cdf:function(e,n,t){var u=[],i=0;if(0>e)return 0;if(n>e){for(;e>=i;i++)u[i]=r.binomial.pdf(i,n,t);return r.sum(u)}return 1}}),r.extend(r.negbin,{pdf:function(n,t,u){return n!==n|0?!1:0>n?0:r.combination(n+t-1,t-1)*e.pow(1-u,n)*e.pow(u,t)},cdf:function(e,n,t){var u=0,i=0;if(0>e)return 0;for(;e>=i;i++)u+=r.negbin.pdf(i,n,t);return u}}),r.extend(r.hypgeom,{pdf:function(n,t,u,i){if(n!==n|0)return!1;if(0>n||u-(t-i)>n)return 0;if(n>i||n>u)return 0;if(2*u>t)return 2*i>t?r.hypgeom.pdf(t-u-i+n,t,t-u,t-i):r.hypgeom.pdf(i-n,t,t-u,i);if(2*i>t)return r.hypgeom.pdf(u-n,t,u,t-i);if(i>u)return r.hypgeom.pdf(n,t,i,u);for(var a=1,o=0,s=0;n>s;s++){for(;a>1&&i>o;)a*=1-u/(t-o),o++;a*=(i-s)*(u-s)/((s+1)*(t-u-i+s+1))}for(;i>o;o++)a*=1-u/(t-o);return e.min(1,e.max(0,a))},cdf:function(n,t,u,i){if(0>n||u-(t-i)>n)return 0;if(n>=i||n>=u)return 1;if(2*u>t)return 2*i>t?r.hypgeom.cdf(t-u-i+n,t,t-u,t-i):1-r.hypgeom.cdf(i-n-1,t,t-u,i);if(2*i>t)return 1-r.hypgeom.cdf(u-n-1,t,u,t-i);if(i>u)return r.hypgeom.cdf(n,t,i,u);for(var a=1,o=1,s=0,f=0;n>f;f++){for(;a>1&&i>s;){var l=1-u/(t-s);o*=l,a*=l,s++}o*=(i-f)*(u-f)/((f+1)*(t-u-i+f+1)),a+=o}for(;i>s;s++)a*=1-u/(t-s);return e.min(1,e.max(0,a))}}),r.extend(r.poisson,{pdf:function(n,t){return e.pow(t,n)*e.exp(-t)/r.factorial(n)},cdf:function(e,n){var t=[],u=0;if(0>e)return 0;for(;e>=u;u++)t.push(r.poisson.pdf(u,n));return r.sum(t)},mean:function(r){return r},variance:function(r){return r},sample:function(r){var n=1,t=0,u=e.exp(-r);do t++,n*=e.random();while(n>u);return t-1}}),r.extend(r.triangular,{pdf:function(r,e,n,t){return e>=n||e>t||t>n?void 0:e>r||r>n?0:t>=r?2*(r-e)/((n-e)*(t-e)):2*(n-r)/((n-e)*(n-t))},cdf:function(r,n,t,u){return n>=t||n>u||u>t?void 0:n>r?0:u>=r?e.pow(r-n,2)/((t-n)*(u-n)):1-e.pow(t-r,2)/((t-n)*(t-u))},mean:function(r,e,n){return(r+e+n)/3},median:function(r,n,t){return(r+n)/2>=t?n-e.sqrt((n-r)*(n-t))/e.sqrt(2):t>(r+n)/2?r+e.sqrt((n-r)*(t-r))/e.sqrt(2):void 0},mode:function(r,e,n){return n},sample:function(r,n,t){var u=e.random();return(t-r)/(n-r)>u?r+e.sqrt(u*(n-r)*(t-r)):n-e.sqrt((1-u)*(n-r)*(n-t))},variance:function(r,e,n){return(r*r+e*e+n*n-r*e-r*n-e*n)/18}})}(this.jStat,Math),function(r,e){var n=Array.prototype.push,t=r.utils.isArray;r.extend({add:function(e,n){return t(n)?(t(n[0])||(n=[n]),r.map(e,function(r,e,t){return r+n[e][t]})):r.map(e,function(r){return r+n})},subtract:function(e,n){return t(n)?(t(n[0])||(n=[n]),r.map(e,function(r,e,t){return r-n[e][t]||0})):r.map(e,function(r){return r-n})},divide:function(e,n){return t(n)?(t(n[0])||(n=[n]),r.multiply(e,r.inv(n))):r.map(e,function(r){return r/n})},multiply:function(e,n){var u,i,a,o,s=e.length,f=e[0].length,l=r.zeros(s,a=t(n)?n[0].length:f),c=0;if(t(n)){for(;a>c;c++)for(u=0;s>u;u++){for(o=0,i=0;f>i;i++)o+=e[u][i]*n[i][c];l[u][c]=o}return 1===s&&1===c?l[0][0]:l}return r.map(e,function(r){return r*n})},dot:function(e,n){t(e[0])||(e=[e]),t(n[0])||(n=[n]);for(var u,i,a=1===e[0].length&&1!==e.length?r.transpose(e):e,o=1===n[0].length&&1!==n.length?r.transpose(n):n,s=[],f=0,l=a.length,c=a[0].length;l>f;f++){for(s[f]=[],u=0,i=0;c>i;i++)u+=a[f][i]*o[f][i];s[f]=u}return 1===s.length?s[0]:s},pow:function(n,t){return r.map(n,function(r){return e.pow(r,t)})},abs:function(n){return r.map(n,function(r){return e.abs(r)})},norm:function(r,n){var u=0,i=0;for(isNaN(n)&&(n=2),t(r[0])&&(r=r[0]);i<r.length;i++)u+=e.pow(e.abs(r[i]),n);return e.pow(u,1/n)},angle:function(n,t){return e.acos(r.dot(n,t)/(r.norm(n)*r.norm(t)))},aug:function(r,e){for(var t=r.slice(),u=0;u<t.length;u++)n.apply(t[u],e[u]);return t},inv:function(e){for(var n,t=e.length,u=e[0].length,i=r.identity(t,u),a=r.gauss_jordan(e,i),o=[],s=0;t>s;s++)for(o[s]=[],n=u-1;n<a[0].length;n++)o[s][n-u]=a[s][n];return o},det:function(r){var e,n=r.length,t=2*n,u=new Array(t),i=n-1,a=t-1,o=i-n+1,s=a,f=0,l=0;if(2===n)return r[0][0]*r[1][1]-r[0][1]*r[1][0];for(;t>f;f++)u[f]=1;for(f=0;n>f;f++){for(e=0;n>e;e++)u[0>o?o+n:o]*=r[f][e],u[n>s?s+n:s]*=r[f][e],o++,s--;o=--i-n+1,s=--a}for(f=0;n>f;f++)l+=u[f];for(;t>f;f++)l-=u[f];return l},gauss_elimination:function(n,t){var u,i,a,o,s=0,f=0,l=n.length,c=n[0].length,p=1,m=0,h=[];for(n=r.aug(n,t),u=n[0].length;l>s;s++){for(i=n[s][s],f=s,o=s+1;c>o;o++)i<e.abs(n[o][s])&&(i=n[o][s],f=o);if(f!=s)for(o=0;u>o;o++)a=n[s][o],n[s][o]=n[f][o],n[f][o]=a;for(f=s+1;l>f;f++)for(p=n[f][s]/n[s][s],o=s;u>o;o++)n[f][o]=n[f][o]-p*n[s][o]}for(s=l-1;s>=0;s--){for(m=0,f=s+1;l-1>=f;f++)m=h[f]*n[s][f];h[s]=(n[s][u-1]-m)/n[s][s]}return h},gauss_jordan:function(n,t){for(var u=r.aug(n,t),i=u.length,a=u[0].length,o=0;i>o;o++){for(var s=o,f=o+1;i>f;f++)e.abs(u[f][o])>e.abs(u[s][o])&&(s=f);var l=u[o];u[o]=u[s],u[s]=l;for(var f=o+1;i>f;f++){c=u[f][o]/u[o][o];for(var p=o;a>p;p++)u[f][p]-=u[o][p]*c}}for(var o=i-1;o>=0;o--){c=u[o][o];for(var f=0;o>f;f++)for(var p=a-1;p>o-1;p--)u[f][p]-=u[o][p]*u[f][o]/c;u[o][o]/=c;for(var p=i;a>p;p++)u[o][p]/=c}return u},lu:function(r,e){throw new Error("lu not yet implemented")},cholesky:function(r,e){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(n,t,u,i){for(var a,o,s,f,l=0,c=0,p=n.length,m=[],h=[],g=[];p>l;l++)for(m[l]=[],h[l]=[],g[l]=[],c=0;p>c;c++)l>c?(m[l][c]=n[l][c],h[l][c]=g[l][c]=0):c>l?(h[l][c]=n[l][c],
m[l][c]=g[l][c]=0):(g[l][c]=n[l][c],m[l][c]=h[l][c]=0);for(s=r.multiply(r.multiply(r.inv(g),r.add(m,h)),-1),o=r.multiply(r.inv(g),t),a=u,f=r.add(r.multiply(s,u),o),l=2;e.abs(r.norm(r.subtract(f,a)))>i;)a=f,f=r.add(r.multiply(s,a),o),l++;return f},gauss_seidel:function(n,t,u,i){for(var a,o,s,f,l,c=0,p=n.length,m=[],h=[],g=[];p>c;c++)for(m[c]=[],h[c]=[],g[c]=[],a=0;p>a;a++)c>a?(m[c][a]=n[c][a],h[c][a]=g[c][a]=0):a>c?(h[c][a]=n[c][a],m[c][a]=g[c][a]=0):(g[c][a]=n[c][a],m[c][a]=h[c][a]=0);for(f=r.multiply(r.multiply(r.inv(r.add(g,m)),h),-1),s=r.multiply(r.inv(r.add(g,m)),t),o=u,l=r.add(r.multiply(f,u),s),c=2;e.abs(r.norm(r.subtract(l,o)))>i;)o=l,l=r.add(r.multiply(f,o),s),c+=1;return l},SOR:function(n,t,u,i,a){for(var o,s,f,l,c,p=0,m=n.length,h=[],g=[],v=[];m>p;p++)for(h[p]=[],g[p]=[],v[p]=[],o=0;m>o;o++)p>o?(h[p][o]=n[p][o],g[p][o]=v[p][o]=0):o>p?(g[p][o]=n[p][o],h[p][o]=v[p][o]=0):(v[p][o]=n[p][o],h[p][o]=g[p][o]=0);for(l=r.multiply(r.inv(r.add(v,r.multiply(h,a))),r.subtract(r.multiply(v,1-a),r.multiply(g,a))),f=r.multiply(r.multiply(r.inv(r.add(v,r.multiply(h,a))),t),a),s=u,c=r.add(r.multiply(l,u),f),p=2;e.abs(r.norm(r.subtract(c,s)))>i;)s=c,c=r.add(r.multiply(l,s),f),p++;return c},householder:function(n){for(var t,u,i,a,o,s=n.length,f=n[0].length,l=0,c=[],p=[];s-1>l;l++){for(t=0,a=l+1;f>a;a++)t+=n[a][l]*n[a][l];for(o=n[l+1][l]>0?-1:1,t=o*e.sqrt(t),u=e.sqrt((t*t-n[l+1][l]*t)/2),c=r.zeros(s,1),c[l+1][0]=(n[l+1][l]-t)/(2*u),i=l+2;s>i;i++)c[i][0]=n[i][l]/(2*u);p=r.subtract(r.identity(s,f),r.multiply(r.multiply(c,r.transpose(c)),2)),n=r.multiply(p,r.multiply(n,p))}return n},QR:function(n,t){for(var u,i,a,o,s,f,l=n.length,c=n[0].length,p=0,m=[],h=[],g=[];l-1>p;p++){for(i=0,u=p+1;c>u;u++)i+=n[u][p]*n[u][p];for(s=n[p+1][p]>0?-1:1,i=s*e.sqrt(i),a=e.sqrt((i*i-n[p+1][p]*i)/2),m=r.zeros(l,1),m[p+1][0]=(n[p+1][p]-i)/(2*a),o=p+2;l>o;o++)m[o][0]=n[o][p]/(2*a);h=r.subtract(r.identity(l,c),r.multiply(r.multiply(m,r.transpose(m)),2)),n=r.multiply(h,n),t=r.multiply(h,t)}for(p=l-1;p>=0;p--){for(f=0,u=p+1;c-1>=u;u++)f=g[u]*n[p][u];g[p]=t[p][0]/n[p][p]}return g},jacobi:function(n){for(var t,u,i,a,o,s,f,l,c=1,p=0,m=n.length,h=r.identity(m,m),g=[];1===c;){for(p++,s=n[0][1],a=0,o=1,u=0;m>u;u++)for(i=0;m>i;i++)u!=i&&s<e.abs(n[u][i])&&(s=e.abs(n[u][i]),a=u,o=i);for(f=n[a][a]===n[o][o]?n[a][o]>0?e.PI/4:-e.PI/4:e.atan(2*n[a][o]/(n[a][a]-n[o][o]))/2,l=r.identity(m,m),l[a][a]=e.cos(f),l[a][o]=-e.sin(f),l[o][a]=e.sin(f),l[o][o]=e.cos(f),h=r.multiply(h,l),t=r.multiply(r.multiply(r.inv(l),n),l),n=t,c=0,u=1;m>u;u++)for(i=1;m>i;i++)u!=i&&e.abs(n[u][i])>.001&&(c=1)}for(u=0;m>u;u++)g.push(n[u][u]);return[h,g]},rungekutta:function(r,e,n,t,u,i){var a,o,s,f,l;if(2===i)for(;n>=t;)a=e*r(t,u),o=e*r(t+e,u+a),s=u+(a+o)/2,u=s,t+=e;if(4===i)for(;n>=t;)a=e*r(t,u),o=e*r(t+e/2,u+a/2),f=e*r(t+e/2,u+o/2),l=e*r(t+e,u+f),s=u+(a+2*o+2*f+l)/6,u=s,t+=e;return u},romberg:function(r,n,t,u){for(var i,a,o,s,f,l=0,c=(t-n)/2,p=[],m=[],h=[];u/2>l;){for(f=r(n),o=n,s=0;t>=o;o+=c,s++)p[s]=o;for(i=p.length,o=1;i-1>o;o++)f+=(o%2!==0?4:2)*r(p[o]);f=c/3*(f+r(t)),h[l]=f,c/=2,l++}for(a=h.length,i=1;1!==a;){for(o=0;a-1>o;o++)m[o]=(e.pow(4,i)*h[o+1]-h[o])/(e.pow(4,i)-1);a=m.length,h=m,m=[],i++}return h},richardson:function(r,n,t,u){function i(r,e){for(var n,t=0,u=r.length;u>t;t++)r[t]===e&&(n=t);return n}for(var a,o,s,f,l,c=(r.length,e.abs(t-r[i(r,t)+1])),p=0,m=[],h=[];u>=c;)a=i(r,t+u),o=i(r,t),m[p]=(n[a]-2*n[o]+n[2*o-a])/(u*u),u/=2,p++;for(f=m.length,s=1;1!=f;){for(l=0;f-1>l;l++)h[l]=(e.pow(4,s)*m[l+1]-m[l])/(e.pow(4,s)-1);f=h.length,m=h,h=[],s++}return m},simpson:function(r,e,n,t){for(var u,i=(n-e)/t,a=r(e),o=[],s=e,f=0,l=1;n>=s;s+=i,f++)o[f]=s;for(u=o.length;u-1>l;l++)a+=(l%2!==0?4:2)*r(o[l]);return i/3*(a+r(n))},hermite:function(r,e,n,t){for(var u,i=r.length,a=0,o=0,s=[],f=[],l=[],c=[];i>o;o++){for(s[o]=1,u=0;i>u;u++)o!=u&&(s[o]*=(t-r[u])/(r[o]-r[u]));for(f[o]=0,u=0;i>u;u++)o!=u&&(f[o]+=1/(r[o]-r[u]));l[o]=(1-2*(t-r[o])*f[o])*(s[o]*s[o]),c[o]=(t-r[o])*(s[o]*s[o]),a+=l[o]*e[o]+c[o]*n[o]}return a},lagrange:function(r,e,n){for(var t,u,i=0,a=0,o=r.length;o>a;a++){for(u=e[a],t=0;o>t;t++)a!=t&&(u*=(n-r[t])/(r[a]-r[t]));i+=u}return i},cubic_spline:function(e,n,t){for(var u,i=e.length,a=0,o=[],s=[],f=[],l=[],c=[],p=[],m=[];i-1>a;a++)c[a]=e[a+1]-e[a];for(f[0]=0,a=1;i-1>a;a++)f[a]=3/c[a]*(n[a+1]-n[a])-3/c[a-1]*(n[a]-n[a-1]);for(a=1;i-1>a;a++)o[a]=[],s[a]=[],o[a][a-1]=c[a-1],o[a][a]=2*(c[a-1]+c[a]),o[a][a+1]=c[a],s[a][0]=f[a];for(l=r.multiply(r.inv(o),s),u=0;i-1>u;u++)p[u]=(n[u+1]-n[u])/c[u]-c[u]*(l[u+1][0]+2*l[u][0])/3,m[u]=(l[u+1][0]-l[u][0])/(3*c[u]);for(u=0;i>u&&!(e[u]>t);u++);return u-=1,n[u]+(t-e[u])*p[u]+r.sq(t-e[u])*l[u]+(t-e[u])*r.sq(t-e[u])*m[u]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var n,t,u=e.length,i=e[0].length,a=0,o=[],s=[],f=[],l=[],c=[],p=[],m=[],h=[],g=[],v=[];for(a=0;u>a;a++)o[a]=r.sum(e[a])/i;for(a=0;i>a;a++)for(m[a]=[],n=0;u>n;n++)m[a][n]=e[n][a]-o[n];for(m=r.transpose(m),a=0;u>a;a++)for(h[a]=[],n=0;u>n;n++)h[a][n]=r.dot([m[a]],[m[n]])/(i-1);for(f=r.jacobi(h),g=f[0],s=f[1],v=r.transpose(g),a=0;a<s.length;a++)for(n=a;n<s.length;n++)s[a]<s[n]&&(t=s[a],s[a]=s[n],s[n]=t,l=v[a],v[a]=v[n],v[n]=l);for(p=r.transpose(m),a=0;u>a;a++)for(c[a]=[],n=0;n<p.length;n++)c[a][n]=r.dot([v[a]],[p[n]]);return[e,s,v,c]}}),function(e){for(var n=0;n<e.length;n++)(function(e){r.fn[e]=function(n,t){var u=this;return t?(setTimeout(function(){t.call(u,r.fn[e].call(u,n))},15),this):"number"==typeof r[e](this,n)?r[e](this,n):r(r[e](this,n))}})(e[n])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(r,e){var n=[].slice,t=r.utils.isNumber;r.extend({zscore:function(){var e=n.call(arguments);return t(e[1])?(e[0]-e[1])/e[2]:(e[0]-r.mean(e[1]))/r.stdev(e[1],e[2])},ztest:function(){var u=n.call(arguments);if(4===u.length){if(t(u[1])){var i=r.zscore(u[0],u[1],u[2]);return 1===u[3]?r.normal.cdf(-e.abs(i),0,1):2*r.normal.cdf(-e.abs(i),0,1)}var i=u[0];return 1===u[2]?r.normal.cdf(-e.abs(i),0,1):2*r.normal.cdf(-e.abs(i),0,1)}var i=r.zscore(u[0],u[1],u[3]);return 1===u[1]?r.normal.cdf(-e.abs(i),0,1):2*r.normal.cdf(-e.abs(i),0,1)}}),r.extend(r.fn,{zscore:function(r,e){return(r-this.mean())/this.stdev(e)},ztest:function(n,t,u){var i=e.abs(this.zscore(n,u));return 1===t?r.normal.cdf(-i,0,1):2*r.normal.cdf(-i,0,1)}}),r.extend({tscore:function(){var t=n.call(arguments);return 4===t.length?(t[0]-t[1])/(t[2]/e.sqrt(t[3])):(t[0]-r.mean(t[1]))/(r.stdev(t[1],!0)/e.sqrt(t[1].length))},ttest:function(){var u,i=n.call(arguments);return 5===i.length?(u=e.abs(r.tscore(i[0],i[1],i[2],i[3])),1===i[4]?r.studentt.cdf(-u,i[3]-1):2*r.studentt.cdf(-u,i[3]-1)):t(i[1])?(u=e.abs(i[0]),1==i[2]?r.studentt.cdf(-u,i[1]-1):2*r.studentt.cdf(-u,i[1]-1)):(u=e.abs(r.tscore(i[0],i[1])),1==i[2]?r.studentt.cdf(-u,i[1].length-1):2*r.studentt.cdf(-u,i[1].length-1))}}),r.extend(r.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(n,t){return 1===t?1-r.studentt.cdf(e.abs(this.tscore(n)),this.cols()-1):2*r.studentt.cdf(-e.abs(this.tscore(n)),this.cols()-1)}}),r.extend({anovafscore:function(){var t,u,i,a,o,s,f,l,c=n.call(arguments);if(1===c.length){for(o=new Array(c[0].length),f=0;f<c[0].length;f++)o[f]=c[0][f];c=o}if(2===c.length)return r.variance(c[0])/r.variance(c[1]);for(u=new Array,f=0;f<c.length;f++)u=u.concat(c[f]);for(i=r.mean(u),t=0,f=0;f<c.length;f++)t+=c[f].length*e.pow(r.mean(c[f])-i,2);for(t/=c.length-1,s=0,f=0;f<c.length;f++)for(a=r.mean(c[f]),l=0;l<c[f].length;l++)s+=e.pow(c[f][l]-a,2);return s/=u.length-c.length,t/s},anovaftest:function(){var e,u,i,a,o=n.call(arguments);if(t(o[0]))return 1-r.centralF.cdf(o[0],o[1],o[2]);for(anovafscore=r.anovafscore(o),e=o.length-1,i=0,a=0;a<o.length;a++)i+=o[a].length;return u=i-e-1,1-r.centralF.cdf(anovafscore,e,u)},ftest:function(e,n,t){return 1-r.centralF.cdf(e,n,t)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var e,n=0;for(e=0;e<this.length;e++)n+=this[e].length;return r.ftest(this.anovafscore(),this.length-1,n-this.length)}}),r.extend({normalci:function(){var t,u=n.call(arguments),i=new Array(2);return t=4===u.length?e.abs(r.normal.inv(u[1]/2,0,1)*u[2]/e.sqrt(u[3])):e.abs(r.normal.inv(u[1]/2,0,1)*r.stdev(u[2])/e.sqrt(u[2].length)),i[0]=u[0]-t,i[1]=u[0]+t,i},tci:function(){var t,u=n.call(arguments),i=new Array(2);return t=4===u.length?e.abs(r.studentt.inv(u[1]/2,u[3]-1)*u[2]/e.sqrt(u[3])):e.abs(r.studentt.inv(u[1]/2,u[2].length-1)*r.stdev(u[2],!0)/e.sqrt(u[2].length)),i[0]=u[0]-t,i[1]=u[0]+t,i},significant:function(r,e){return e>r}}),r.extend(r.fn,{normalci:function(e,n){return r.normalci(e,n,this.toArray())},tci:function(e,n){return r.tci(e,n,this.toArray())}})}(this.jStat,Math)},function(r,e,n){var t=n(9),u=n(13);e.UNIQUE=function(){for(var r=[],e=0;e<arguments.length;++e){for(var n=!1,t=arguments[e],u=0;u<r.length&&!(n=r[u]===t);++u);n||r.push(t)}return r},e.FLATTEN=t.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(r,e){try{for(var n=e.split("."),t=r,u=0;u<n.length;++u){var i=n[u];if("]"===i[i.length-1]){var a=i.indexOf("["),o=i.substring(a+1,i.length-1);t=t[i.substring(0,a)][o]}else t=t[i]}return t}catch(s){}},e.JOIN=function(r,e){return r.join(e)},e.NUMBERS=function(){var r=t.flatten(arguments);return r.filter(function(r){return"number"==typeof r})},e.NUMERAL=function(r,e){return u(r).format(e)}},function(r,e,n){var t=n(10);e.CELL=function(){throw new Error("CELL is not implemented")},e.ERROR={},e.ERROR.TYPE=function(r){switch(r){case t.nil:return 1;case t.div0:return 2;case t.value:return 3;case t.ref:return 4;case t.name:return 5;case t.num:return 6;case t.na:return 7;case t.data:return 8}return t.na},e.INFO=function(){throw new Error("INFO is not implemented")},e.ISBLANK=function(r){return null===r},e.ISBINARY=function(r){return/^[01]{1,10}$/.test(r)},e.ISERR=function(r){return[t.value,t.ref,t.div0,t.num,t.name,t.nil].indexOf(r)>=0||"number"==typeof r&&(isNaN(r)||!isFinite(r))},e.ISERROR=function(r){return e.ISERR(r)||r===t.na},e.ISEVEN=function(r){return 1&Math.floor(Math.abs(r))?!1:!0},e.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},e.ISLOGICAL=function(r){return r===!0||r===!1},e.ISNA=function(r){return r===t.na},e.ISNONTEXT=function(r){return"string"!=typeof r},e.ISNUMBER=function(r){return"number"==typeof r&&!isNaN(r)&&isFinite(r)},e.ISODD=function(r){return 1&Math.floor(Math.abs(r))?!0:!1},e.ISREF=function(){throw new Error("ISREF is not implemented")},e.ISTEXT=function(r){return"string"==typeof r},e.N=function(r){return this.ISNUMBER(r)?r:r instanceof Date?r.getTime():r===!0?1:r===!1?0:this.ISERROR(r)?r:0},e.NA=function(){return t.na},e.SHEET=function(){throw new Error("SHEET is not implemented")},e.SHEETS=function(){throw new Error("SHEETS is not implemented")},e.TYPE=function(r){return this.ISNUMBER(r)?1:this.ISTEXT(r)?2:this.ISLOGICAL(r)?4:this.ISERROR(r)?16:Array.isArray(r)?64:void 0}},function(r,e,n){function t(r){return/^[01]{1,10}$/.test(r)}var u=n(10),i=n(14).jStat,a=n(12),o=n(9),s=n(18);e.BESSELI=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:s.besseli(r,e)},e.BESSELJ=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:s.besselj(r,e)},e.BESSELK=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:s.besselk(r,e)},e.BESSELY=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:s.bessely(r,e)},e.BIN2DEC=function(r){if(!t(r))return u.num;var e=parseInt(r,2),n=r.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:e},e.BIN2HEX=function(r,e){if(!t(r))return u.num;var n=r.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var i=parseInt(r,2).toString(16);return void 0===e?i:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=i.length?a.REPT("0",e-i.length)+i:u.num)},e.BIN2OCT=function(r,e){if(!t(r))return u.num;var n=r.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var i=parseInt(r,2).toString(8);return void 0===e?i:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=i.length?a.REPT("0",e-i.length)+i:u.num)},e.BITAND=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r||0>e?u.num:Math.floor(r)!==r||Math.floor(e)!==e?u.num:r>0xffffffffffff||e>0xffffffffffff?u.num:r&e},e.BITLSHIFT=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r?u.num:Math.floor(r)!==r?u.num:r>0xffffffffffff?u.num:Math.abs(e)>53?u.num:e>=0?r<<e:r>>-e},e.BITOR=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r||0>e?u.num:Math.floor(r)!==r||Math.floor(e)!==e?u.num:r>0xffffffffffff||e>0xffffffffffff?u.num:r|e},e.BITRSHIFT=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r?u.num:Math.floor(r)!==r?u.num:r>0xffffffffffff?u.num:Math.abs(e)>53?u.num:e>=0?r>>e:r<<-e},e.BITXOR=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:0>r||0>e?u.num:Math.floor(r)!==r||Math.floor(e)!==e?u.num:r>0xffffffffffff||e>0xffffffffffff?u.num:r^e},e.COMPLEX=function(r,e,n){if(r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e))return r;if(n=void 0===n?"i":n,"i"!==n&&"j"!==n)return u.value;if(0===r&&0===e)return 0;if(0===r)return 1===e?n:e.toString()+n;if(0===e)return r.toString();var t=e>0?"+":"";return r.toString()+t+(1===e?n:e.toString()+n)},e.CONVERT=function(r,e,n){if(r=o.parseNumber(r),r instanceof Error)return r;for(var t,i=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],a={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},f=null,l=null,c=e,p=n,m=1,h=1,g=0;g<i.length;g++)t=null===i[g][2]?[]:i[g][2],(i[g][1]===c||t.indexOf(c)>=0)&&(f=i[g]),(i[g][1]===p||t.indexOf(p)>=0)&&(l=i[g]);if(null===f){var v=a[e.substring(0,2)],d=s[e.substring(0,1)];"da"===e.substring(0,2)&&(d=["dekao",10,"da"]),v?(m=v[2],c=e.substring(2)):d&&(m=d[1],c=e.substring(d[2].length));for(var y=0;y<i.length;y++)t=null===i[y][2]?[]:i[y][2],(i[y][1]===c||t.indexOf(c)>=0)&&(f=i[y])}if(null===l){var b=a[n.substring(0,2)],E=s[n.substring(0,1)];"da"===n.substring(0,2)&&(E=["dekao",10,"da"]),b?(h=b[2],p=n.substring(2)):E&&(h=E[1],p=n.substring(E[2].length));for(var N=0;N<i.length;N++)t=null===i[N][2]?[]:i[N][2],(i[N][1]===p||t.indexOf(p)>=0)&&(l=i[N])}return null===f||null===l?u.na:f[3]!==l[3]?u.na:r*f[6]*m/(l[6]*h)},e.DEC2BIN=function(r,e){if(r=o.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,3}$/.test(r)||-512>r||r>511)return u.num;if(0>r)return"1"+a.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var n=parseInt(r,10).toString(2);return"undefined"==typeof e?n:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=n.length?a.REPT("0",e-n.length)+n:u.num)},e.DEC2HEX=function(r,e){if(r=o.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,12}$/.test(r)||-549755813888>r||r>549755813887)return u.num;if(0>r)return(1099511627776+r).toString(16);var n=parseInt(r,10).toString(16);return"undefined"==typeof e?n:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=n.length?a.REPT("0",e-n.length)+n:u.num)},e.DEC2OCT=function(r,e){if(r=o.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,9}$/.test(r)||-536870912>r||r>536870911)return u.num;if(0>r)return(1073741824+r).toString(8);var n=parseInt(r,10).toString(8);return"undefined"==typeof e?n:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=n.length?a.REPT("0",e-n.length)+n:u.num)},e.DELTA=function(r,e){return e=void 0===e?0:e,r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:r===e?1:0},e.ERF=function(r,e){return e=void 0===e?0:e,r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?u.value:i.erf(r)},e.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},e.ERFC=function(r){return isNaN(r)?u.value:i.erfc(r)},e.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},e.GESTEP=function(r,e){return e=e||0,r=o.parseNumber(r),o.anyIsError(e,r)?r:r>=e?1:0},e.HEX2BIN=function(r,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return u.num;var n=10===r.length&&"f"===r.substring(0,1).toLowerCase()?!0:!1,t=n?parseInt(r,16)-1099511627776:parseInt(r,16);if(-512>t||t>511)return u.num;if(n)return"1"+a.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var i=t.toString(2);return void 0===e?i:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=i.length?a.REPT("0",e-i.length)+i:u.num)},e.HEX2DEC=function(r){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return u.num;var e=parseInt(r,16);return e>=549755813888?e-1099511627776:e},e.HEX2OCT=function(r,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return u.num;var n=parseInt(r,16);if(n>536870911&&0xffe0000000>n)return u.num;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var t=n.toString(8);return void 0===e?t:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=t.length?a.REPT("0",e-t.length)+t:u.num)},e.IMABS=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:Math.sqrt(Math.pow(n,2)+Math.pow(t,2))},e.IMAGINARY=function(r){if(void 0===r||r===!0||r===!1)return u.value;if(0===r||"0"===r)return 0;if(["i","j"].indexOf(r)>=0)return 1;r=r.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var e=r.indexOf("+"),n=r.indexOf("-");0===e&&(e=r.indexOf("+",1)),0===n&&(n=r.indexOf("-",1));var t=r.substring(r.length-1,r.length),i="i"===t||"j"===t;return e>=0||n>=0?i?e>=0?isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?u.num:Number(r.substring(e+1,r.length-1)):isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?u.num:-Number(r.substring(n+1,r.length-1)):u.num:i?isNaN(r.substring(0,r.length-1))?u.num:r.substring(0,r.length-1):isNaN(r)?u.num:0},e.IMARGUMENT=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:0===n&&0===t?u.div0:0===n&&t>0?Math.PI/2:0===n&&0>t?-Math.PI/2:0===t&&n>0?0:0===t&&0>n?-Math.PI:n>0?Math.atan(t/n):0>n&&t>=0?Math.atan(t/n)+Math.PI:Math.atan(t/n)-Math.PI},e.IMCONJUGATE=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",0!==t?e.COMPLEX(n,-t,i):r},e.IMCOS=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,i)},e.IMCOSH=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,i)},e.IMCOT=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:e.IMDIV(e.IMCOS(r),e.IMSIN(r))},e.IMDIV=function(r,n){var t=e.IMREAL(r),i=e.IMAGINARY(r),a=e.IMREAL(n),s=e.IMAGINARY(n);if(o.anyIsError(t,i,a,s))return u.value;var f=r.substring(r.length-1),l=n.substring(n.length-1),c="i";if("j"===f?c="j":"j"===l&&(c="j"),0===a&&0===s)return u.num;var p=a*a+s*s;return e.COMPLEX((t*a+i*s)/p,(i*a-t*s)/p,c)},e.IMEXP=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);i="i"===i||"j"===i?i:"i";var a=Math.exp(n);return e.COMPLEX(a*Math.cos(t),a*Math.sin(t),i)},e.IMLN=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+t*t)),Math.atan(t/n),i)},e.IMLOG10=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+t*t))/Math.log(10),Math.atan(t/n)/Math.log(10),i)},e.IMLOG2=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+t*t))/Math.log(2),Math.atan(t/n)/Math.log(2),i)},e.IMPOWER=function(r,n){n=o.parseNumber(n);var t=e.IMREAL(r),i=e.IMAGINARY(r);if(o.anyIsError(n,t,i))return u.value;var a=r.substring(r.length-1);a="i"===a||"j"===a?a:"i";var s=Math.pow(e.IMABS(r),n),f=e.IMARGUMENT(r);return e.COMPLEX(s*Math.cos(n*f),s*Math.sin(n*f),a)},e.IMPRODUCT=function(){for(var r=arguments[0],n=1;n<arguments.length;n++){var t=e.IMREAL(r),i=e.IMAGINARY(r),a=e.IMREAL(arguments[n]),s=e.IMAGINARY(arguments[n]);if(o.anyIsError(t,i,a,s))return u.value;r=e.COMPLEX(t*a-i*s,t*s+i*a)}return r},e.IMREAL=function(r){if(void 0===r||r===!0||r===!1)return u.value;if(0===r||"0"===r)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r)>=0)return 0;var e=r.indexOf("+"),n=r.indexOf("-");0===e&&(e=r.indexOf("+",1)),0===n&&(n=r.indexOf("-",1));var t=r.substring(r.length-1,r.length),i="i"===t||"j"===t;return e>=0||n>=0?i?e>=0?isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?u.num:Number(r.substring(0,e)):isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?u.num:Number(r.substring(0,n)):u.num:i?isNaN(r.substring(0,r.length-1))?u.num:0:isNaN(r)?u.num:r},e.IMSEC=function(r){if(r===!0||r===!1)return u.value;var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:e.IMDIV("1",e.IMCOS(r))},e.IMSECH=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:e.IMDIV("1",e.IMCOSH(r))},e.IMSIN=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,i)},e.IMSINH=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,i)},e.IMSQRT=function(r){var n=e.IMREAL(r),t=e.IMAGINARY(r);if(o.anyIsError(n,t))return u.value;var i=r.substring(r.length-1);i="i"===i||"j"===i?i:"i";var a=Math.sqrt(e.IMABS(r)),s=e.IMARGUMENT(r);return e.COMPLEX(a*Math.cos(s/2),a*Math.sin(s/2),i)},e.IMCSC=function(r){if(r===!0||r===!1)return u.value;var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.num:e.IMDIV("1",e.IMSIN(r))},e.IMCSCH=function(r){if(r===!0||r===!1)return u.value;var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.num:e.IMDIV("1",e.IMSINH(r))},e.IMSUB=function(r,e){var n=this.IMREAL(r),t=this.IMAGINARY(r),i=this.IMREAL(e),a=this.IMAGINARY(e);if(o.anyIsError(n,t,i,a))return u.value;var s=r.substring(r.length-1),f=e.substring(e.length-1),l="i";return"j"===s?l="j":"j"===f&&(l="j"),this.COMPLEX(n-i,t-a,l)},e.IMSUM=function(){for(var r=o.flatten(arguments),e=r[0],n=1;n<r.length;n++){var t=this.IMREAL(e),i=this.IMAGINARY(e),a=this.IMREAL(r[n]),s=this.IMAGINARY(r[n]);if(o.anyIsError(t,i,a,s))return u.value;e=this.COMPLEX(t+a,i+s)}return e},e.IMTAN=function(r){if(r===!0||r===!1)return u.value;var n=e.IMREAL(r),t=e.IMAGINARY(r);return o.anyIsError(n,t)?u.value:this.IMDIV(this.IMSIN(r),this.IMCOS(r))},e.OCT2BIN=function(r,e){if(!/^[0-7]{1,10}$/.test(r))return u.num;var n=10===r.length&&"7"===r.substring(0,1)?!0:!1,t=n?parseInt(r,8)-1073741824:parseInt(r,8);if(-512>t||t>511)return u.num;if(n)return"1"+a.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var i=t.toString(2);return"undefined"==typeof e?i:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=i.length?a.REPT("0",e-i.length)+i:u.num)},e.OCT2DEC=function(r){if(!/^[0-7]{1,10}$/.test(r))return u.num;
var e=parseInt(r,8);return e>=536870912?e-1073741824:e},e.OCT2HEX=function(r,e){if(!/^[0-7]{1,10}$/.test(r))return u.num;var n=parseInt(r,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var t=n.toString(16);return void 0===e?t:isNaN(e)?u.value:0>e?u.num:(e=Math.floor(e),e>=t.length?a.REPT("0",e-t.length)+t:u.num)}},function(r,e,n){function t(r,e){return r.reduce(function(r,n){return e*r+n},0)}function u(r,e,n,t,u){u||(u=-1);var i,a=2/r;if(0===e)return n;if(1===e)return t;for(var o=1;o!=e;++o)i=t*o*a+u*n,n=t,t=i;return t}function i(r,e,n,t,i){return function(a,o){if(0===o)return r(a);if(1===o)return e(a);if(0>o)throw n+": Order ("+o+") must be nonnegative";if(1==t&&0===a)throw n+": Undefined when x == 0";if(2==t&&0>=a)throw n+": Undefined when x <= 0";var s=r(a),f=e(a);return u(a,o,s,f,i)}}var a=Math,o=function(){function r(r){var e,u,l,c=r*r,p=a.abs(r)-.785398164;return a.abs(r)<8?(u=t(n,c),l=t(i,c),e=u/l):(c=64/c,u=t(o,c),l=t(s,c),e=a.sqrt(f/a.abs(r))*(a.cos(p)*u-a.sin(p)*l*8/a.abs(r))),e}function e(r){var e,n,u,i=r*r,o=a.abs(r)-2.356194491;return Math.abs(r)<8?(n=r*t(l,i),u=t(c,i),e=n/u):(i=64/i,n=t(p,i),u=t(m,i),e=a.sqrt(f/a.abs(r))*(a.cos(o)*n-a.sin(o)*u*8/a.abs(r)),0>r&&(e=-e)),e}var n=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),o=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),f=.636619772,l=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),p=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),m=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(n,t){if(t=Math.round(t),0===t)return r(a.abs(n));if(1===t)return e(a.abs(n));if(0>t)throw"BESSELJ: Order ("+t+") must be nonnegative";if(0===a.abs(n))return 0;var i,o,s,f,l,c,p,m,h=2/a.abs(n);if(a.abs(n)>t)i=u(n,t,r(a.abs(n)),e(a.abs(n)),-1);else{for(s=2*a.floor((t+a.floor(a.sqrt(40*t)))/2),f=0,c=i=l=0,p=1,o=s;o>0;o--)m=o*h*p-c,c=p,p=m,a.abs(p)>1e10&&(p*=1e-10,c*=1e-10,i*=1e-10,l*=1e-10),f&&(l+=p),f=!f,o==t&&(i=c);l=2*l-p,i/=l}return 0>n&&t%2?-i:i}}(),s=function(){function r(r){var e,i,c,p=r*r,m=r-.785398164;return 8>r?(i=t(n,p),c=t(u,p),e=i/c+l*o(r,0)*a.log(r)):(p=64/p,i=t(s,p),c=t(f,p),e=a.sqrt(l/r)*(a.sin(m)*i+a.cos(m)*c*8/r)),e}function e(r){var e,n,u,i=r*r,s=r-2.356194491;return 8>r?(n=r*t(c,i),u=t(p,i),e=n/u+l*(o(r,1)*a.log(r)-1/r)):(i=64/i,n=t(m,i),u=t(h,i),e=a.sqrt(l/r)*(a.sin(s)*n+a.cos(s)*u*8/r)),e}var n=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),u=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),l=.636619772,c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),p=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return i(r,e,"BESSELY",1,-1)}(),f=function(){function r(r){return 3.75>=r?t(n,r*r/14.0625):a.exp(a.abs(r))/a.sqrt(a.abs(r))*t(u,3.75/a.abs(r))}function e(r){return 3.75>r?r*t(i,r*r/14.0625):(0>r?-1:1)*a.exp(a.abs(r))/a.sqrt(a.abs(r))*t(o,3.75/a.abs(r))}var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),u=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),i=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),o=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function s(n,t){if(t=Math.round(t),0===t)return r(n);if(1==t)return e(n);if(0>t)throw"BESSELI Order ("+t+") must be nonnegative";if(0===a.abs(n))return 0;var u,i,o,f,l,c,p=2/a.abs(n);for(o=2*a.round((t+a.round(a.sqrt(40*t)))/2),f=u=0,l=1,i=o;i>0;i--)c=i*p*l+f,f=l,l=c,a.abs(l)>1e10&&(l*=1e-10,f*=1e-10,u*=1e-10),i==t&&(u=f);return u*=s(n,0)/l,0>n&&t%2?-u:u}}(),l=function(){function r(r){return 2>=r?-a.log(r/2)*f(r,0)+t(n,r*r/4):a.exp(-r)/a.sqrt(r)*t(u,2/r)}function e(r){return 2>=r?a.log(r/2)*f(r,1)+1/r*t(o,r*r/4):a.exp(-r)/a.sqrt(r)*t(s,2/r)}var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),u=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),o=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return i(r,e,"BESSELK",2,1)}();e.besselj=o,e.bessely=s,e.besseli=f,e.besselk=l},function(r,e,n){function t(r){return 1===new Date(r,1,29).getMonth()}function u(r,e){return Math.ceil((e-r)/1e3/60/60/24)}function i(r){var e=r>-22038912e5?2:1;return(r-s)/864e5+e}var a=n(10),o=n(9),s=new Date(1900,0,1),f=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],l=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],c=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];e.DATE=function(r,e,n){if(r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n))return a.value;if(0>r||0>e||0>n)return a.num;var t=new Date(r,e-1,n);return t},e.DATEVALUE=function(r){if("string"!=typeof r)return a.value;var e=Date.parse(r);return isNaN(e)?a.value:-22038912e5>=e?(e-s)/864e5+1:(e-s)/864e5+2},e.DAY=function(r){var e=o.parseDate(r);return e instanceof Error?e:e.getDate()},e.DAYS=function(r,e){return r=o.parseDate(r),e=o.parseDate(e),r instanceof Error?r:e instanceof Error?e:i(r)-i(e)},e.DAYS360=function(r,e,n){if(n=o.parseBool(n),r=o.parseDate(r),e=o.parseDate(e),r instanceof Error)return r;if(e instanceof Error)return e;if(n instanceof Error)return n;var t,u,i=r.getMonth(),a=e.getMonth();if(n)t=31===r.getDate()?30:r.getDate(),u=31===e.getDate()?30:e.getDate();else{var s=new Date(r.getFullYear(),i+1,0).getDate(),f=new Date(e.getFullYear(),a+1,0).getDate();t=r.getDate()===s?30:r.getDate(),e.getDate()===f?30>t?(a++,u=1):u=30:u=e.getDate()}return 360*(e.getFullYear()-r.getFullYear())+30*(a-i)+(u-t)},e.EDATE=function(r,e){return r=o.parseDate(r),r instanceof Error?r:isNaN(e)?a.value:(e=parseInt(e,10),r.setMonth(r.getMonth()+e),i(r))},e.EOMONTH=function(r,e){return r=o.parseDate(r),r instanceof Error?r:isNaN(e)?a.value:(e=parseInt(e,10),i(new Date(r.getFullYear(),r.getMonth()+e+1,0)))},e.HOUR=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getHours()},e.INTERVAL=function(r){if("number"!=typeof r&&"string"!=typeof r)return a.value;r=parseInt(r,10);var e=Math.floor(r/94608e4);r%=94608e4;var n=Math.floor(r/2592e3);r%=2592e3;var t=Math.floor(r/86400);r%=86400;var u=Math.floor(r/3600);r%=3600;var i=Math.floor(r/60);r%=60;var o=r;return e=e>0?e+"Y":"",n=n>0?n+"M":"",t=t>0?t+"D":"",u=u>0?u+"H":"",i=i>0?i+"M":"",o=o>0?o+"S":"","P"+e+n+t+"T"+u+i+o},e.ISOWEEKNUM=function(r){if(r=o.parseDate(r),r instanceof Error)return r;r.setHours(0,0,0),r.setDate(r.getDate()+4-(r.getDay()||7));var e=new Date(r.getFullYear(),0,1);return Math.ceil(((r-e)/864e5+1)/7)},e.MINUTE=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getMinutes()},e.MONTH=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getMonth()+1},e.NETWORKDAYS=function(r,e,n){return this.NETWORKDAYS.INTL(r,e,1,n)},e.NETWORKDAYS.INTL=function(r,e,n,t){if(r=o.parseDate(r),r instanceof Error)return r;if(e=o.parseDate(e),e instanceof Error)return e;if(n=void 0===n?c[1]:c[n],!(n instanceof Array))return a.value;void 0===t?t=[]:t instanceof Array||(t=[t]);for(var u=0;u<t.length;u++){var i=o.parseDate(t[u]);if(i instanceof Error)return i;t[u]=i}var s=(e-r)/864e5+1,f=s,l=r;for(u=0;s>u;u++){var p=(new Date).getTimezoneOffset()>0?l.getUTCDay():l.getDay(),m=!1;(p===n[0]||p===n[1])&&(m=!0);for(var h=0;h<t.length;h++){var g=t[h];if(g.getDate()===l.getDate()&&g.getMonth()===l.getMonth()&&g.getFullYear()===l.getFullYear()){m=!0;break}}m&&f--,l.setDate(l.getDate()+1)}return f},e.NOW=function(){return new Date},e.SECOND=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getSeconds()},e.TIME=function(r,e,n){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?a.value:0>r||0>e||0>n?a.num:(3600*r+60*e+n)/86400},e.TIMEVALUE=function(r){return r=o.parseDate(r),r instanceof Error?r:(3600*r.getHours()+60*r.getMinutes()+r.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(r,e){if(r=o.parseDate(r),r instanceof Error)return r;void 0===e&&(e=1);var n=r.getDay();return l[e][n]},e.WEEKNUM=function(r,e){if(r=o.parseDate(r),r instanceof Error)return r;if(void 0===e&&(e=1),21===e)return this.ISOWEEKNUM(r);var n=f[e],t=new Date(r.getFullYear(),0,1),u=t.getDay()<n?1:0;return t-=24*Math.abs(t.getDay()-n)*60*60*1e3,Math.floor((r-t)/864e5/7+1)+u},e.WORKDAY=function(r,e,n){return this.WORKDAY.INTL(r,e,1,n)},e.WORKDAY.INTL=function(r,e,n,t){if(r=o.parseDate(r),r instanceof Error)return r;if(e=o.parseNumber(e),e instanceof Error)return e;if(0>e)return a.num;if(n=void 0===n?c[1]:c[n],!(n instanceof Array))return a.value;void 0===t?t=[]:t instanceof Array||(t=[t]);for(var u=0;u<t.length;u++){var i=o.parseDate(t[u]);if(i instanceof Error)return i;t[u]=i}for(var s=0;e>s;){r.setDate(r.getDate()+1);var f=r.getDay();if(f!==n[0]&&f!==n[1]){for(var l=0;l<t.length;l++){var p=t[l];if(p.getDate()===r.getDate()&&p.getMonth()===r.getMonth()&&p.getFullYear()===r.getFullYear()){s--;break}}s++}}return r},e.YEAR=function(r){return r=o.parseDate(r),r instanceof Error?r:r.getFullYear()},e.YEARFRAC=function(r,e,n){if(r=o.parseDate(r),r instanceof Error)return r;if(e=o.parseDate(e),e instanceof Error)return e;n=n||0;var i=r.getDate(),a=r.getMonth()+1,s=r.getFullYear(),f=e.getDate(),l=e.getMonth()+1,c=e.getFullYear();switch(n){case 0:return 31===i&&31===f?(i=30,f=30):31===i?i=30:30===i&&31===f&&(f=30),(f+30*l+360*c-(i+30*a+360*s))/360;case 1:var p=function(r,e){var n=r.getFullYear(),u=new Date(n,2,1);if(t(n)&&u>r&&e>=u)return!0;var i=e.getFullYear(),a=new Date(i,2,1);return t(i)&&e>=a&&a>r},m=365;if(s===c||s+1===c&&(a>l||a===l&&i>=f))return(s===c&&t(s)||p(r,e)||1===l&&29===f)&&(m=366),u(r,e)/m;var h=c-s+1,g=(new Date(c+1,0,1)-new Date(s,0,1))/1e3/60/60/24,v=g/h;return u(r,e)/v;case 2:return u(r,e)/360;case 3:return u(r,e)/365;case 4:return(f+30*l+360*c-(i+30*a+360*s))/360}}},function(module,exports,__webpack_require__){function compact(r){if(!r)return r;for(var e=[],n=0;n<r.length;++n)r[n]&&e.push(r[n]);return e}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}var error=__webpack_require__(10),stats=__webpack_require__(11),maths=__webpack_require__(7),utils=__webpack_require__(9);exports.FINDFIELD=function(r,e){for(var n=null,t=0;t<r.length;t++)if(r[t][0]===e){n=t;break}return null==n?error.value:n},exports.DAVERAGE=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=0,o=0;o<t.length;o++)a+=u[t[o]];return 0===t.length?error.div0:a/t.length},exports.DCOUNT=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return stats.COUNT(a)},exports.DCOUNTA=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return stats.COUNTA(a)},exports.DGET=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);return 0===t.length?error.value:t.length>1?error.num:u[t[0]]},exports.DMAX=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=u[t[0]],o=1;o<t.length;o++)a<u[t[o]]&&(a=u[t[o]]);return a},exports.DMIN=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=u[t[0]],o=1;o<t.length;o++)a>u[t[o]]&&(a=u[t[o]]);return a},exports.DPRODUCT=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];a=compact(a);var s=1;for(o=0;o<a.length;o++)s*=a[o];return s},exports.DSTDEV=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return a=compact(a),stats.STDEV.S(a)},exports.DSTDEVP=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return a=compact(a),stats.STDEV.P(a)},exports.DSUM=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return maths.SUM(a)},exports.DVAR=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return stats.VAR.S(a)},exports.DVARP=function(r,e,n){if(isNaN(e)&&"string"!=typeof e)return error.value;var t=findResultIndex(r,n),u=[];if("string"==typeof e){var i=exports.FINDFIELD(r,e);u=utils.rest(r[i])}else u=utils.rest(r[e]);for(var a=[],o=0;o<t.length;o++)a[o]=u[t[o]];return stats.VAR.P(a)}},function(r,e,n){var t=n(10),u=n(9),i=n(16);e.AND=function(){for(var r=u.flatten(arguments),e=!0,n=0;n<r.length;n++)r[n]||(e=!1);return e},e.CHOOSE=function(){if(arguments.length<2)return t.na;var r=arguments[0];return 1>r||r>254?t.value:arguments.length<r+1?t.value:arguments[r]},e.FALSE=function(){return!1},e.IF=function(r,e,n){return r?e:n},e.IFERROR=function(r,e){return i.ISERROR(r)?e:r},e.IFNA=function(r,e){return r===t.na?e:r},e.NOT=function(r){return!r},e.OR=function(){for(var r=u.flatten(arguments),e=!1,n=0;n<r.length;n++)r[n]&&(e=!0);return e},e.TRUE=function(){return!0},e.XOR=function(){for(var r=u.flatten(arguments),e=0,n=0;n<r.length;n++)r[n]&&e++;return 1&Math.floor(Math.abs(e))?!0:!1},e.SWITCH=function(){var r;if(arguments.length>0){var e=arguments[0],n=arguments.length-1,t=Math.floor(n/2),u=!1,i=n%2===0?null:arguments[arguments.length-1];if(t)for(var a=0;t>a;a++)if(e===arguments[2*a+1]){r=arguments[2*a+2],u=!0;break}!u&&i&&(r=i)}return r}},function(r,e,n){function t(r){return r&&r.getTime&&!isNaN(r.getTime())}function u(r){return r instanceof Date?r:new Date(r)}var i=n(10),a=n(19),o=n(9);e.ACCRINT=function(r,e,n,i,o,s,f){return r=u(r),e=u(e),n=u(n),t(r)&&t(e)&&t(n)?0>=i||0>=o?"#NUM!":-1===[1,2,4].indexOf(s)?"#NUM!":-1===[0,1,2,3,4].indexOf(f)?"#NUM!":r>=n?"#NUM!":(o=o||0,f=f||0,o*i*a.YEARFRAC(r,n,f)):"#VALUE!"},e.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},e.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},e.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},e.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},e.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},e.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},e.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},e.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},e.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},e.CUMIPMT=function(r,n,t,u,a,s){if(r=o.parseNumber(r),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,n,t))return i.value;if(0>=r||0>=n||0>=t)return i.num;if(1>u||1>a||u>a)return i.num;if(0!==s&&1!==s)return i.num;var f=e.PMT(r,n,t,0,s),l=0;1===u&&0===s&&(l=-t,u++);for(var c=u;a>=c;c++)l+=1===s?e.FV(r,c-2,f,t,1)-f:e.FV(r,c-1,f,t,0);return l*=r},e.CUMPRINC=function(r,n,t,u,a,s){if(r=o.parseNumber(r),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,n,t))return i.value;if(0>=r||0>=n||0>=t)return i.num;if(1>u||1>a||u>a)return i.num;if(0!==s&&1!==s)return i.num;var f=e.PMT(r,n,t,0,s),l=0;1===u&&(l=0===s?f+t*r:f,u++);for(var c=u;a>=c;c++)l+=s>0?f-(e.FV(r,c-2,f,t,1)-f)*r:f-e.FV(r,c-1,f,t,0)*r;return l},e.DB=function(r,e,n,t,u){if(u=void 0===u?12:u,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;if(0>r||0>e||0>n||0>t)return i.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(u))return i.num;if(t>n)return i.num;if(e>=r)return 0;for(var a=(1-Math.pow(e/r,1/n)).toFixed(3),s=r*a*u/12,f=s,l=0,c=t===n?n-1:t,p=2;c>=p;p++)l=(r-f)*a,f+=l;return 1===t?s:t===n?(r-f)*a:l},e.DDB=function(r,e,n,t,u){if(u=void 0===u?2:u,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;if(0>r||0>e||0>n||0>t||0>=u)return i.num;if(t>n)return i.num;if(e>=r)return 0;for(var a=0,s=0,f=1;t>=f;f++)s=Math.min((r-a)*(u/n),r-e-a),a+=s;return s},e.DISC=function(){throw new Error("DISC is not implemented")},e.DOLLARDE=function(r,e){if(r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e))return i.value;if(0>e)return i.num;if(e>=0&&1>e)return i.div0;e=parseInt(e,10);var n=parseInt(r,10);n+=r%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;var t=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return n=Math.round(n*t)/t},e.DOLLARFR=function(r,e){if(r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e))return i.value;if(0>e)return i.num;if(e>=0&&1>e)return i.div0;e=parseInt(e,10);var n=parseInt(r,10);return n+=r%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e},e.DURATION=function(){throw new Error("DURATION is not implemented")},e.EFFECT=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?i.value:0>=r||1>e?i.num:(e=parseInt(e,10),Math.pow(1+r/e,e)-1)},e.FV=function(r,e,n,t,u){if(t=t||0,u=u||0,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;var a;if(0===r)a=t+n*e;else{var s=Math.pow(1+r,e);a=1===u?t*s+n*(1+r)*(s-1)/r:t*s+n*(s-1)/r}return-a},e.FVSCHEDULE=function(r,e){if(r=o.parseNumber(r),e=o.parseNumberArray(o.flatten(e)),o.anyIsError(r,e))return i.value;for(var n=e.length,t=r,u=0;n>u;u++)t*=1+e[u];return t},e.INTRATE=function(){throw new Error("INTRATE is not implemented")},e.IPMT=function(r,n,t,u,a,s){if(a=a||0,s=s||0,r=o.parseNumber(r),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),a=o.parseNumber(a),s=o.parseNumber(s),o.anyIsError(r,n,t,u,a,s))return i.value;var f,l=e.PMT(r,t,u,a,s);return f=1===n?1===s?0:-u:1===s?e.FV(r,n-2,l,u,1)-l:e.FV(r,n-1,l,u,0),f*r},e.IRR=function(r,e){if(e=e||0,r=o.parseNumberArray(o.flatten(r)),e=o.parseNumber(e),o.anyIsError(r,e))return i.value;for(var n=function(r,e,n){for(var t=n+1,u=r[0],i=1;i<r.length;i++)u+=r[i]/Math.pow(t,(e[i]-e[0])/365);return u},t=function(r,e,n){for(var t=n+1,u=0,i=1;i<r.length;i++){var a=(e[i]-e[0])/365;u-=a*r[i]/Math.pow(t,a+1)}return u},u=[],a=!1,s=!1,f=0;f<r.length;f++)u[f]=0===f?0:u[f-1]+365,r[f]>0&&(a=!0),r[f]<0&&(s=!0);if(!a||!s)return i.num;e=void 0===e?.1:e;var l,c,p,m=e,h=1e-10,g=!0;do p=n(r,u,m),l=m-p/t(r,u,m),c=Math.abs(l-m),m=l,g=c>h&&Math.abs(p)>h;while(g);return m},e.ISPMT=function(r,e,n,t){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,e,n,t)?i.value:t*r*(e/n-1)},e.MDURATION=function(){throw new Error("MDURATION is not implemented")},e.MIRR=function(r,n,t){if(r=o.parseNumberArray(o.flatten(r)),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,n,t))return i.value;for(var u=r.length,a=[],s=[],f=0;u>f;f++)r[f]<0?a.push(r[f]):s.push(r[f]);var l=-e.NPV(t,s)*Math.pow(1+t,u-1),c=e.NPV(n,a)*(1+n);return Math.pow(l/c,1/(u-1))-1},e.NOMINAL=function(r,e){return r=o.parseNumber(r),e=o.parseNumber(e),o.anyIsError(r,e)?i.value:0>=r||1>e?i.num:(e=parseInt(e,10),(Math.pow(r+1,1/e)-1)*e)},e.NPER=function(r,e,n,t,u){if(u=void 0===u?0:u,t=void 0===t?0:t,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;var a=e*(1+r*u)-t*r,s=n*r+e*(1+r*u);return Math.log(a/s)/Math.log(1+r)},e.NPV=function(){var r=o.parseNumberArray(o.flatten(arguments));if(r instanceof Error)return r;for(var e=r[0],n=0,t=1;t<r.length;t++)n+=r[t]/Math.pow(1+e,t);return n},e.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},e.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},e.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},e.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},e.PDURATION=function(r,e,n){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0>=r?i.num:(Math.log(n)-Math.log(e))/Math.log(1+r)},e.PMT=function(r,e,n,t,u){if(t=t||0,u=u||0,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u))return i.value;var a;if(0===r)a=(n+t)/e;else{var s=Math.pow(1+r,e);a=1===u?(t*r/(s-1)+n*r/(1-1/s))/(1+r):t*r/(s-1)+n*r/(1-1/s)}return-a},e.PPMT=function(r,n,t,u,a,s){return a=a||0,s=s||0,r=o.parseNumber(r),t=o.parseNumber(t),u=o.parseNumber(u),a=o.parseNumber(a),s=o.parseNumber(s),o.anyIsError(r,t,u,a,s)?i.value:e.PMT(r,t,u,a,s)-e.IPMT(r,n,t,u,a,s)},e.PRICE=function(){throw new Error("PRICE is not implemented")},e.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},e.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},e.PV=function(r,e,n,t,u){return t=t||0,u=u||0,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),o.anyIsError(r,e,n,t,u)?i.value:0===r?-n*e-t:((1-Math.pow(1+r,e))/r*n*(1+r*u)-t)/Math.pow(1+r,e)},e.RATE=function(r,e,n,t,u,a){if(a=void 0===a?.01:a,t=void 0===t?0:t,u=void 0===u?0:u,r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),u=o.parseNumber(u),a=o.parseNumber(a),o.anyIsError(r,e,n,t,u,a))return i.value;var s,f,l,c,p=1e-10,m=50,h=0,g=0,v=0,d=a;for(Math.abs(d)<p?s=n*(1+r*d)+e*(1+d*u)*r+t:(g=Math.exp(r*Math.log(1+d)),s=n*g+e*(1/d+u)*(g-1)+t),f=n+e*r+t,l=n*g+e*(1/d+u)*(g-1)+t,v=c=0,h=d;Math.abs(f-l)>p&&m>v;)d=(l*c-f*h)/(l-f),c=h,h=d,Math.abs(d)<p?s=n*(1+r*d)+e*(1+d*u)*r+t:(g=Math.exp(r*Math.log(1+d)),s=n*g+e*(1/d+u)*(g-1)+t),f=l,l=s,++v;return d},e.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},e.RRI=function(r,e,n){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0===r||0===e?i.num:Math.pow(n/e,1/r)-1},e.SLN=function(r,e,n){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0===n?i.num:(r-e)/n},e.SYD=function(r,e,n,t){return r=o.parseNumber(r),e=o.parseNumber(e),n=o.parseNumber(n),t=o.parseNumber(t),o.anyIsError(r,e,n,t)?i.value:0===n?i.num:1>t||t>n?i.num:(t=parseInt(t,10),(r-e)*(n-t+1)*2/(n*(n+1)))},e.TBILLEQ=function(r,e,n){return r=o.parseDate(r),e=o.parseDate(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0>=n?i.num:r>e?i.num:e-r>31536e6?i.num:365*n/(360-n*a.DAYS360(r,e,!1))},e.TBILLPRICE=function(r,e,n){return r=o.parseDate(r),e=o.parseDate(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0>=n?i.num:r>e?i.num:e-r>31536e6?i.num:100*(1-n*a.DAYS360(r,e,!1)/360)},e.TBILLYIELD=function(r,e,n){return r=o.parseDate(r),e=o.parseDate(e),n=o.parseNumber(n),o.anyIsError(r,e,n)?i.value:0>=n?i.num:r>e?i.num:e-r>31536e6?i.num:360*(100-n)/(n*a.DAYS360(r,e,!1))},e.VDB=function(){throw new Error("VDB is not implemented")},e.XIRR=function(r,e,n){if(r=o.parseNumberArray(o.flatten(r)),e=o.parseDateArray(o.flatten(e)),n=o.parseNumber(n),o.anyIsError(r,e,n))return i.value;for(var t=function(r,e,n){for(var t=n+1,u=r[0],i=1;i<r.length;i++)u+=r[i]/Math.pow(t,a.DAYS(e[i],e[0])/365);return u},u=function(r,e,n){for(var t=n+1,u=0,i=1;i<r.length;i++){var o=a.DAYS(e[i],e[0])/365;u-=o*r[i]/Math.pow(t,o+1)}return u},s=!1,f=!1,l=0;l<r.length;l++)r[l]>0&&(s=!0),r[l]<0&&(f=!0);if(!s||!f)return i.num;n=n||.1;var c,p,m,h=n,g=1e-10,v=!0;do m=t(r,e,h),c=h-m/u(r,e,h),p=Math.abs(c-h),h=c,v=p>g&&Math.abs(m)>g;while(v);return h},e.XNPV=function(r,e,n){if(r=o.parseNumber(r),e=o.parseNumberArray(o.flatten(e)),n=o.parseDateArray(o.flatten(n)),o.anyIsError(r,e,n))return i.value;for(var t=0,u=0;u<e.length;u++)t+=e[u]/Math.pow(1+r,a.DAYS(n[u],n[0])/365);return t},e.YIELD=function(){throw new Error("YIELD is not implemented")},e.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},e.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(r,e,n){var t=n(10);e.MATCH=function(r,e,n){if(!r&&!e)return t.na;if(2===arguments.length&&(n=1),!(e instanceof Array))return t.na;if(-1!==n&&0!==n&&1!==n)return t.na;for(var u,i,a=0;a<e.length;a++)if(1===n){if(e[a]===r)return a+1;e[a]<r&&(i?e[a]>i&&(u=a+1,i=e[a]):(u=a+1,i=e[a]))}else if(0===n){if("string"==typeof r){if(r=r.replace(/\?/g,"."),e[a].toLowerCase().match(r.toLowerCase()))return a+1}else if(e[a]===r)return a+1}else if(-1===n){if(e[a]===r)return a+1;e[a]>r&&(i?e[a]<i&&(u=a+1,i=e[a]):(u=a+1,i=e[a]))}return u?u:t.na}},function(r,e,n){function t(r){var e=function(){};e.prototype=u.lexer;var n=function(){this.lexer=new e,this.yy={}};n.prototype=u;var t=new n;return t.setObj=function(r){t.yy.obj=r},t.yy.parseError=function(r,e){throw{name:"Parser error",message:r,prop:e}},t.yy.handler=r,t}var u=n(25);r.exports=t},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_RESULT__=function(require){var o=function(r,e,n,t){for(n=n||{},t=r.length;t--;n[r[t]]=e);return n},$V0=[1,4],$V1=[1,5],$V2=[1,7],$V3=[1,10],$V4=[1,8],$V5=[1,9],$V6=[1,11],$V7=[1,16],$V8=[1,17],$V9=[1,14],$Va=[1,15],$Vb=[1,18],$Vc=[1,20],$Vd=[1,21],$Ve=[1,22],$Vf=[1,23],$Vg=[1,24],$Vh=[1,25],$Vi=[1,26],$Vj=[1,27],$Vk=[1,28],$Vl=[1,29],$Vm=[5,11,12,13,15,16,17,18,19,20,21,22,30,31],$Vn=[5,11,12,13,15,16,17,18,19,20,21,22,30,31,33],$Vo=[1,38],$Vp=[5,11,12,13,15,16,17,18,19,20,21,22,30,31,35],$Vq=[5,12,13,15,16,17,18,19,30,31],$Vr=[5,12,15,16,17,18,30,31],$Vs=[5,12,13,15,16,17,18,19,20,21,30,31],$Vt=[15,30,31],$Vu=[5,11,12,13,15,16,17,18,19,20,21,22,30,31,32,36],parser={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,"&":11,"=":12,"+":13,"(":14,")":15,"<":16,">":17,NOT:18,"-":19,"*":20,"/":21,"^":22,FUNCTION:23,expseq:24,cell:25,FIXEDCELL:26,":":27,CELL:28,ARRAY:29,";":30,",":31,VARIABLE:32,DECIMAL:33,NUMBER:34,"%":35,"#":36,"!":37,$accept:0,$end:1},terminals_:{5:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"&",12:"=",13:"+",14:"(",15:")",16:"<",17:">",18:"NOT",19:"-",20:"*",21:"/",22:"^",23:"FUNCTION",26:"FIXEDCELL",27:":",28:"CELL",29:"ARRAY",30:";",31:",",32:"VARIABLE",33:"DECIMAL",34:"NUMBER",35:"%",36:"#",37:"!"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[25,1],[25,3],[25,1],[25,3],[24,1],[24,1],[24,3],[24,3],[6,1],[6,3],[9,1],[9,3],[9,2],[2,3],[2,4]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];case 2:this.$=yy.handler.callVariable.call(this,$$[$0]);break;case 3:this.$=yy.handler.time.call(yy.obj,$$[$0],!0);break;case 4:this.$=yy.handler.time.call(yy.obj,$$[$0]);break;case 5:this.$=yy.handler.number($$[$0]);break;case 6:this.$=yy.handler.string($$[$0]);break;case 7:this.$=yy.handler.specialMatch("&",$$[$0-2],$$[$0]);break;case 8:this.$=yy.handler.logicMatch("=",$$[$0-2],$$[$0]);break;case 9:this.$=yy.handler.mathMatch("+",$$[$0-2],$$[$0]);break;case 10:this.$=yy.handler.number($$[$0-1]);break;case 11:this.$=yy.handler.logicMatch("<=",$$[$0-3],$$[$0]);break;case 12:this.$=yy.handler.logicMatch(">=",$$[$0-3],$$[$0]);break;case 13:this.$=yy.handler.logicMatch("<>",$$[$0-3],$$[$0]);break;case 14:this.$=yy.handler.logicMatch("NOT",$$[$0-2],$$[$0]);break;case 15:this.$=yy.handler.logicMatch(">",$$[$0-2],$$[$0]);break;case 16:this.$=yy.handler.logicMatch("<",$$[$0-2],$$[$0]);break;case 17:this.$=yy.handler.mathMatch("-",$$[$0-2],$$[$0]);break;case 18:this.$=yy.handler.mathMatch("*",$$[$0-2],$$[$0]);break;case 19:this.$=yy.handler.mathMatch("/",$$[$0-2],$$[$0]);break;case 20:this.$=yy.handler.mathMatch("^",$$[$0-2],$$[$0]);break;case 21:var n1=yy.handler.numberInverted($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 22:var n1=yy.handler.number($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 23:this.$=yy.handler.callFunction.call(this,$$[$0-2],"");break;case 24:this.$=yy.handler.callFunction.call(this,$$[$0-3],$$[$0-1]);break;case 28:this.$=yy.handler.fixedCellValue.call(yy.obj,$$[$0]);break;case 29:this.$=yy.handler.fixedCellRangeValue.call(yy.obj,$$[$0-2],$$[$0]);break;case 30:this.$=yy.handler.cellValue.call(yy.obj,$$[$0]);break;case 31:this.$=yy.handler.cellRangeValue.call(yy.obj,$$[$0-2],$$[$0]);break;case 32:this.$=[$$[$0]];break;case 33:console&&console.warning&&console.warn("EVAL");var result=[],arr=eval("["+yytext+"]");arr.forEach(function(r){result.push(r)}),this.$=result;break;case 34:case 35:$$[$0-2].push($$[$0]),this.$=$$[$0-2];break;case 36:this.$=[$$[$0]];break;case 37:this.$=yy.handler.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]],this.$.push($$[$0]);break;case 38:this.$=$$[$0];break;case 39:this.$=1*($$[$0-2]+"."+$$[$0]);break;case 40:this.$=.01*$$[$0-1];break;case 41:case 42:this.$=$$[$0-2]+$$[$0-1]+$$[$0]}},table:[{2:13,3:1,4:2,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{1:[3]},{5:[1,19],11:$Vc,12:$Vd,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl},o($Vm,[2,2],{33:[1,30]}),o($Vm,[2,3]),o($Vm,[2,4]),o($Vm,[2,5],{35:[1,31]}),o($Vm,[2,6]),{2:13,4:32,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:33,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,
32:$V9,34:$Va,36:$Vb},{2:13,4:34,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{14:[1,35]},o($Vm,[2,25]),o($Vm,[2,26],{2:36,32:[1,37],36:$Vb}),o($Vn,[2,36],{36:$Vo}),o($Vp,[2,38],{33:[1,39]}),o($Vm,[2,28],{27:[1,40]}),o($Vm,[2,30],{27:[1,41]}),{32:[1,42]},{1:[2,1]},{2:13,4:43,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:44,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:45,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:48,6:3,7:$V0,8:$V1,9:6,10:$V2,12:[1,46],13:$V3,14:$V4,17:[1,47],19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:50,6:3,7:$V0,8:$V1,9:6,10:$V2,12:[1,49],13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:51,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:52,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:53,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:54,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:55,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{32:[1,56]},o($Vp,[2,40]),{11:$Vc,12:$Vd,13:$Ve,15:[1,57],16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl},o($Vq,[2,21],{11:$Vc,20:$Vj,21:$Vk,22:$Vl}),o($Vq,[2,22],{11:$Vc,20:$Vj,21:$Vk,22:$Vl}),{2:13,4:60,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,15:[1,58],19:$V5,23:$V6,24:59,25:12,26:$V7,28:$V8,29:[1,61],32:$V9,34:$Va,36:$Vb},o($Vm,[2,27]),{36:$Vo},{32:[1,62]},{34:[1,63]},{26:[1,64]},{28:[1,65]},{37:[1,66]},o($Vm,[2,7]),o([5,12,15,30,31],[2,8],{11:$Vc,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vq,[2,9],{11:$Vc,20:$Vj,21:$Vk,22:$Vl}),{2:13,4:67,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:68,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},o($Vr,[2,16],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),{2:13,4:69,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},o($Vr,[2,15],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o([5,12,15,18,30,31],[2,14],{11:$Vc,13:$Ve,16:$Vf,17:$Vg,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vq,[2,17],{11:$Vc,20:$Vj,21:$Vk,22:$Vl}),o($Vs,[2,18],{11:$Vc,22:$Vl}),o($Vs,[2,19],{11:$Vc,22:$Vl}),o([5,12,13,15,16,17,18,19,20,21,22,30,31],[2,20],{11:$Vc}),o($Vn,[2,37]),o($Vm,[2,10]),o($Vm,[2,23]),{15:[1,70],30:[1,71],31:[1,72]},o($Vt,[2,32],{11:$Vc,12:$Vd,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vt,[2,33]),{37:[1,73]},o($Vp,[2,39]),o($Vm,[2,29]),o($Vm,[2,31]),o($Vu,[2,41]),o($Vr,[2,11],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vr,[2,13],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vr,[2,12],{11:$Vc,13:$Ve,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vm,[2,24]),{2:13,4:74,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},{2:13,4:75,6:3,7:$V0,8:$V1,9:6,10:$V2,13:$V3,14:$V4,19:$V5,23:$V6,25:12,26:$V7,28:$V8,32:$V9,34:$Va,36:$Vb},o($Vu,[2,42]),o($Vt,[2,34],{11:$Vc,12:$Vd,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl}),o($Vt,[2,35],{11:$Vc,12:$Vd,13:$Ve,16:$Vf,17:$Vg,18:$Vh,19:$Vi,20:$Vj,21:$Vk,22:$Vl})],defaultActions:{19:[2,1]},parseError:function(r,e){if(!e.recoverable)throw new Error(r);this.trace(r)},parse:function(r){function e(r){i.length=i.length-2*r,a.length=a.length-r,o.length=o.length-r}function n(){var r;return r=v.lex()||h,"number"!=typeof r&&(r=u.symbols_[r]||r),r}function t(r){for(var e=i.length-1,n=0;;){if(m.toString()in s[r])return n;if(0===r||2>e)return!1;e-=2,r=i[e],++n}}var u=this,i=[0],a=[null],o=[],s=this.table,f="",l=0,c=0,p=0,m=2,h=1,g=o.slice.call(arguments,1),v=Object.create(this.lexer),d={yy:{}};for(var y in this.yy)Object.prototype.hasOwnProperty.call(this.yy,y)&&(d.yy[y]=this.yy[y]);v.setInput(r,d.yy),d.yy.lexer=v,d.yy.parser=this,"undefined"==typeof v.yylloc&&(v.yylloc={});var b=v.yylloc;o.push(b);var E=v.options&&v.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var N,x,I,M,A,w,_,$,V,S={};;){if(I=i[i.length-1],this.defaultActions[I]?M=this.defaultActions[I]:((null===N||"undefined"==typeof N)&&(N=n()),M=s[I]&&s[I][N]),"undefined"==typeof M||!M.length||!M[0]){var T,R="";if(p)x!==h&&(T=t(I));else{T=t(I),V=[];for(w in s[I])this.terminals_[w]&&w>m&&V.push("'"+this.terminals_[w]+"'");R=v.showPosition?"Parse error on line "+(l+1)+":\n"+v.showPosition()+"\nExpecting "+V.join(", ")+", got '"+(this.terminals_[N]||N)+"'":"Parse error on line "+(l+1)+": Unexpected "+(N==h?"end of input":"'"+(this.terminals_[N]||N)+"'"),this.parseError(R,{text:v.match,token:this.terminals_[N]||N,line:v.yylineno,loc:b,expected:V,recoverable:T!==!1})}if(3==p){if(N===h||x===h)throw new Error(R||"Parsing halted while starting to recover from another error.");c=v.yyleng,f=v.yytext,l=v.yylineno,b=v.yylloc,N=n()}if(T===!1)throw new Error(R||"Parsing halted. No suitable error recovery rule available.");e(T),x=N==m?null:N,N=m,I=i[i.length-1],M=s[I]&&s[I][m],p=3}if(M[0]instanceof Array&&M.length>1)throw new Error("Parse Error: multiple actions possible at state: "+I+", token: "+N);switch(M[0]){case 1:i.push(N),a.push(v.yytext),o.push(v.yylloc),i.push(M[1]),N=null,x?(N=x,x=null):(c=v.yyleng,f=v.yytext,l=v.yylineno,b=v.yylloc,p>0&&p--);break;case 2:if(_=this.productions_[M[1]][1],S.$=a[a.length-_],S._$={first_line:o[o.length-(_||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(_||1)].first_column,last_column:o[o.length-1].last_column},E&&(S._$.range=[o[o.length-(_||1)].range[0],o[o.length-1].range[1]]),A=this.performAction.apply(S,[f,c,l,d.yy,M[1],a,o].concat(g)),"undefined"!=typeof A)return A;_&&(i=i.slice(0,-1*_*2),a=a.slice(0,-1*_),o=o.slice(0,-1*_)),i.push(this.productions_[M[1]][0]),a.push(S.$),o.push(S._$),$=s[i[i.length-2]][i[i.length-1]],i.push($);break;case 3:return!0}}return!0}},lexer=function(){var r={EOF:1,parseError:function(r,e){if(!this.yy.parser)throw new Error(r);this.yy.parser.parseError(r,e)},setInput:function(r,e){return this.yy=e||this.yy||{},this._input=r,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var r=this._input[0];this.yytext+=r,this.yyleng++,this.offset++,this.match+=r,this.matched+=r;var e=r.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),r},unput:function(r){var e=r.length,n=r.split(/(?:\r\n?|\n)/g);this._input=r+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var t=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var u=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===t.length?this.yylloc.first_column:0)+t[t.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[u[0],u[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(r){this.unput(this.match.slice(r))},pastInput:function(){var r=this.matched.substr(0,this.matched.length-this.match.length);return(r.length>20?"...":"")+r.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var r=this.match;return r.length<20&&(r+=this._input.substr(0,20-r.length)),(r.substr(0,20)+(r.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var r=this.pastInput(),e=new Array(r.length+1).join("-");return r+this.upcomingInput()+"\n"+e+"^"},test_match:function(r,e){var n,t,u;if(this.options.backtrack_lexer&&(u={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(u.yylloc.range=this.yylloc.range.slice(0))),t=r[0].match(/(?:\r\n?|\n).*/g),t&&(this.yylineno+=t.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:t?t[t.length-1].length-t[t.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+r[0].length},this.yytext+=r[0],this.match+=r[0],this.matches=r,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(r[0].length),this.matched+=r[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in u)this[i]=u[i];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var r,e,n,t;this._more||(this.yytext="",this.match="");for(var u=this._currentRules(),i=0;i<u.length;i++)if(n=this._input.match(this.rules[u[i]]),n&&(!e||n[0].length>e[0].length)){if(e=n,t=i,this.options.backtrack_lexer){if(r=this.test_match(n,u[i]),r!==!1)return r;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?(r=this.test_match(e,u[t]),r!==!1?r:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var r=this.next();return r?r:this.lex()},begin:function(r){this.conditionStack.push(r)},popState:function(){var r=this.conditionStack.length-1;return r>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(r){return r=this.conditionStack.length-1-Math.abs(r||0),r>=0?this.conditionStack[r]:"INITIAL"},pushState:function(r){this.begin(r)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(r,e,n,t){switch(n){case 0:break;case 1:return 10;case 2:return 10;case 3:return 23;case 4:return 7;case 5:return 8;case 6:return 26;case 7:return 26;case 8:return 26;case 9:return 28;case 10:return 23;case 11:return 32;case 12:return 32;case 13:return 34;case 14:return 29;case 15:break;case 16:return 11;case 17:return" ";case 18:return 33;case 19:return 27;case 20:return 30;case 21:return 31;case 22:return 20;case 23:return 21;case 24:return 19;case 25:return 13;case 26:return 22;case 27:return 14;case 28:return 15;case 29:return 17;case 30:return 16;case 31:return 18;case 32:return'"';case 33:return"'";case 34:return"!";case 35:return 12;case 36:return 35;case 37:return 36;case 38:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:!0}}};return r}();return parser.lexer=lexer,parser}.call(exports,__webpack_require__,exports,module),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},function(r,e,n){var t=n(2),u=[{type:"NULL",output:"#NULL"},{type:"DIV_ZERO",output:"#DIV/0!"},{type:"VALUE",output:"#VALUE!"},{type:"REF",output:"#REF!"},{type:"NAME",output:"#NAME?"},{type:"NUM",output:"#NUM!"},{type:"NOT_AVAILABLE",output:"#N/A"},{type:"ERROR",output:"#ERROR"},{type:"NEED_UPDATE",output:"#NEED_UPDATE"}];e.get=function(r){var e=t.filter(u,function(e){return e.type===r||e.output===r})[0];return e?e.output:null}},function(r,e,n){var t=n(2),u=n(4),i=n(10),a=n(16),o=["ABS","ACCRINT","ACOS","ACOSH","ACOTH","AND","ARABIC","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOMDIST","BINOMDISTRANGE","BINOMINV","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQDIST","CHISQINV","CODE","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCENORM","CONFIDENCET","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCEP","COVARIANCES","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","ERF","ERFC","EVEN","EXACT","EXPONDIST","FALSE","FDIST","FINV","FISHER","FISHERINV","IF","INT","ISEVEN","ISODD","LN","LOG","LOG10","MAX","MAXA","MEDIAN","MIN","MINA","MOD","NOT","ODD","OR","PI","POWER","ROUND","ROUNDDOWN","ROUNDUP","SIN","SINH","SPLIT","SQRT","SQRTPI","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","TAN","TANH","TRUE","TRUNC","XOR"],s=function(r,e,n){if("undefined"==typeof r)throw new Error("Matrix should be set");if("undefined"==typeof e)throw new Error("Formulas should be set");if("all"===n)n=null;else if(t.isArray(n)){var s=t.filter(n,t.isString);n=s}n=n||o;var f={number:function(r){if(window.marker&&console.error("number",arguments),null===r)return 0;switch(typeof r){case"undefined":return 0;case"number":return r;case"string":if(!isNaN(r))return 0===r.length?0:r.indexOf(".")>-1?parseFloat(r):parseInt(r,10)}return r},string:function(r){return window.marker&&console.error("string",arguments),r.substring(1,r.length-1)},numberInverted:function(r){return window.marker&&console.error("numberInverted",arguments),-1*this.number(r)},specialMatch:function(r,e,n){if(window.marker&&console.error("specialMatch",arguments),a.ISERROR(e))return e;if(a.ISERROR(n))return n;var t;switch(r){case"&":t=e.toString()+n.toString()}return t},logicMatch:function(r,e,n){if(window.marker&&console.error("logicMatch",arguments),a.ISERROR(e))return e;if(a.ISERROR(n))return n;var t;switch(r){case"=":t=e===n;break;case">":t=e>n;break;case"<":t=n>e;break;case">=":t=e>=n;break;case"<=":t=n>=e;break;case"<>":case"NOT":t=e!==n}return t},mathMatch:function(r,e,n){if(window.marker&&console.error("mathMatch",arguments),a.ISERROR(e))return e;if(a.ISERROR(n))return n;var t;if(e=f.number(e),n=f.number(n),isNaN(e)||isNaN(n)){if("="===e[0]||"="===n[0])throw Error("NEED_UPDATE");return window.marker&&console.error("VALUE"),i.value}switch(r){case"+":t=e+n;break;case"-":t=e-n;break;case"/":if(0===n)return window.marker&&console.error("DIV_ZERO"),i.div0;if(t=e/n,t==1/0)return window.marker&&console.error("DIV_ZERO"),i.div0;if(isNaN(t))return window.marker&&console.error("VALUE"),window.marker&&console.log(e,n,t),i.value;break;case"*":t=e*n;break;case"^":t=Math.pow(e,n)}return window.marker&&console.log(t),t},callFunction:function(r,t){if(window.marker&&console.error("callFunction/call",arguments),r=r.toUpperCase(),t=t||[],n.indexOf(r)>-1&&e[r]){"function"==typeof e.__pre&&(t=e.__pre.call(this,r,t));var u=e[r].apply(this,t);return"function"==typeof e.__post&&(u=e.__post.call(this,u,r,t)),window.marker&&console.log("callFunction/result",r,t,u),u}return window.marker&&console.error("callFunction/error: NAME"),i.name},callVariable:function(r){window.marker&&console.error("callVariable",arguments),r=r||[];var n=r[0];return n&&(n=n.toUpperCase(),e[n])?"function"==typeof e[n]?e[n].apply(this,r):e[n]:i.name},cellValue:function(e){window.marker&&console.error("cellValue/call"),window.marker&&console.log("cellValue/argumnets",arguments);var n,t=this,a=r.getItem(e),o=u.translateCellCoords({row:t.row,col:t.col});if(window.marker&&console.log("cellValue/formulaItem",t),"undefined"==typeof a&&console.error("refItem is undefined"),n=a.value,window.marker&&console.log("cellValue/refItem.value",n),window.marker&&console.log("cellValue/refItem",a),r.updateItem(t,{deps:[e]}),a&&a.deps&&-1!==a.deps.indexOf(o))return console.error("CYCLIC REFERENCE refItem/cellId: ",o,JSON.stringify(a.deps)),i.ref;if(a&&a.error)return Error(a.error);if(u.isSet(n)){var s=f.number(n);return s=isNaN(s)?n:s,window.marker&&console.log("cellValue/result",s),s}return window.marker&&console.log("cellValue/na",i.na),i.na},iterateCells:function(r,e){window.marker&&console.error("iterateCells/call",arguments);var n={index:[],value:[]},t={start:0,end:0};t=e.col>=r.col?{start:r.col,end:e.col}:{start:e.col,end:r.col};var i={start:0,end:0};i=e.row>=r.row?{start:r.row,end:e.row}:{start:e.row,end:r.row},window.marker&&console.log("iterateCells/params",t,i);for(var a=t.start,o=0;a<=t.end;a++,o++)for(var s=u.toChar(a),l=i.start,c=0;l<=i.end;l++,c++){var p=s+(l+1),m=null;try{m=f.cellValue.call(this,p)}catch(h){window.marker&&console.error("iterateCells/error",h)}"undefined"==typeof n.index[c]&&(n.index[c]=[],n.value[c]=[]),n.index[c][o]=p,n.value[c][o]=m}return window.marker&&console.log("iterateCells/result.index",n.index),window.marker&&console.log("iterateCells/result.value",n.value),n},cellRangeValue:function(e,n){window.marker&&console.error("cellRangeValue/call",arguments);var i=u.cellCoords(e),a=u.cellCoords(n),o=this,s=f.iterateCells.call(this,i,a),l=s.value;window.marker&&console.log("cellRangeValue/cells",l);var c=t.flatten(s.index);return r.updateItem(o,{deps:c}),l},fixedCellValue:function(r){return window.marker&&console.error("fixedCellValue",arguments),r=r.replace(/\$/g,""),f.cellValue.call(this,r)},fixedCellRangeValue:function(r,e){return window.marker&&console.error("fixedCellRangeValue",arguments),r=r.replace(/\$/g,""),e=e.replace(/\$/g,""),f.cellRangeValue.call(this,r,e)},isArray:t.isArray};return f};r.exports=s},function(r,e,n){var t=n(2),u=n(4),i=function(r){var e=this;e.data=Object.create(null);var n=function(n){if(!n.formula)return n;var t=r.parse(n.formula,n);return e.updateItem(n,t)};this.recalculate=function(){return t.forEach(e.data,n)},this.recalculateItems=function(r){return t.map(r,function(r){var t=e.getItem(r);if(!t)throw new Error("No item with id: "+r);return n(t)})},this.getItem=function(r){return e.data[r]},this.getAllItems=function(){return e.data},this.removeItem=function(r){e.data=t.filter(e.data,function(e){return e.id!==r})},this.removeItemsInCol=function(r){e.data=t.filter(e.data,function(e){return e.col!==r})},this.removeItemsInRow=function(r){e.data=t.filter(e.data,function(e){return e.row!==r})},this.removeItemsBelowCol=function(r){e.data=t.filter(e.data,function(e){return e.col<r})},this.removeItemsBelowRow=function(r){e.data=t.filter(e.data,function(e){return e.row<r})},this.updateItem=function(r,n){if(u.isString(r)&&(r=e.getItem(r)),r&&n)for(var i in n)r[i]&&u.isArray(r[i])?u.isArray(n[i])?t.forEach(n[i],function(e){-1===r[i].indexOf(e)&&r[i].push(e)}):-1===r[i].indexOf(n[i])&&r[i].push(n[i]):r[i]=n[i];return r},this.addItem=function(r){var n=r.id,t=e.getItem(n);if(!u.isSet(r.row)||!u.isSet(r.col)){var i=u.cellCoords(n);r.row=i.row,r.col=i.col}return t?e.updateItem(t,r):e.data[n]=r,t||r},this.getItemsWithDependencies=function(){return e.data};var i=function(r){var n=[];return t.forEach(e.getItemsWithDependencies(),function(e){e.deps&&e.deps.length&&e.deps.indexOf(r)>-1&&-1===n.indexOf(e.id)&&n.push(e.id)}),n},a=function(r,n){return t.forEach(i(r),function(r){if(-1===n.indexOf(r)){n.push(r);var t=e.getItem(r);t.deps&&t.deps.length&&a(r,n)}}),n};this.getDependencies=function(r){return a(r,[])},this.depsInFormula=function(r){var e=r.formula,n=r.deps;return n?(n=t.filter(n,function(r){return-1!==e.indexOf(r)}),n.length>0):!1},this.scan=function(r){t.forEach(r,function(r,n){t.forEach(r,function(r,t){var i=u.translateCellCoords({row:n,col:t}),a=null,o=null;u.isFormula(r)?a=r.substr(1):o=r,e.addItem({id:i,row:n,col:t,value:o,formula:a})})})}};r.exports=i}])});